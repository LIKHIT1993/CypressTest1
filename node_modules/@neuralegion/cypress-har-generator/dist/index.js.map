{"version":3,"sources":["webpack://@neuralegion/cypress-har-generator/./src/Plugin.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/CRIConnection.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/CRIOutputMessages.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/RetryStrategy.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/index.ts","webpack://@neuralegion/cypress-har-generator/./src/network/CookieParser.ts","webpack://@neuralegion/cypress-har-generator/./src/network/EntryBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/network/ExtraInfoBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/network/HarBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkCookie.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkObserver.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkRequest.ts","webpack://@neuralegion/cypress-har-generator/./src/network/index.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/FileManager.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/Logger.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/index.ts","webpack://@neuralegion/cypress-har-generator/external \"chalk\"","webpack://@neuralegion/cypress-har-generator/external \"chrome-remote-interface\"","webpack://@neuralegion/cypress-har-generator/external \"fs\"","webpack://@neuralegion/cypress-har-generator/external \"path\"","webpack://@neuralegion/cypress-har-generator/external \"tslib\"","webpack://@neuralegion/cypress-har-generator/external \"url\"","webpack://@neuralegion/cypress-har-generator/external \"util\"","webpack://@neuralegion/cypress-har-generator/webpack/bootstrap","webpack://@neuralegion/cypress-har-generator/./src/index.ts"],"names":["Object","defineProperty","exports","value","Plugin","tslib_1","cdp_1","network_1","path_1","logger","fileManager","this","entries","browser","args","isSupportedBrowser","Error","name","ensureRdpPort","ensureTestingFlags","filter","x","includes","options","__awaiter","closeConnection","connection","CRIConnection","port","rdpPort","RetryStrategy","open","listenNetworkEvents","filePath","join","outDir","fileName","assertFilePath","err","createFolder","har","buildHar","writeFile","e","message","length","HarBuilder","build","JSON","stringify","networkObservable","NetworkObserver","subscribe","request","push","EntryBuilder","close","path","family","getRdpPortFromArgs","Math","round","random","existing","find","arg","startsWith","split","CRIOutputMessages","__importStar","chrome_remote_interface_1","__importDefault","retryStrategy","_a","chromeRemoteInterface","Network","Security","debug","ATTEMPT_TO_CONNECT","host","default","CONNECTED","once","DISCONNECTED","FAILED_ATTEMPT_TO_CONNECT","execute","FAILED_TO_CONNECT","removeAllListeners","callback","_b","on","Promise","all","security","enable","network","CONNECTION_IS_NOT_DEFINED","maxRetries","initialBackoff","maximumBackoff","_times","backoffTime","task","timeout","nextTime","delay","resolve","setTimeout","increaseBackoffTime","pow","min","CRIConnection_1","enumerable","get","RetryStrategy_1","CookieParser","NetworkCookie_1","_lastCookiePosition","cookieHeader","_initialize","kv","_extractKeyValue","key","charAt","_lastCookie","addAttribute","slice","toLowerCase","addCookie","advanceAndCheckCookieDelimiter","flushCookie","_cookies","setCookieHeader","headerValue","_input","undefined","_originalInputLength","size","keyValueMatch","exec","result","toCamelCase","trim","position","str","replace","m","toUpperCase","match","keyValue","NetworkCookie","serverIPAddress","remoteAddress","portPositionInString","lastIndexOf","substr","timings","buildTimings","time","values","reduce","acc","t","max","entry","startedDateTime","Date","getWallTime","issueTime","toJSON","buildRequest","response","buildResponse","cache","_priority","priority","_resourceType","resourceType","_webSocketMessages","frames","connectionId","statusCode","responseHeadersText","transferSize","resourceSize","getResponseBodySize","_c","_d","res","method","requestMethod","url","buildRequestURL","httpVersion","requestHttpVersion","headers","requestHeaders","queryString","queryParameters","cookies","buildCookies","requestCookies","headersSize","requestHeadersText","bodySize","requestBodySize","postData","buildPostData","status","statusText","responseHttpVersion","responseHeaders","responseCookies","content","buildContent","redirectURL","responseHeaderValue","_transferSize","data","contentData","assign","mimeType","compression","getResponseCompression","timing","startTime","blocked","dns","ssl","connect","send","wait","receive","queuedTime","toMilliseconds","highestTime","blockedStart","leastNonNegative","dnsStart","connectStart","sendStart","Infinity","dnsEnd","sslStart","sslEnd","connectEnd","sendEnd","responseReceivedTime","endTime","requestTime","waitStart","waitEnd","receiveStart","receiveEnd","item","requestFormData","requestContentType","text","formParameters","params","map","buildCookie","bind","cookie","domain","expires","expiresDate","httpOnly","secure","contentLength","ExtraInfoBuilder","deleteCallback","_hasExtraInfo","_finished","_requests","_requestExtraInfo","_responseExtraInfo","info","sync","deleteIfComplete","lastRequest","getLastRequest","hasExtraResponseInfo","req","indexOf","index","getRequestIndex","requestExtraInfo","addExtraRequestInfo","responseExtraInfo","addExtraResponseInfo","version","homepage","comment","log","pages","creator","CookieAttribute","_attributes","Map","_size","_name","_value","has","HTTPONLY","SECURE","SAMESITE","EXPIRES","MAXAGE","PATH","PORT","DOMAIN","maxAge","isNaN","requestDate","targetDate","getTime","set","NetworkRequest_1","ExtraInfoBuilder_1","_entries","_extraInfoBuilders","destination","event","handleEvent","certificateError","eventId","handleCertificateError","action","setOverrideCertificateErrors","override","setCacheDisabled","cacheDisabled","setBypassServiceWorker","bypass","requestId","signedExchangeInfo","updateNetworkRequestWithResponse","outerResponse","type","loaderId","initiator","redirectResponse","documentURL","frameId","timestamp","wallTime","responseReceived","_appendRedirect","createRequest","updateNetworkRequestWithRequest","setIssueTime","getExtraInfoBuilder","addRequest","startRequest","dataLength","encodedDataLength","increaseTransferSize","newPriority","finishRequest","errorText","canceled","headersMapToHeadersArray","headersText","protocol","addProtocolFrame","errorMessage","addProtocolFrameError","addRequestExtraInfo","addResponseExtraInfo","delete","originalNetworkRequest","redirectCount","redirect","redirectSource","markAsRedirect","newNetworkRequest","networkRequest","finishTime","setContentData","getResponseBody","finished","excludeRequest","chromeRequest","setRequestFormData","getRequestPostData","initialPriority","hasPostData","then","catch","NetworkRequest","setUrl","hasExtraRequestInfo","connectionReused","String","remoteIPAddress","setRemoteAddress","remotePort","headersMap","keys","parsedURL","excludePaths","some","excludedPath","RegExp","test","handler","substring","call","WebSocketFrameType","CookieParser_1","url_1","_requestId","_wallIssueTime","_requestHeaderValues","_responseHeaderValues","_requestFormData","_hasExtraResponseInfo","_hasExtraRequestInfo","_connectionId","_protocol","_requestTime","_requestMethod","_statusText","_remoteAddress","_startTime","_issueTime","_endTime","_responseReceivedTime","_resourceSize","_requestHeaders","_requestHeadersText","_connectionReused","_responseHeaders","_responseHeadersText","_frames","_statusCode","_signedExchangeInfo","_parsedURL","_url","_timing","timingInfo","headersReceivedTime","receiveHeadersEnd","_mimeType","_redirectSource","originatingRequest","clear","_requestCookies","requestHeaderValue","parseCookie","parseInt","_responseCookies","parseSetCookie","_queryString","questionMarkPosition","hashSignPosition","_initialPriority","getFilteredProtocolName","_parsedQueryParameters","parseParameters","_currentPriority","chars","foundChar","i","j","parse","ip","monotonicTime","_formParametersPromise","parseFormParameters","_contentData","error","body","base64Encoded","encoding","addFrame","ERROR","opcode","mask","sent","REQUEST","RESPONSE","payloadData","extraRequestInfo","extraResponseInfo","query","headerName","computeHeaderValue","formUrlencoded","multipartDetails","boundary","formData","parseMultipartFormDataParameters","sanitizedBoundary","escapeCharacters","keyValuePattern","field","frame","pair","EntryBuilder_1","HarBuilder_1","NetworkObserver_1","FileManager","Logger_1","util_1","fs_1","_access","promisify","access","_unlink","unlink","_writeFile","_mkdir","mkdir","_instance","removeFile","Logger","Instance","exists","constants","F_OK","chalk_1","debuglog","msg","blue","red","yellow","console","FileManager_1","module","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","ensureBrowserFlags","install","Plugin_1","utils_1","plugin","saveHar","recordHar","launchOptions"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Plugin = void 0;\nconst tslib_1 = require(\"tslib\");\nconst cdp_1 = require(\"./cdp\");\nconst network_1 = require(\"./network\");\nconst path_1 = require(\"path\");\nclass Plugin {\n    constructor(logger, fileManager) {\n        this.logger = logger;\n        this.fileManager = fileManager;\n        this.entries = [];\n    }\n    ensureBrowserFlags(browser, args) {\n        if (!this.isSupportedBrowser(browser)) {\n            throw new Error(`An unsupported browser family was used: ${browser.name}`);\n        }\n        const browserFlags = this.ensureRdpPort(this.ensureTestingFlags(args));\n        return browserFlags.filter((x) => !args.includes(x));\n    }\n    recordHar(options) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            yield this.closeConnection();\n            this.connection = new cdp_1.CRIConnection({ port: this.rdpPort }, this.logger, new cdp_1.RetryStrategy(20, 5, 100));\n            this.entries = [];\n            yield this.connection.open();\n            yield this.listenNetworkEvents(options);\n            return null;\n        });\n    }\n    saveHar(options) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const filePath = path_1.join(options.outDir, options.fileName);\n            this.assertFilePath(filePath);\n            if (!this.connection) {\n                this.logger.err(`Failed to save HAR. First you should start recording.`);\n                return null;\n            }\n            try {\n                yield this.fileManager.createFolder(options.outDir);\n                const har = this.buildHar();\n                if (har) {\n                    yield this.fileManager.writeFile(filePath, har);\n                }\n            }\n            catch (e) {\n                this.logger.err(`Failed to save HAR: ${e.message}`);\n            }\n            finally {\n                this.entries = [];\n            }\n            return null;\n        });\n    }\n    buildHar() {\n        if (this.entries.length) {\n            const har = new network_1.HarBuilder(this.entries).build();\n            return JSON.stringify(har, null, 2);\n        }\n    }\n    listenNetworkEvents(options) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const networkObservable = new network_1.NetworkObserver(options, this.connection, this.logger);\n            yield networkObservable.subscribe((request) => tslib_1.__awaiter(this, void 0, void 0, function* () { return this.entries.push(yield new network_1.EntryBuilder(request).build()); }));\n        });\n    }\n    closeConnection() {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            if (this.connection) {\n                yield this.connection.close();\n                delete this.connection;\n            }\n        });\n    }\n    assertFilePath(path) {\n        if (typeof path !== 'string') {\n            throw new Error('File path must be a string.');\n        }\n    }\n    isSupportedBrowser(browser) {\n        return ['chromium'].includes(browser === null || browser === void 0 ? void 0 : browser.family);\n    }\n    ensureTestingFlags(args) {\n        return [\n            ...args,\n            '--no-sandbox',\n            '--disable-background-networking',\n            '--reduce-security-for-testing',\n            '--allow-insecure-localhost',\n            '--ignore-certificate-errors'\n        ];\n    }\n    ensureRdpPort(args) {\n        this.rdpPort = this.getRdpPortFromArgs(args);\n        if (this.rdpPort) {\n            return args;\n        }\n        this.rdpPort = 40000 + Math.round(Math.random() * 25000);\n        return [...args, `--remote-debugging-port=${this.rdpPort}`];\n    }\n    getRdpPortFromArgs(args) {\n        const existing = args.find((arg) => arg.startsWith('--remote-debugging-port='));\n        if (existing) {\n            return +existing.split('=')[1];\n        }\n    }\n}\nexports.Plugin = Plugin;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGx1Z2luLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL1BsdWdpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsK0JBQXFEO0FBQ3JELHVDQUttQjtBQUVuQiwrQkFBNEI7QUFZNUIsTUFBYSxNQUFNO0lBS2pCLFlBQ21CLE1BQWMsRUFDZCxXQUF3QjtRQUR4QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFMbkMsWUFBTyxHQUFZLEVBQUUsQ0FBQztJQU0zQixDQUFDO0lBRUcsa0JBQWtCLENBQ3ZCLE9BQXdCLEVBQ3hCLElBQWM7UUFFZCxJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ3JDLE1BQU0sSUFBSSxLQUFLLENBQ2IsMkNBQTJDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FDMUQsQ0FBQztTQUNIO1FBRUQsTUFBTSxZQUFZLEdBQWEsSUFBSSxDQUFDLGFBQWEsQ0FDL0MsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxDQUM5QixDQUFDO1FBRUYsT0FBTyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBUyxFQUFXLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RSxDQUFDO0lBRVksU0FBUyxDQUFDLE9BQXNCOztZQUMzQyxNQUFNLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUU3QixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksbUJBQWEsQ0FDakMsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUN0QixJQUFJLENBQUMsTUFBTSxFQUNYLElBQUksbUJBQWEsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUM5QixDQUFDO1lBRUYsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFFbEIsTUFBTSxJQUFJLENB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LGFBQWEsQ0FBQyxJQUFjO1FBQ2xDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBRTdDLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNoQixPQUFPLElBQUksQ0FBQztTQUNiO1FBRUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7UUFFekQsT0FBTyxDQUFDLEdBQUcsSUFBSSxFQUFFLDJCQUEyQixJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRU8sa0JBQWtCLENBQUMsSUFBYztRQUN2QyxNQUFNLFFBQVEsR0FBdUIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQVcsRUFBVyxFQUFFLENBQ3RFLEdBQUcsQ0FBQyxVQUFVLENBQUMsMEJBQTBCLENBQUMsQ0FDM0MsQ0FBQztRQUVGLElBQUksUUFBUSxFQUFFO1lBQ1osT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDaEM7SUFDSCxDQUFDO0NBQ0Y7QUE5SUQsd0JBOElDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRmlsZU1hbmFnZXIsIExvZ2dlciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgQ1JJQ29ubmVjdGlvbiwgUmV0cnlTdHJhdGVneSB9IGZyb20gJy4vY2RwJztcbmltcG9ydCB7XG4gIEVudHJ5QnVpbGRlcixcbiAgSGFyQnVpbGRlcixcbiAgTmV0d29ya09ic2VydmVyLFxuICBOZXR3b3JrUmVxdWVzdFxufSBmcm9tICcuL25ldHdvcmsnO1xuaW1wb3J0IHsgRW50cnksIEhhciB9IGZyb20gJ2hhci1mb3JtYXQnO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNhdmVPcHRpb25zIHtcbiAgZmlsZU5hbWU6IHN0cmluZztcbiAgb3V0RGlyOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVjb3JkT3B0aW9ucyB7XG4gIGNvbnRlbnQ6IGJvb2xlYW47XG4gIGV4Y2x1ZGVQYXRoczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBjbGFzcyBQbHVnaW4ge1xuICBwcml2YXRlIHJkcFBvcnQ/OiBudW1iZXI7XG4gIHByaXZhdGUgZW50cmllczogRW50cnlbXSA9IFtdO1xuICBwcml2YXRlIGNvbm5lY3Rpb24/OiBDUklDb25uZWN0aW9uO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyOiBMb2dnZXIsXG4gICAgcHJpdmF0ZSByZWFkb25seSBmaWxlTWFuYWdlcjogRmlsZU1hbmFnZXJcbiAgKSB7fVxuXG4gIHB1YmxpYyBlbnN1cmVCcm93c2VyRmxhZ3MoXG4gICAgYnJvd3NlcjogQ3lwcmVzcy5Ccm93c2VyLFxuICAgIGFyZ3M6IHN0cmluZ1tdXG4gICk6IHN0cmluZ1tdIHtcbiAgICBpZiAoIXRoaXMuaXNTdXBwb3J0ZWRCcm93c2VyKGJyb3dzZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBBbiB1bnN1cHBvcnRlZCBicm93c2VyIGZhbWlseSB3YXMgdXNlZDogJHticm93c2VyLm5hbWV9YFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBicm93c2VyRmxhZ3M6IHN0cmluZ1tdID0gdGhpcy5lbnN1cmVSZHBQb3J0KFxuICAgICAgdGhpcy5lbnN1cmVUZXN0aW5nRmxhZ3MoYXJncylcbiAgICApO1xuXG4gICAgcmV0dXJuIGJyb3dzZXJGbGFncy5maWx0ZXIoKHg6IHN0cmluZyk6IGJvb2xlYW4gPT4gIWFyZ3MuaW5jbHVkZXMoeCkpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHJlY29yZEhhcihvcHRpb25zOiBSZWNvcmRPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5jbG9zZUNvbm5lY3Rpb24oKTtcblxuICAgIHRoaXMuY29ubmVjdGlvbiA9IG5ldyBDUklDb25uZWN0aW9uKFxuICAgICAgeyBwb3J0OiB0aGlzLnJkcFBvcnQgfSxcbiAgICAgIHRoaXMubG9nZ2VyLFxuICAgICAgbmV3IFJldHJ5U3RyYXRlZ3koMjAsIDUsIDEwMClcbiAgICApO1xuXG4gICAgdGhpcy5lbnRyaWVzID0gW107XG5cbiAgICBhd2FpdCB0aGlzLmNvbm5lY3Rpb24ub3BlbigpO1xuXG4gICAgYXdhaXQgdGhpcy5saXN0ZW5OZXR3b3JrRXZlbnRzKG9wdGlvbnMpO1xuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2F2ZUhhcihvcHRpb25zOiBTYXZlT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGZpbGVQYXRoOiBzdHJpbmcgPSBqb2luKG9wdGlvbnMub3V0RGlyLCBvcHRpb25zLmZpbGVOYW1lKTtcblxuICAgIHRoaXMuYXNzZXJ0RmlsZVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgaWYgKCF0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycihgRmFpbGVkIHRvIHNhdmUgSEFSLiBGaXJzdCB5b3Ugc2hvdWxkIHN0YXJ0IHJlY29yZGluZy5gKTtcblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuZmlsZU1hbmFnZXIuY3JlYXRlRm9sZGVyKG9wdGlvbnMub3V0RGlyKTtcbiAgICAgIGNvbnN0IGhhcjogc3RyaW5nIHwgdW5kZWZpbmVkID0gdGhpcy5idWlsZEhhcigpO1xuXG4gICAgICBpZiAoaGFyKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZmlsZU1hbmFnZXIud3JpdGVGaWxlKGZpbGVQYXRoLCBoYXIpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycihgRmFpbGVkIHRvIHNhdmUgSEFSOiAke2UubWVzc2FnZX1gKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5lbnRyaWVzID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkSGFyKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHRoaXMuZW50cmllcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGhhcjogSGFyID0gbmV3IEhhckJ1aWxkZXIodGhpcy5lbnRyaWVzKS5idWlsZCgpO1xuXG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaGFyLCBudWxsLCAyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxpc3Rlbk5ldHdvcmtFdmVudHMob3B0aW9uczogUmVjb3JkT3B0aW9ucyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IG5ldHdvcmtPYnNlcnZhYmxlOiBOZXR3b3JrT2JzZXJ2ZXIgPSBuZXcgTmV0d29ya09ic2VydmVyKFxuICAgICAgb3B0aW9ucyxcbiAgICAgIHRoaXMuY29ubmVjdGlvbixcbiAgICAgIHRoaXMubG9nZ2VyXG4gICAgKTtcblxuICAgIGF3YWl0IG5ldHdvcmtPYnNlcnZhYmxlLnN1YnNjcmliZShcbiAgICAgIGFzeW5jIChyZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCk6IFByb21pc2U8bnVtYmVyPiA9PlxuICAgICAgICB0aGlzLmVudHJpZXMucHVzaChhd2FpdCBuZXcgRW50cnlCdWlsZGVyKHJlcXVlc3QpLmJ1aWxkKCkpXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xvc2VDb25uZWN0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgIGF3YWl0IHRoaXMuY29ubmVjdGlvbi5jbG9zZSgpO1xuICAgICAgZGVsZXRlIHRoaXMuY29ubmVjdGlvbjtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzc2VydEZpbGVQYXRoKHBhdGg6IHN0cmluZyB8IHVuZGVmaW5lZCk6IGFzc2VydHMgcGF0aCBpcyBzdHJpbmcge1xuICAgIGlmICh0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBwYXRoIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpc1N1cHBvcnRlZEJyb3dzZXIoYnJvd3NlcjogQ3lwcmVzcy5Ccm93c2VyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFsnY2hyb21pdW0nXS5pbmNsdWRlcyhicm93c2VyPy5mYW1pbHkpO1xuICB9XG5cbiAgcHJpdmF0ZSBlbnN1cmVUZXN0aW5nRmxhZ3MoYXJnczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIC4uLmFyZ3MsXG4gICAgICAnLS1uby1zYW5kYm94JyxcbiAgICAgICctLWRpc2FibGUtYmFja2dyb3VuZC1uZXR3b3JraW5nJyxcbiAgICAgICctLXJlZHVjZS1zZWN1cml0eS1mb3ItdGVzdGluZycsXG4gICAgICAnLS1hbGxvdy1pbnNlY3VyZS1sb2NhbGhvc3QnLFxuICAgICAgJy0taWdub3JlLWNlcnRpZmljYXRlLWVycm9ycydcbiAgICBdO1xuICB9XG5cbiAgcHJpdmF0ZSBlbnN1cmVSZHBQb3J0KGFyZ3M6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIHRoaXMucmRwUG9ydCA9IHRoaXMuZ2V0UmRwUG9ydEZyb21BcmdzKGFyZ3MpO1xuXG4gICAgaWYgKHRoaXMucmRwUG9ydCkge1xuICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfVxuXG4gICAgdGhpcy5yZHBQb3J0ID0gNDAwMDAgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAyNTAwMCk7XG5cbiAgICByZXR1cm4gWy4uLmFyZ3MsIGAtLXJlbW90ZS1kZWJ1Z2dpbmctcG9ydD0ke3RoaXMucmRwUG9ydH1gXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UmRwUG9ydEZyb21BcmdzKGFyZ3M6IHN0cmluZ1tdKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBleGlzdGluZzogc3RyaW5nIHwgdW5kZWZpbmVkID0gYXJncy5maW5kKChhcmc6IHN0cmluZyk6IGJvb2xlYW4gPT5cbiAgICAgIGFyZy5zdGFydHNXaXRoKCctLXJlbW90ZS1kZWJ1Z2dpbmctcG9ydD0nKVxuICAgICk7XG5cbiAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgIHJldHVybiArZXhpc3Rpbmcuc3BsaXQoJz0nKVsxXTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CRIConnection = void 0;\nconst tslib_1 = require(\"tslib\");\nconst CRIOutputMessages = tslib_1.__importStar(require(\"./CRIOutputMessages\"));\nconst chrome_remote_interface_1 = tslib_1.__importDefault(require(\"chrome-remote-interface\"));\nclass CRIConnection {\n    constructor(options, logger, retryStrategy) {\n        this.options = options;\n        this.logger = logger;\n        this.retryStrategy = retryStrategy;\n    }\n    get network() {\n        var _a;\n        return (_a = this.chromeRemoteInterface) === null || _a === void 0 ? void 0 : _a.Network;\n    }\n    get security() {\n        var _a;\n        return (_a = this.chromeRemoteInterface) === null || _a === void 0 ? void 0 : _a.Security;\n    }\n    open() {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            try {\n                this.logger.debug(CRIOutputMessages.ATTEMPT_TO_CONNECT);\n                const { host, port } = this.options;\n                const chromeRemoteInterface = yield chrome_remote_interface_1.default({\n                    host,\n                    port\n                });\n                this.logger.debug(CRIOutputMessages.CONNECTED);\n                chromeRemoteInterface.once('disconnect', () => this.logger.debug(CRIOutputMessages.DISCONNECTED));\n                this.chromeRemoteInterface = chromeRemoteInterface;\n            }\n            catch (e) {\n                this.logger.debug(`${CRIOutputMessages.FAILED_ATTEMPT_TO_CONNECT}: ${e.message}`);\n                if (!(yield this.retryStrategy.execute(() => this.open()))) {\n                    throw new Error(CRIOutputMessages.FAILED_TO_CONNECT);\n                }\n            }\n        });\n    }\n    close() {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            if (this.chromeRemoteInterface) {\n                yield this.chromeRemoteInterface.close();\n                this.chromeRemoteInterface.removeAllListeners();\n                delete this.chromeRemoteInterface;\n                this.logger.debug(CRIOutputMessages.DISCONNECTED);\n            }\n        });\n    }\n    subscribe(callback) {\n        var _a, _b;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            if (!this.chromeRemoteInterface) {\n                this.logger.debug(CRIOutputMessages.CONNECTION_IS_NOT_DEFINED);\n                return;\n            }\n            this.chromeRemoteInterface.on('event', callback);\n            yield Promise.all([(_a = this.security) === null || _a === void 0 ? void 0 : _a.enable(), (_b = this.network) === null || _b === void 0 ? void 0 : _b.enable()]);\n        });\n    }\n}\nexports.CRIConnection = CRIConnection;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ1JJQ29ubmVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jZHAvQ1JJQ29ubmVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsK0VBQXlEO0FBQ3pELDhGQUtpQztBQVVqQyxNQUFhLGFBQWE7SUFXeEIsWUFDbUIsT0FBcUMsRUFDckMsTUFBYyxFQUNkLGFBQTRCO1FBRjVCLFlBQU8sR0FBUCxPQUFPLENBQThCO1FBQ3JDLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtJQUM1QyxDQUFDO0lBWkosSUFBSSxPQUFPOztRQUNULE9BQU8sTUFBQSxJQUFJLENBQUMscUJBQXFCLDBDQUFFLE9BQU8sQ0FBQztJQUM3QyxDQUFDO0lBRUQsSUFBSSxRQUFROztRQUNWLE9BQU8sTUFBQSxJQUFJLENBQUMscUJBQXFCLDBDQUFFLFFBQVEsQ0FBQztJQUM5QyxDQUFDO0lBUVksSUFBSTs7WUFDZixJQUFJO2dCQUNGLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLENBQUM7Z0JBRXhELE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFFcEMsTUFBTSxxQkFBcUIsR0FBMEIsTUFBTSxpQ0FBTyxDQUFDO29CQUNqRSxJQUFJO29CQUNKLElBQUk7aUJBQ0wsQ0FBQyxDQUFDO2dCQUVILElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUUvQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLEdBQVMsRUFBRSxDQUNsRCxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsQ0FDbEQsQ0FBQztnQkFFRixJQUFJLENBQUMscUJBQXFCLEdBQUcscUJBQXFCLENBQUM7YUFDcEQ7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FDZixHQUFHLGlCQUFpQixDQUFDLHlCQUF5QixLQUFLLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FDL0QsQ0FBQztnQkFFRixJQUNFLENBQUMsQ0FBQyxNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLEdBQWtCLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUNyRTtvQkFDQSxNQUFNLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixDQUFDLENBQUM7aUJBQ3REO2FBQ0Y7UUFDSCxDQUFDO0tBQUE7SUFFWSxLQUFLOztZQUNoQixJQUFJLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtnQkFDOUIsTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsS0FBSyxFQUFFLENBQUM7Z0JBQ3pDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO2dCQUNoRCxPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQztnQkFDbEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsWUFBWSxDQUFDLENBQUM7YUFDbkQ7UUFDSCxDQUFDO0tBQUE7SUFFWSxTQUFTLENBQ3BCLFFBQXFEOzs7WUFFckQsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtnQkFDL0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMseUJBQXlCLENBQUMsQ0FBQztnQkFFL0QsT0FBTzthQUNSO1lBRUQsSUFBSSxDQUFDLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFFakQsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBQSxJQUFJLENBQUMsUUFBUSwwQ0FBRSxNQUFNLEVBQUUsRUFBRSxNQUFBLElBQUksQ0FBQyxPQUFPLDBDQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQzs7S0FDdEU7Q0FDRjtBQXRFRCxzQ0FzRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXRyeVN0cmF0ZWd5IH0gZnJvbSAnLi9SZXRyeVN0cmF0ZWd5JztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCAqIGFzIENSSU91dHB1dE1lc3NhZ2VzIGZyb20gJy4vQ1JJT3V0cHV0TWVzc2FnZXMnO1xuaW1wb3J0IGNvbm5lY3QsIHtcbiAgQ2hyb21lUmVtb3RlSW50ZXJmYWNlLFxuICBDaHJvbWVSZW1vdGVJbnRlcmZhY2VPcHRpb25zLFxuICBOZXR3b3JrLFxuICBTZWN1cml0eVxufSBmcm9tICdjaHJvbWUtcmVtb3RlLWludGVyZmFjZSc7XG5pbXBvcnQgUHJvdG9jb2xNYXBwaW5nIGZyb20gJ2RldnRvb2xzLXByb3RvY29sL3R5cGVzL3Byb3RvY29sLW1hcHBpbmcnO1xuXG5leHBvcnQgdHlwZSBDaHJvbWVSZW1vdGVJbnRlcmZhY2VNZXRob2QgPSBrZXlvZiBQcm90b2NvbE1hcHBpbmcuRXZlbnRzO1xuXG5leHBvcnQgdHlwZSBDaHJvbWVSZW1vdGVJbnRlcmZhY2VFdmVudCA9IHtcbiAgbWV0aG9kOiBDaHJvbWVSZW1vdGVJbnRlcmZhY2VNZXRob2Q7XG4gIHBhcmFtcz86IFByb3RvY29sTWFwcGluZy5FdmVudHNbQ2hyb21lUmVtb3RlSW50ZXJmYWNlTWV0aG9kXVswXTtcbn07XG5cbmV4cG9ydCBjbGFzcyBDUklDb25uZWN0aW9uIHtcbiAgcHJpdmF0ZSBjaHJvbWVSZW1vdGVJbnRlcmZhY2U/OiBDaHJvbWVSZW1vdGVJbnRlcmZhY2U7XG5cbiAgZ2V0IG5ldHdvcmsoKTogTmV0d29yayB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY2hyb21lUmVtb3RlSW50ZXJmYWNlPy5OZXR3b3JrO1xuICB9XG5cbiAgZ2V0IHNlY3VyaXR5KCk6IFNlY3VyaXR5IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jaHJvbWVSZW1vdGVJbnRlcmZhY2U/LlNlY3VyaXR5O1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zOiBDaHJvbWVSZW1vdGVJbnRlcmZhY2VPcHRpb25zLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyOiBMb2dnZXIsXG4gICAgcHJpdmF0ZSByZWFkb25seSByZXRyeVN0cmF0ZWd5OiBSZXRyeVN0cmF0ZWd5XG4gICkge31cblxuICBwdWJsaWMgYXN5bmMgb3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5sb2dnZXIuZGVidWcoQ1JJT3V0cHV0TWVzc2FnZXMuQVRURU1QVF9UT19DT05ORUNUKTtcblxuICAgICAgY29uc3QgeyBob3N0LCBwb3J0IH0gPSB0aGlzLm9wdGlvbnM7XG5cbiAgICAgIGNvbnN0IGNocm9tZVJlbW90ZUludGVyZmFjZTogQ2hyb21lUmVtb3RlSW50ZXJmYWNlID0gYXdhaXQgY29ubmVjdCh7XG4gICAgICAgIGhvc3QsXG4gICAgICAgIHBvcnRcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhDUklPdXRwdXRNZXNzYWdlcy5DT05ORUNURUQpO1xuXG4gICAgICBjaHJvbWVSZW1vdGVJbnRlcmZhY2Uub25jZSgnZGlzY29ubmVjdCcsICgpOiB2b2lkID0+XG4gICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKENSSU91dHB1dE1lc3NhZ2VzLkRJU0NPTk5FQ1RFRClcbiAgICAgICk7XG5cbiAgICAgIHRoaXMuY2hyb21lUmVtb3RlSW50ZXJmYWNlID0gY2hyb21lUmVtb3RlSW50ZXJmYWNlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKFxuICAgICAgICBgJHtDUklPdXRwdXRNZXNzYWdlcy5GQUlMRURfQVRURU1QVF9UT19DT05ORUNUfTogJHtlLm1lc3NhZ2V9YFxuICAgICAgKTtcblxuICAgICAgaWYgKFxuICAgICAgICAhKGF3YWl0IHRoaXMucmV0cnlTdHJhdGVneS5leGVjdXRlKCgpOiBQcm9taXNlPHZvaWQ+ID0+IHRoaXMub3BlbigpKSlcbiAgICAgICkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoQ1JJT3V0cHV0TWVzc2FnZXMuRkFJTEVEX1RPX0NPTk5FQ1QpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBjbG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5jaHJvbWVSZW1vdGVJbnRlcmZhY2UpIHtcbiAgICAgIGF3YWl0IHRoaXMuY2hyb21lUmVtb3RlSW50ZXJmYWNlLmNsb3NlKCk7XG4gICAgICB0aGlzLmNocm9tZVJlbW90ZUludGVyZmFjZS5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLmNocm9tZVJlbW90ZUludGVyZmFjZTtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKENSSU91dHB1dE1lc3NhZ2VzLkRJU0NPTk5FQ1RFRCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGFzeW5jIHN1YnNjcmliZShcbiAgICBjYWxsYmFjazogKGV2ZW50OiBDaHJvbWVSZW1vdGVJbnRlcmZhY2VFdmVudCkgPT4gdm9pZFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY2hyb21lUmVtb3RlSW50ZXJmYWNlKSB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhDUklPdXRwdXRNZXNzYWdlcy5DT05ORUNUSU9OX0lTX05PVF9ERUZJTkVEKTtcblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY2hyb21lUmVtb3RlSW50ZXJmYWNlLm9uKCdldmVudCcsIGNhbGxiYWNrKTtcblxuICAgIGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLnNlY3VyaXR5Py5lbmFibGUoKSwgdGhpcy5uZXR3b3JrPy5lbmFibGUoKV0pO1xuICB9XG59XG4iXX0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FAILED_TO_CONNECT = exports.CONNECTION_IS_NOT_DEFINED = exports.DISCONNECTED = exports.CONNECTED = exports.ATTEMPT_TO_CONNECT = exports.FAILED_ATTEMPT_TO_CONNECT = void 0;\nexports.FAILED_ATTEMPT_TO_CONNECT = `Failed to connect to Chrome Debugging Protocol`;\nexports.ATTEMPT_TO_CONNECT = `Attempting to connect to Chrome Debugging Protocol`;\nexports.CONNECTED = `Connected to Chrome Debugging Protocol`;\nexports.DISCONNECTED = `Chrome Debugging Protocol disconnected`;\nexports.CONNECTION_IS_NOT_DEFINED = `Connection to Chrome Debugging Protocol isn't defined yet.`;\nexports.FAILED_TO_CONNECT = `${exports.FAILED_ATTEMPT_TO_CONNECT}\n\nCommon situations why this would fail:\n  - you forgot to run Chrome in headless mode\n  - you use Chrome version 58 or earlier\n  - you have weird RDP configuration settings\n  \nThe stack trace for this error is:`;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ1JJT3V0cHV0TWVzc2FnZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY2RwL0NSSU91dHB1dE1lc3NhZ2VzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFhLFFBQUEseUJBQXlCLEdBQUcsZ0RBQWdELENBQUM7QUFDN0UsUUFBQSxrQkFBa0IsR0FBRyxvREFBb0QsQ0FBQztBQUMxRSxRQUFBLFNBQVMsR0FBRyx3Q0FBd0MsQ0FBQztBQUNyRCxRQUFBLFlBQVksR0FBRyx3Q0FBd0MsQ0FBQztBQUN4RCxRQUFBLHlCQUF5QixHQUFHLDREQUE0RCxDQUFDO0FBQ3pGLFFBQUEsaUJBQWlCLEdBQUcsR0FBRyxpQ0FBeUI7Ozs7Ozs7bUNBTzFCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgRkFJTEVEX0FUVEVNUFRfVE9fQ09OTkVDVCA9IGBGYWlsZWQgdG8gY29ubmVjdCB0byBDaHJvbWUgRGVidWdnaW5nIFByb3RvY29sYDtcbmV4cG9ydCBjb25zdCBBVFRFTVBUX1RPX0NPTk5FQ1QgPSBgQXR0ZW1wdGluZyB0byBjb25uZWN0IHRvIENocm9tZSBEZWJ1Z2dpbmcgUHJvdG9jb2xgO1xuZXhwb3J0IGNvbnN0IENPTk5FQ1RFRCA9IGBDb25uZWN0ZWQgdG8gQ2hyb21lIERlYnVnZ2luZyBQcm90b2NvbGA7XG5leHBvcnQgY29uc3QgRElTQ09OTkVDVEVEID0gYENocm9tZSBEZWJ1Z2dpbmcgUHJvdG9jb2wgZGlzY29ubmVjdGVkYDtcbmV4cG9ydCBjb25zdCBDT05ORUNUSU9OX0lTX05PVF9ERUZJTkVEID0gYENvbm5lY3Rpb24gdG8gQ2hyb21lIERlYnVnZ2luZyBQcm90b2NvbCBpc24ndCBkZWZpbmVkIHlldC5gO1xuZXhwb3J0IGNvbnN0IEZBSUxFRF9UT19DT05ORUNUID0gYCR7RkFJTEVEX0FUVEVNUFRfVE9fQ09OTkVDVH1cblxuQ29tbW9uIHNpdHVhdGlvbnMgd2h5IHRoaXMgd291bGQgZmFpbDpcbiAgLSB5b3UgZm9yZ290IHRvIHJ1biBDaHJvbWUgaW4gaGVhZGxlc3MgbW9kZVxuICAtIHlvdSB1c2UgQ2hyb21lIHZlcnNpb24gNTggb3IgZWFybGllclxuICAtIHlvdSBoYXZlIHdlaXJkIFJEUCBjb25maWd1cmF0aW9uIHNldHRpbmdzXG4gIFxuVGhlIHN0YWNrIHRyYWNlIGZvciB0aGlzIGVycm9yIGlzOmA7XG4iXX0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RetryStrategy = void 0;\nconst tslib_1 = require(\"tslib\");\nclass RetryStrategy {\n    constructor(maxRetries, initialBackoff, maximumBackoff) {\n        this._times = 0;\n        this.maxRetries = maxRetries;\n        this.backoffTime = initialBackoff;\n        this.maximumBackoff = maximumBackoff;\n    }\n    // eslint-disable-next-line space-before-function-paren\n    execute(task) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const timeout = this.nextTime();\n            if (timeout) {\n                yield this.delay(timeout);\n                yield task();\n            }\n            return this.maxRetries - this._times;\n        });\n    }\n    delay(timeout) {\n        return new Promise((resolve) => setTimeout(resolve, timeout));\n    }\n    nextTime() {\n        if (this._times < this.maxRetries) {\n            return this.increaseBackoffTime();\n        }\n    }\n    increaseBackoffTime() {\n        this.backoffTime *= Math.pow(2, ++this._times - 1);\n        return Math.min(this.backoffTime, this.maximumBackoff);\n    }\n}\nexports.RetryStrategy = RetryStrategy;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmV0cnlTdHJhdGVneS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jZHAvUmV0cnlTdHJhdGVneS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsTUFBYSxhQUFhO0lBTXhCLFlBQ0UsVUFBa0IsRUFDbEIsY0FBc0IsRUFDdEIsY0FBc0I7UUFFdEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFDaEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxjQUFjLENBQUM7UUFDbEMsSUFBSSxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUM7SUFDdkMsQ0FBQztJQUVELHVEQUF1RDtJQUMxQyxPQUFPLENBQ2xCLElBQU87O1lBRVAsTUFBTSxPQUFPLEdBQXVCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUVwRCxJQUFJLE9BQU8sRUFBRTtnQkFDWCxNQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBRTFCLE1BQU0sSUFBSSxFQUFFLENBQUM7YUFDZDtZQUVELE9BQU8sSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3ZDLENBQUM7S0FBQTtJQUVPLEtBQUssQ0FBQyxPQUFlO1FBQzNCLE9BQU8sSUFBSSxPQUFPLENBQ2hCLENBQUMsT0FBTyxFQUFXLEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUNuRCxDQUFDO0lBQ0osQ0FBQztJQUVPLFFBQVE7UUFDZCxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNqQyxPQUFPLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1NBQ25DO0lBQ0gsQ0FBQztJQUVPLG1CQUFtQjtRQUN6QixJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztRQUVuRCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDekQsQ0FBQztDQUNGO0FBakRELHNDQWlEQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUaW1lb3V0ID0gTm9kZUpTLlRpbWVvdXQ7XG5cbmV4cG9ydCBjbGFzcyBSZXRyeVN0cmF0ZWd5IHtcbiAgcHJpdmF0ZSBfdGltZXM6IG51bWJlcjtcbiAgcHJpdmF0ZSBiYWNrb2ZmVGltZTogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IG1heGltdW1CYWNrb2ZmOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4UmV0cmllczogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIG1heFJldHJpZXM6IG51bWJlcixcbiAgICBpbml0aWFsQmFja29mZjogbnVtYmVyLFxuICAgIG1heGltdW1CYWNrb2ZmOiBudW1iZXJcbiAgKSB7XG4gICAgdGhpcy5fdGltZXMgPSAwO1xuICAgIHRoaXMubWF4UmV0cmllcyA9IG1heFJldHJpZXM7XG4gICAgdGhpcy5iYWNrb2ZmVGltZSA9IGluaXRpYWxCYWNrb2ZmO1xuICAgIHRoaXMubWF4aW11bUJhY2tvZmYgPSBtYXhpbXVtQmFja29mZjtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBzcGFjZS1iZWZvcmUtZnVuY3Rpb24tcGFyZW5cbiAgcHVibGljIGFzeW5jIGV4ZWN1dGU8VCBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gdW5rbm93bj4oXG4gICAgdGFzazogVFxuICApOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHRpbWVvdXQ6IG51bWJlciB8IHVuZGVmaW5lZCA9IHRoaXMubmV4dFRpbWUoKTtcblxuICAgIGlmICh0aW1lb3V0KSB7XG4gICAgICBhd2FpdCB0aGlzLmRlbGF5KHRpbWVvdXQpO1xuXG4gICAgICBhd2FpdCB0YXNrKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubWF4UmV0cmllcyAtIHRoaXMuX3RpbWVzO1xuICB9XG5cbiAgcHJpdmF0ZSBkZWxheSh0aW1lb3V0OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oXG4gICAgICAocmVzb2x2ZSk6IFRpbWVvdXQgPT4gc2V0VGltZW91dChyZXNvbHZlLCB0aW1lb3V0KVxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIG5leHRUaW1lKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHRoaXMuX3RpbWVzIDwgdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbmNyZWFzZUJhY2tvZmZUaW1lKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpbmNyZWFzZUJhY2tvZmZUaW1lKCk6IG51bWJlciB7XG4gICAgdGhpcy5iYWNrb2ZmVGltZSAqPSBNYXRoLnBvdygyLCArK3RoaXMuX3RpbWVzIC0gMSk7XG5cbiAgICByZXR1cm4gTWF0aC5taW4odGhpcy5iYWNrb2ZmVGltZSwgdGhpcy5tYXhpbXVtQmFja29mZik7XG4gIH1cbn1cbiJdfQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RetryStrategy = exports.CRIConnection = void 0;\nvar CRIConnection_1 = require(\"./CRIConnection\");\nObject.defineProperty(exports, \"CRIConnection\", { enumerable: true, get: function () { return CRIConnection_1.CRIConnection; } });\nvar RetryStrategy_1 = require(\"./RetryStrategy\");\nObject.defineProperty(exports, \"RetryStrategy\", { enumerable: true, get: function () { return RetryStrategy_1.RetryStrategy; } });\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY2RwL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlEQUl5QjtBQUh2Qiw4R0FBQSxhQUFhLE9BQUE7QUFJZixpREFBZ0Q7QUFBdkMsOEdBQUEsYUFBYSxPQUFBIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHtcbiAgQ1JJQ29ubmVjdGlvbixcbiAgQ2hyb21lUmVtb3RlSW50ZXJmYWNlRXZlbnQsXG4gIENocm9tZVJlbW90ZUludGVyZmFjZU1ldGhvZFxufSBmcm9tICcuL0NSSUNvbm5lY3Rpb24nO1xuZXhwb3J0IHsgUmV0cnlTdHJhdGVneSB9IGZyb20gJy4vUmV0cnlTdHJhdGVneSc7XG4iXX0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CookieParser = void 0;\nconst NetworkCookie_1 = require(\"./NetworkCookie\");\nclass CookieParser {\n    constructor() {\n        this._lastCookiePosition = 0;\n    }\n    parseCookie(cookieHeader) {\n        if (!this._initialize(cookieHeader)) {\n            return;\n        }\n        for (let kv = this._extractKeyValue(); kv; kv = this._extractKeyValue()) {\n            if (kv.key.charAt(0) === '$' && this._lastCookie) {\n                this._lastCookie.addAttribute(kv.key.slice(1), kv.value);\n            }\n            else if (kv.key.toLowerCase() !== '$version' &&\n                typeof kv.value === 'string') {\n                this.addCookie(kv);\n            }\n            this.advanceAndCheckCookieDelimiter();\n        }\n        this.flushCookie();\n        return this._cookies;\n    }\n    parseSetCookie(setCookieHeader) {\n        if (!this._initialize(setCookieHeader)) {\n            return;\n        }\n        for (let kv = this._extractKeyValue(); kv; kv = this._extractKeyValue()) {\n            if (this._lastCookie) {\n                this._lastCookie.addAttribute(kv.key, kv.value);\n            }\n            else {\n                this.addCookie(kv);\n            }\n            if (this.advanceAndCheckCookieDelimiter()) {\n                this.flushCookie();\n            }\n        }\n        this.flushCookie();\n        return this._cookies;\n    }\n    _initialize(headerValue) {\n        this._input = headerValue;\n        if (typeof headerValue !== 'string') {\n            return false;\n        }\n        this._cookies = [];\n        this._lastCookie = undefined;\n        this._originalInputLength = this._input.length;\n        return true;\n    }\n    flushCookie() {\n        if (this._lastCookie) {\n            this._lastCookie.size =\n                this._originalInputLength -\n                    this._input.length -\n                    this._lastCookiePosition;\n        }\n        delete this._lastCookie;\n    }\n    _extractKeyValue() {\n        var _a, _b;\n        if (!((_a = this._input) === null || _a === void 0 ? void 0 : _a.length)) {\n            return;\n        }\n        // Note: RFCs offer an option for quoted values that may contain commas and semicolons.\n        // Many browsers/platforms do not support this, however (see http://webkit.org/b/16699\n        // and http://crbug.com/12361). The logic below matches latest versions of IE, Firefox,\n        // Chrome and Safari on some old platforms. The latest version of Safari supports quoted\n        // cookie values, though.\n        const keyValueMatch = /^[ \\t]*([^\\s=;]+)[ \\t]*(?:=[ \\t]*([^;\\n]*))?/i.exec(this._input);\n        if (!keyValueMatch) {\n            return;\n        }\n        const result = {\n            key: this.toCamelCase(keyValueMatch[1]),\n            value: (_b = keyValueMatch[2]) === null || _b === void 0 ? void 0 : _b.trim(),\n            position: this._originalInputLength - this._input.length\n        };\n        this._input = this._input.slice(keyValueMatch[0].length);\n        return result;\n    }\n    toCamelCase(str) {\n        return str\n            .replace(/\\s(.)/g, (m) => m.toUpperCase())\n            .replace(/\\s/g, '')\n            .replace(/^(.)/, (m) => m.toLowerCase());\n    }\n    advanceAndCheckCookieDelimiter() {\n        const match = /^\\s*[\\n;]\\s*/.exec(this._input);\n        if (!match) {\n            return false;\n        }\n        this._input = this._input.slice(match[0].length);\n        return match[0].match('\\n') !== null;\n    }\n    addCookie(keyValue) {\n        if (this._lastCookie) {\n            this._lastCookie.size = keyValue.position - this._lastCookiePosition;\n        }\n        this._lastCookie =\n            typeof keyValue.value === 'string'\n                ? new NetworkCookie_1.NetworkCookie(keyValue.key, keyValue.value)\n                : new NetworkCookie_1.NetworkCookie('', keyValue.key);\n        this._lastCookiePosition = keyValue.position;\n        this._cookies.push(this._lastCookie);\n    }\n}\nexports.CookieParser = CookieParser;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29va2llUGFyc2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL25ldHdvcmsvQ29va2llUGFyc2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1EQUFnRDtBQVFoRCxNQUFhLFlBQVk7SUFBekI7UUFJVSx3QkFBbUIsR0FBVyxDQUFDLENBQUM7SUFrSTFDLENBQUM7SUEvSFEsV0FBVyxDQUFDLFlBQW9CO1FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQWEsQ0FBQyxFQUFFO1lBQ3BDLE9BQU87U0FDUjtRQUVELEtBQUssSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtZQUN2RSxJQUFJLEVBQUUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUNoRCxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDMUQ7aUJBQU0sSUFDTCxFQUFFLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxLQUFLLFVBQVU7Z0JBQ25DLE9BQU8sRUFBRSxDQUFDLEtBQUssS0FBSyxRQUFRLEVBQzVCO2dCQUNBLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7YUFDcEI7WUFFRCxJQUFJLENBQUMsOEJBQThCLEVBQUUsQ0FBQztTQUN2QztRQUVELElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVuQixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztJQUVNLGNBQWMsQ0FBQyxlQUF1QjtRQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxlQUFl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QUFLLEdBQTJCLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU8sQ0FBQyxDQUFDO1FBRXhFLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDVixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFbEQsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksQ0FBQztJQUN2QyxDQUFDO0lBRU8sU0FBUyxDQUFDLFFBQWtCO1FBQ2xDLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQztTQUN0RTtRQUVELElBQUksQ0FBQyxXQUFXO1lBQ2QsT0FBTyxRQUFRLENBQUMsS0FBSyxLQUFLLFFBQVE7Z0JBQ2hDLENBQUMsQ0FBQyxJQUFJLDZCQUFhLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDO2dCQUNqRCxDQUFDLENBQUMsSUFBSSw2QkFBYSxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFMUMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUM7UUFDN0MsSUFBSSxDQUFDLFFBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Q0FDRjtBQXRJRCxvQ0FzSUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXR3b3JrQ29va2llIH0gZnJvbSAnLi9OZXR3b3JrQ29va2llJztcblxuaW50ZXJmYWNlIEtleVZhbHVlIHtcbiAga2V5OiBzdHJpbmc7XG4gIHZhbHVlPzogc3RyaW5nO1xuICBwb3NpdGlvbjogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgQ29va2llUGFyc2VyIHtcbiAgcHJpdmF0ZSBfaW5wdXQ/OiBzdHJpbmc7XG4gIHByaXZhdGUgX29yaWdpbmFsSW5wdXRMZW5ndGg/OiBudW1iZXI7XG4gIHByaXZhdGUgX2xhc3RDb29raWU/OiBOZXR3b3JrQ29va2llO1xuICBwcml2YXRlIF9sYXN0Q29va2llUG9zaXRpb246IG51bWJlciA9IDA7XG4gIHByaXZhdGUgX2Nvb2tpZXM/OiBOZXR3b3JrQ29va2llW107XG5cbiAgcHVibGljIHBhcnNlQ29va2llKGNvb2tpZUhlYWRlcjogc3RyaW5nKTogTmV0d29ya0Nvb2tpZVtdIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuX2luaXRpYWxpemUoY29va2llSGVhZGVyISkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBrdiA9IHRoaXMuX2V4dHJhY3RLZXlWYWx1ZSgpOyBrdjsga3YgPSB0aGlzLl9leHRyYWN0S2V5VmFsdWUoKSkge1xuICAgICAgaWYgKGt2LmtleS5jaGFyQXQoMCkgPT09ICckJyAmJiB0aGlzLl9sYXN0Q29va2llKSB7XG4gICAgICAgIHRoaXMuX2xhc3RDb29raWUuYWRkQXR0cmlidXRlKGt2LmtleS5zbGljZSgxKSwga3YudmFsdWUpO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAga3Yua2V5LnRvTG93ZXJDYXNlKCkgIT09ICckdmVyc2lvbicgJiZcbiAgICAgICAgdHlwZW9mIGt2LnZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgKSB7XG4gICAgICAgIHRoaXMuYWRkQ29va2llKGt2KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hZHZhbmNlQW5kQ2hlY2tDb29raWVEZWxpbWl0ZXIoKTtcbiAgICB9XG5cbiAgICB0aGlzLmZsdXNoQ29va2llKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY29va2llcztcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZVNldENvb2tpZShzZXRDb29raWVIZWFkZXI6IHN0cmluZyk6IE5ldHdvcmtDb29raWVbXSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLl9pbml0aWFsaXplKHNldENvb2tpZUhlYWRlcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBrdiA9IHRoaXMuX2V4dHJhY3RLZXlWYWx1ZSgpOyBrdjsga3YgPSB0aGlzLl9leHRyYWN0S2V5VmFsdWUoKSkge1xuICAgICAgaWYgKHRoaXMuX2xhc3RDb29raWUpIHtcbiAgICAgICAgdGhpcy5fbGFzdENvb2tpZS5hZGRBdHRyaWJ1dGUoa3Yua2V5LCBrdi52YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmFkZENvb2tpZShrdik7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5hZHZhbmNlQW5kQ2hlY2tDb29raWVEZWxpbWl0ZXIoKSkge1xuICAgICAgICB0aGlzLmZsdXNoQ29va2llKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZmx1c2hDb29raWUoKTtcblxuICAgIHJldHVybiB0aGlzLl9jb29raWVzO1xuICB9XG5cbiAgcHJpdmF0ZSBfaW5pdGlhbGl6ZShoZWFkZXJWYWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgdGhpcy5faW5wdXQgPSBoZWFkZXJWYWx1ZTtcbiAgICBpZiAodHlwZW9mIGhlYWRlclZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aGlzLl9jb29raWVzID0gW107XG4gICAgdGhpcy5fbGFzdENvb2tpZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9vcmlnaW5hbElucHV0TGVuZ3RoID0gdGhpcy5faW5wdXQhLmxlbmd0aDtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcHJpdmF0ZSBmbHVzaENvb2tpZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fbGFzdENvb2tpZSkge1xuICAgICAgdGhpcy5fbGFzdENvb2tpZS5zaXplID1cbiAgICAgICAgdGhpcy5fb3JpZ2luYWxJbnB1dExlbmd0aCEgLVxuICAgICAgICB0aGlzLl9pbnB1dCEubGVuZ3RoIC1cbiAgICAgICAgdGhpcy5fbGFzdENvb2tpZVBvc2l0aW9uO1xuICAgIH1cblxuICAgIGRlbGV0ZSB0aGlzLl9sYXN0Q29va2llO1xuICB9XG5cbiAgcHJpdmF0ZSBfZXh0cmFjdEtleVZhbHVlKCk6IEtleVZhbHVlIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuX2lucHV0Py5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBOb3RlOiBSRkNzIG9mZmVyIGFuIG9wdGlvbiBmb3IgcXVvdGVkIHZhbHVlcyB0aGF0IG1heSBjb250YWluIGNvbW1hcyBhbmQgc2VtaWNvbG9ucy5cbiAgICAvLyBNYW55IGJyb3dzZXJzL3BsYXRmb3JtcyBkbyBub3Qgc3VwcG9ydCB0aGlzLCBob3dldmVyIChzZWUgaHR0cDovL3dlYmtpdC5vcmcvYi8xNjY5OVxuICAgIC8vIGFuZCBodHRwOi8vY3JidWcuY29tLzEyMzYxKS4gVGhlIGxvZ2ljIGJlbG93IG1hdGNoZXMgbGF0ZXN0IHZlcnNpb25zIG9mIElFLCBGaXJlZm94LFxuICAgIC8vIENocm9tZSBhbmQgU2FmYXJpIG9uIHNvbWUgb2xkIHBsYXRmb3Jtcy4gVGhlIGxhdGVzdCB2ZXJzaW9uIG9mIFNhZmFyaSBzdXBwb3J0cyBxdW90ZWRcbiAgICAvLyBjb29raWUgdmFsdWVzLCB0aG91Z2guXG4gICAgY29uc3Qga2V5VmFsdWVNYXRjaCA9IC9eWyBcXHRdKihbXlxccz07XSspWyBcXHRdKig/Oj1bIFxcdF0qKFteO1xcbl0qKSk/L2kuZXhlYyhcbiAgICAgIHRoaXMuX2lucHV0XG4gICAgKTtcblxuICAgIGlmICgha2V5VmFsdWVNYXRjaCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdDogS2V5VmFsdWUgPSB7XG4gICAgICBrZXk6IHRoaXMudG9DYW1lbENhc2Uoa2V5VmFsdWVNYXRjaFsxXSksXG4gICAgICB2YWx1ZToga2V5VmFsdWVNYXRjaFsyXT8udHJpbSgpLFxuICAgICAgcG9zaXRpb246IHRoaXMuX29yaWdpbmFsSW5wdXRMZW5ndGghIC0gdGhpcy5faW5wdXQubGVuZ3RoXG4gICAgfTtcblxuICAgIHRoaXMuX2lucHV0ID0gdGhpcy5faW5wdXQuc2xpY2Uoa2V5VmFsdWVNYXRjaFswXS5sZW5ndGgpO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgdG9DYW1lbENhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzdHJcbiAgICAgIC5yZXBsYWNlKC9cXHMoLikvZywgKG06IHN0cmluZyk6IHN0cmluZyA9PiBtLnRvVXBwZXJDYXNlKCkpXG4gICAgICAucmVwbGFjZSgvXFxzL2csICcnKVxuICAgICAgLnJlcGxhY2UoL14oLikvLCAobTogc3RyaW5nKTogc3RyaW5nID0+IG0udG9Mb3dlckNhc2UoKSk7XG4gIH1cblxuICBwcml2YXRlIGFkdmFuY2VBbmRDaGVja0Nvb2tpZURlbGltaXRlcigpOiBib29sZWFuIHtcbiAgICBjb25zdCBtYXRjaDogUmVnRXhwRXhlY0FycmF5IHwgbnVsbCA9IC9eXFxzKltcXG47XVxccyovLmV4ZWModGhpcy5faW5wdXQhKTtcblxuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0IS5zbGljZShtYXRjaFswXS5sZW5ndGgpO1xuXG4gICAgcmV0dXJuIG1hdGNoWzBdLm1hdGNoKCdcXG4nKSAhPT0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYWRkQ29va2llKGtleVZhbHVlOiBLZXlWYWx1ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9sYXN0Q29va2llKSB7XG4gICAgICB0aGlzLl9sYXN0Q29va2llLnNpemUgPSBrZXlWYWx1ZS5wb3NpdGlvbiAtIHRoaXMuX2xhc3RDb29raWVQb3NpdGlvbjtcbiAgICB9XG5cbiAgICB0aGlzLl9sYXN0Q29va2llID1cbiAgICAgIHR5cGVvZiBrZXlWYWx1ZS52YWx1ZSA9PT0gJ3N0cmluZydcbiAgICAgICAgPyBuZXcgTmV0d29ya0Nvb2tpZShrZXlWYWx1ZS5rZXksIGtleVZhbHVlLnZhbHVlKVxuICAgICAgICA6IG5ldyBOZXR3b3JrQ29va2llKCcnLCBrZXlWYWx1ZS5rZXkpO1xuXG4gICAgdGhpcy5fbGFzdENvb2tpZVBvc2l0aW9uID0ga2V5VmFsdWUucG9zaXRpb247XG4gICAgdGhpcy5fY29va2llcyEucHVzaCh0aGlzLl9sYXN0Q29va2llKTtcbiAgfVxufVxuIl19","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EntryBuilder = void 0;\nconst tslib_1 = require(\"tslib\");\nclass EntryBuilder {\n    constructor(request) {\n        this.request = request;\n    }\n    build() {\n        var _a;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            let serverIPAddress = this.request.remoteAddress;\n            const portPositionInString = serverIPAddress.lastIndexOf(':');\n            if (portPositionInString !== -1) {\n                serverIPAddress = serverIPAddress.substr(0, portPositionInString);\n            }\n            const timings = this.buildTimings();\n            const time = Object.values(timings).reduce((acc, t) => (acc += Math.max(t, 0)), 0);\n            const entry = {\n                startedDateTime: new Date(this.request.getWallTime(this.request.issueTime) * 1000).toJSON(),\n                time,\n                request: yield this.buildRequest(),\n                response: yield this.buildResponse(),\n                cache: {},\n                timings,\n                serverIPAddress: serverIPAddress.replace(/\\[]/g, ''),\n                _priority: this.request.priority,\n                _resourceType: this.request.resourceType,\n                _webSocketMessages: (_a = this.request.frames) !== null && _a !== void 0 ? _a : []\n            };\n            if (this.request.connectionId !== '0') {\n                entry.connection = this.request.connectionId;\n            }\n            return entry;\n        });\n    }\n    getResponseBodySize() {\n        if (this.request.statusCode === 304) {\n            return 0;\n        }\n        if (!this.request.responseHeadersText) {\n            return -1;\n        }\n        return this.request.transferSize - this.request.responseHeadersText.length;\n    }\n    getResponseCompression() {\n        if (this.request.statusCode === 304 || this.request.statusCode === 206) {\n            return;\n        }\n        if (!this.request.responseHeadersText) {\n            return;\n        }\n        return this.request.resourceSize - this.getResponseBodySize();\n    }\n    toMilliseconds(time) {\n        return time === -1 ? -1 : time * 1000;\n    }\n    buildRequest() {\n        var _a, _b, _c, _d;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const res = {\n                method: this.request.requestMethod,\n                url: this.buildRequestURL(this.request.url),\n                httpVersion: this.request.requestHttpVersion,\n                headers: this.request.requestHeaders,\n                queryString: [...((_a = this.request.queryParameters) !== null && _a !== void 0 ? _a : [])],\n                cookies: this.buildCookies((_b = this.request.requestCookies) !== null && _b !== void 0 ? _b : []),\n                headersSize: (_d = (_c = this.request.requestHeadersText) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : -1,\n                bodySize: yield this.requestBodySize()\n            };\n            const postData = yield this.buildPostData();\n            if (postData) {\n                res.postData = postData;\n            }\n            return res;\n        });\n    }\n    buildResponse() {\n        var _a, _b, _c;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            return {\n                status: this.request.statusCode,\n                statusText: this.request.statusText,\n                httpVersion: this.request.responseHttpVersion(),\n                headers: this.request.responseHeaders,\n                cookies: this.buildCookies(this.request.responseCookies || []),\n                content: yield this.buildContent(),\n                redirectURL: (_a = this.request.responseHeaderValue('Location')) !== null && _a !== void 0 ? _a : '',\n                headersSize: (_c = (_b = this.request.responseHeadersText) === null || _b === void 0 ? void 0 : _b.length) !== null && _c !== void 0 ? _c : -1,\n                bodySize: this.getResponseBodySize(),\n                _transferSize: this.request.transferSize\n            };\n        });\n    }\n    buildContent() {\n        var _a;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const data = yield this.request.contentData();\n            return Object.assign({\n                size: this.request.resourceSize,\n                mimeType: this.request.mimeType || 'x-unknown',\n                compression: (_a = this.getResponseCompression()) !== null && _a !== void 0 ? _a : undefined\n            }, data);\n        });\n    }\n    // eslint-disable-next-line complexity\n    buildTimings() {\n        var _a;\n        const timing = this.request.timing;\n        const issueTime = this.request.issueTime;\n        const startTime = this.request.startTime;\n        const result = {\n            blocked: -1,\n            dns: -1,\n            ssl: -1,\n            connect: -1,\n            send: 0,\n            wait: 0,\n            receive: 0\n        };\n        const queuedTime = issueTime < startTime ? startTime - issueTime : -1;\n        result.blocked = this.toMilliseconds(queuedTime);\n        let highestTime = 0;\n        if (timing) {\n            const blockedStart = this.leastNonNegative([\n                timing.dnsStart,\n                timing.connectStart,\n                timing.sendStart\n            ]);\n            if (blockedStart !== Infinity) {\n                result.blocked += blockedStart;\n            }\n            const dnsStart = timing.dnsEnd >= 0 ? blockedStart : 0;\n            const dnsEnd = timing.dnsEnd >= 0 ? timing.dnsEnd : -1;\n            result.dns = dnsEnd - dnsStart;\n            const sslStart = timing.sslEnd > 0 ? timing.sslStart : 0;\n            const sslEnd = timing.sslEnd > 0 ? timing.sslEnd : -1;\n            result.ssl = sslEnd - sslStart;\n            const connectStart = timing.connectEnd >= 0\n                ? this.leastNonNegative([dnsEnd, blockedStart])\n                : 0;\n            const connectEnd = timing.connectEnd >= 0 ? timing.connectEnd : -1;\n            result.connect = connectEnd - connectStart;\n            const sendStart = timing.sendEnd >= 0 ? Math.max(connectEnd, dnsEnd, blockedStart) : 0;\n            const sendEnd = timing.sendEnd >= 0 ? timing.sendEnd : 0;\n            result.send = sendEnd - sendStart;\n            if (result.send < 0) {\n                result.send = 0;\n            }\n            highestTime = Math.max(sendEnd, connectEnd, sslEnd, dnsEnd, blockedStart, 0);\n        }\n        else if (this.request.responseReceivedTime === -1) {\n            result.blocked = this.request.endTime - issueTime;\n            return result;\n        }\n        const requestTime = (_a = timing === null || timing === void 0 ? void 0 : timing.requestTime) !== null && _a !== void 0 ? _a : startTime;\n        const waitStart = highestTime;\n        const waitEnd = this.toMilliseconds(this.request.responseReceivedTime - requestTime);\n        result.wait = waitEnd - waitStart;\n        const receiveStart = waitEnd;\n        const receiveEnd = this.toMilliseconds(this.request.endTime - requestTime);\n        result.receive = Math.max(receiveEnd - receiveStart, 0);\n        return result;\n    }\n    leastNonNegative(values) {\n        const value = values.find((item) => item >= 0);\n        return value !== null && value !== void 0 ? value : -1;\n    }\n    buildPostData() {\n        var _a;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const postData = yield this.request.requestFormData();\n            if (!postData) {\n                return;\n            }\n            const res = {\n                mimeType: (_a = this.request.requestContentType) !== null && _a !== void 0 ? _a : '',\n                text: postData\n            };\n            const formParameters = yield this.request.formParameters();\n            if (formParameters) {\n                res.params = [...formParameters];\n            }\n            return res;\n        });\n    }\n    buildRequestURL(url) {\n        return url.split('#', 2)[0];\n    }\n    buildCookies(cookies) {\n        return cookies.map(this.buildCookie.bind(this));\n    }\n    buildCookie(cookie) {\n        var _a;\n        return {\n            name: cookie.name,\n            value: cookie.value,\n            path: cookie.path,\n            domain: cookie.domain,\n            expires: (_a = cookie\n                .expiresDate(new Date(this.request.getWallTime(this.request.startTime) * 1000))) === null || _a === void 0 ? void 0 : _a.toJSON(),\n            httpOnly: cookie.httpOnly,\n            secure: cookie.secure\n        };\n    }\n    requestBodySize() {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const postData = yield this.request.requestFormData();\n            if (!postData) {\n                return 0;\n            }\n            return this.request.contentLength;\n        });\n    }\n}\nexports.EntryBuilder = EntryBuilder;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRW50cnlCdWlsZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL25ldHdvcmsvRW50cnlCdWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFjQSxNQUFhLFlBQVk7SUFDdkIsWUFBNkIsT0FBdUI7UUFBdkIsWUFBTyxHQUFQLE9BQU8sQ0FBZ0I7SUFBRyxDQUFDO0lBRTNDLEtBQUs7OztZQUNoQixJQUFJLGVBQWUsR0FBVyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQztZQUV6RCxNQUFNLG9CQUFvQixHQUFXLGVBQWUsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7WUFFdEUsSUFBSSxvQkFBb0IsS0FBSyxDQUFDLENBQUMsRUFBRTtnQkFDL0IsZUFBZSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLG9CQUFvQixDQUFDLENBQUM7YUFDbkU7WUFFRCxNQUFNLE9BQU8sR0FBWSxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFFN0MsTUFBTSxJQUFJLEdBQVcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQ2hELENBQUMsR0FBVyxFQUFFLENBQVMsRUFBVSxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFDM0QsQ0FBQyxDQUNGLENBQUM7WUFFRixNQUFNLEtBQUssR0FBUTtnQkFDakIsZUFBZSxFQUFFLElBQUksSUFBSSxDQUN2QixJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FDeEQsQ0FBQyxNQUFNLEVBQUU7Z0JBQ1YsSUFBSTtnQkFDSixPQUFPLEVBQUUsTUFBTSxJQUFJLENBQUMsWUFBWSxFQUFFO2dCQUNsQyxRQUFRLEVBQUUsTUFBTSxJQUFJLENBQUMsYUFBYSxFQUFFO2dCQUNw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LEVBQUU7WUFDWixRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVE7WUFDekIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNO1NBQ3RCLENBQUM7SUFDSixDQUFDO0lBRWEsZUFBZTs7WUFDM0IsTUFBTSxRQUFRLEdBQXVCLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUUxRSxJQUFJLENBQUMsUUFBUSxFQUFFO2dCQUNiLE9BQU8sQ0FBQyxDQUFDO2FBQ1Y7WUFFRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDO1FBQ3BDLENBQUM7S0FBQTtDQUNGO0FBMVFELG9DQTBRQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnRlbnREYXRhLCBOZXR3b3JrUmVxdWVzdCB9IGZyb20gJy4vTmV0d29ya1JlcXVlc3QnO1xuaW1wb3J0IHsgTmV0d29ya0Nvb2tpZSB9IGZyb20gJy4vTmV0d29ya0Nvb2tpZSc7XG5pbXBvcnQge1xuICBDb250ZW50LFxuICBDb29raWUsXG4gIEVudHJ5LFxuICBQYXJhbSxcbiAgUG9zdERhdGEsXG4gIFJlcXVlc3QsXG4gIFJlc3BvbnNlLFxuICBUaW1pbmdzXG59IGZyb20gJ2hhci1mb3JtYXQnO1xuaW1wb3J0IFByb3RvY29sIGZyb20gJ2RldnRvb2xzLXByb3RvY29sJztcblxuZXhwb3J0IGNsYXNzIEVudHJ5QnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgcmVxdWVzdDogTmV0d29ya1JlcXVlc3QpIHt9XG5cbiAgcHVibGljIGFzeW5jIGJ1aWxkKCk6IFByb21pc2U8RW50cnk+IHtcbiAgICBsZXQgc2VydmVySVBBZGRyZXNzOiBzdHJpbmcgPSB0aGlzLnJlcXVlc3QucmVtb3RlQWRkcmVzcztcblxuICAgIGNvbnN0IHBvcnRQb3NpdGlvbkluU3RyaW5nOiBudW1iZXIgPSBzZXJ2ZXJJUEFkZHJlc3MubGFzdEluZGV4T2YoJzonKTtcblxuICAgIGlmIChwb3J0UG9zaXRpb25JblN0cmluZyAhPT0gLTEpIHtcbiAgICAgIHNlcnZlcklQQWRkcmVzcyA9IHNlcnZlcklQQWRkcmVzcy5zdWJzdHIoMCwgcG9ydFBvc2l0aW9uSW5TdHJpbmcpO1xuICAgIH1cblxuICAgIGNvbnN0IHRpbWluZ3M6IFRpbWluZ3MgPSB0aGlzLmJ1aWxkVGltaW5ncygpO1xuXG4gICAgY29uc3QgdGltZTogbnVtYmVyID0gT2JqZWN0LnZhbHVlcyh0aW1pbmdzKS5yZWR1Y2UoXG4gICAgICAoYWNjOiBudW1iZXIsIHQ6IG51bWJlcik6IG51bWJlciA9PiAoYWNjICs9IE1hdGgubWF4KHQsIDApKSxcbiAgICAgIDBcbiAgICApO1xuXG4gICAgY29uc3QgZW50cnk6IGFueSA9IHtcbiAgICAgIHN0YXJ0ZWREYXRlVGltZTogbmV3IERhdGUoXG4gICAgICAgIHRoaXMucmVxdWVzdC5nZXRXYWxsVGltZSh0aGlzLnJlcXVlc3QuaXNzdWVUaW1lKSAqIDEwMDBcbiAgICAgICkudG9KU09OKCksXG4gICAgICB0aW1lLFxuICAgICAgcmVxdWVzdDogYXdhaXQgdGhpcy5idWlsZFJlcXVlc3QoKSxcbiAgICAgIHJlc3BvbnNlOiBhd2FpdCB0aGlzLmJ1aWxkUmVzcG9uc2UoKSxcbiAgICAgIGNhY2hlOiB7fSxcbiAgICAgIHRpbWluZ3MsXG4gICAgICBzZXJ2ZXJJUEFkZHJlc3M6IHNlcnZlcklQQWRkcmVzcy5yZXBsYWNlKC9cXFtdL2csICcnKSxcbiAgICAgIF9wcmlvcml0eTogdGhpcy5yZXF1ZXN0LnByaW9yaXR5LFxuICAgICAgX3Jlc291cmNlVHlwZTogdGhpcy5yZXF1ZXN0LnJlc291cmNlVHlwZSxcbiAgICAgIF93ZWJTb2NrZXRNZXNzYWdlczogdGhpcy5yZXF1ZXN0LmZyYW1lcyA/PyBbXVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5yZXF1ZXN0LmNvbm5lY3Rpb25JZCAhPT0gJzAnKSB7XG4gICAgICBlbnRyeS5jb25uZWN0aW9uID0gdGhpcy5yZXF1ZXN0LmNvbm5lY3Rpb25JZDtcbiAgICB9XG5cbiAgICByZXR1cm4gZW50cnk7XG4gIH1cblxuICBwcml2YXRlIGdldFJlc3BvbnNlQm9keVNpemUoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5yZXF1ZXN0LnN0YXR1c0NvZGUgPT09IDMwNCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnJlcXVlc3QucmVzcG9uc2VIZWFkZXJzVGV4dCkge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QudHJhbnNmZXJTaXplIC0gdGhpcy5yZXF1ZXN0LnJlc3BvbnNlSGVhZGVyc1RleHQubGVuZ3RoO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSZXNwb25zZUNvbXByZXNzaW9uKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHRoaXMucmVxdWVzdC5zdGF0dXNDb2RlID09PSAzMDQgfHwgdGhpcy5yZXF1ZXN0LnN0YXR1c0NvZGUgPT09IDIwNikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMucmVxdWVzdC5yZXNwb25zZUhlYWRlcnNUZXh0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdC5yZXNvdXJjZVNpemUgLSB0aGlzLmdldFJlc3BvbnNlQm9keVNpemUoKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9NaWxsaXNlY29uZHModGltZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGltZSA9PT0gLTEgPyAtMSA6IHRpbWUgKiAxMDAwO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBidWlsZFJlcXVlc3QoKTogUHJvbWlzZTxSZXF1ZXN0PiB7XG4gICAgY29uc3QgcmVzOiBSZXF1ZXN0ID0ge1xuICAgICAgbWV0aG9kOiB0aGlzLnJlcXVlc3QucmVxdWVzdE1ldGhvZCxcbiAgICAgIHVybDogdGhpcy5idWlsZFJlcXVlc3RVUkwodGhpcy5yZXF1ZXN0LnVybCksXG4gICAgICBodHRwVmVyc2lvbjogdGhpcy5yZXF1ZXN0LnJlcXVlc3RIdHRwVmVyc2lvbixcbiAgICAgIGhlYWRlcnM6IHRoaXMucmVxdWVzdC5yZXF1ZXN0SGVhZGVycyxcbiAgICAgIHF1ZXJ5U3RyaW5nOiBbLi4uKHRoaXMucmVxdWVzdC5xdWVyeVBhcmFtZXRlcnMgPz8gW10pXSxcbiAgICAgIGNvb2tpZXM6IHRoaXMuYnVpbGRDb29raWVzKHRoaXMucmVxdWVzdC5yZXF1ZXN0Q29va2llcyA/PyBbXSksXG4gICAgICBoZWFkZXJzU2l6ZTogdGhpcy5yZXF1ZXN0LnJlcXVlc3RIZWFkZXJzVGV4dD8ubGVuZ3RoID8/IC0xLFxuICAgICAgYm9keVNpemU6IGF3YWl0IHRoaXMucmVxdWVzdEJvZHlTaXplKClcbiAgICB9O1xuXG4gICAgY29uc3QgcG9zdERhdGE6IFBvc3REYXRhIHwgdW5kZWZpbmVkID0gYXdhaXQgdGhpcy5idWlsZFBvc3REYXRhKCk7XG5cbiAgICBpZiAocG9zdERhdGEpIHtcbiAgICAgIHJlcy5wb3N0RGF0YSA9IHBvc3REYXRhO1xuICAgIH1cblxuICAgIHJldHVybiByZXM7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGJ1aWxkUmVzcG9uc2UoKTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6IHRoaXMucmVxdWVzdC5zdGF0dXNDb2RlLFxuICAgICAgc3RhdHVzVGV4dDogdGhpcy5yZXF1ZXN0LnN0YXR1c1RleHQsXG4gICAgICBodHRwVmVyc2lvbjogdGhpcy5yZXF1ZXN0LnJlc3BvbnNlSHR0cFZlcnNpb24oKSxcbiAgICAgIGhlYWRlcnM6IHRoaXMucmVxdWVzdC5yZXNwb25zZUhlYWRlcnMsXG4gICAgICBjb29raWVzOiB0aGlzLmJ1aWxkQ29va2llcyh0aGlzLnJlcXVlc3QucmVzcG9uc2VDb29raWVzIHx8IFtdKSxcbiAgICAgIGNvbnRlbnQ6IGF3YWl0IHRoaXMuYnVpbGRDb250ZW50KCksXG4gICAgICByZWRpcmVjdFVSTDogdGhpcy5yZXF1ZXN0LnJlc3BvbnNlSGVhZGVyVmFsdWUoJ0xvY2F0aW9uJykgPz8gJycsXG4gICAgICBoZWFkZXJzU2l6ZTogdGhpcy5yZXF1ZXN0LnJlc3BvbnNlSGVhZGVyc1RleHQ/Lmxlbmd0aCA/PyAtMSxcbiAgICAgIGJvZHlTaXplOiB0aGlzLmdldFJlc3BvbnNlQm9keVNpemUoKSxcbiAgICAgIF90cmFuc2ZlclNpemU6IHRoaXMucmVxdWVzdC50cmFuc2ZlclNpemVcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBidWlsZENvbnRlbnQoKTogUHJvbWlzZTxDb250ZW50PiB7XG4gICAgY29uc3QgZGF0YTogQ29udGVudERhdGEgfCB1bmRlZmluZWQgPSBhd2FpdCB0aGlzLnJlcXVlc3QuY29udGVudERhdGEoKTtcblxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKFxuICAgICAge1xuICAgICAgICBzaXplOiB0aGlzLnJlcXVlc3QucmVzb3VyY2VTaXplLFxuICAgICAgICBtaW1lVHlwZTogdGhpcy5yZXF1ZXN0Lm1pbWVUeXBlIHx8ICd4LXVua25vd24nLFxuICAgICAgICBjb21wcmVzc2lvbjogdGhpcy5nZXRSZXNwb25zZUNvbXByZXNzaW9uKCkgPz8gdW5kZWZpbmVkXG4gICAgICB9LFxuICAgICAgZGF0YVxuICAgICk7XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGxleGl0eVxuICBwcml2YXRlIGJ1aWxkVGltaW5ncygpOiBUaW1pbmdzIHtcbiAgICBjb25zdCB0aW1pbmc6IFByb3RvY29sLk5ldHdvcmsuUmVzb3VyY2VUaW1pbmcgPSB0aGlzLnJlcXVlc3QudGltaW5nO1xuICAgIGNvbnN0IGlzc3VlVGltZTogbnVtYmVyID0gdGhpcy5yZXF1ZXN0Lmlzc3VlVGltZTtcbiAgICBjb25zdCBzdGFydFRpbWU6IG51bWJlciA9IHRoaXMucmVxdWVzdC5zdGFydFRpbWU7XG5cbiAgICBjb25zdCByZXN1bHQ6IFRpbWluZ3MgPSB7XG4gICAgICBibG9ja2VkOiAtMSxcbiAgICAgIGRuczogLTEsXG4gICAgICBzc2w6IC0xLFxuICAgICAgY29ubmVjdDogLTEsXG4gICAgICBzZW5kOiAwLFxuICAgICAgd2FpdDogMCxcbiAgICAgIHJlY2VpdmU6IDBcbiAgICB9O1xuXG4gICAgY29uc3QgcXVldWVkVGltZTogbnVtYmVyID1cbiAgICAgIGlzc3VlVGltZSA8IHN0YXJ0VGltZSA/IHN0YXJ0VGltZSAtIGlzc3VlVGltZSA6IC0xO1xuICAgIHJlc3VsdC5ibG9ja2VkID0gdGhpcy50b01pbGxpc2Vjb25kcyhxdWV1ZWRUaW1lKTtcblxuICAgIGxldCBoaWdoZXN0VGltZSA9IDA7XG5cbiAgICBpZiAodGltaW5nKSB7XG4gICAgICBjb25zdCBibG9ja2VkU3RhcnQgPSB0aGlzLmxlYXN0Tm9uTmVnYXRpdmUoW1xuICAgICAgICB0aW1pbmcuZG5zU3RhcnQsXG4gICAgICAgIHRpbWluZy5jb25uZWN0U3RhcnQsXG4gICAgICAgIHRpbWluZy5zZW5kU3RhcnRcbiAgICAgIF0pO1xuICAgICAgaWYgKGJsb2NrZWRTdGFydCAhPT0gSW5maW5pdHkpIHtcbiAgICAgICAgcmVzdWx0LmJsb2NrZWQgKz0gYmxvY2tlZFN0YXJ0O1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkbnNTdGFydDogYW55ID0gdGltaW5nLmRuc0VuZCA+PSAwID8gYmxvY2tlZFN0YXJ0IDogMDtcbiAgICAgIGNvbnN0IGRuc0VuZDogbnVtYmVyID0gdGltaW5nLmRuc0VuZCA+PSAwID8gdGltaW5nLmRuc0VuZCA6IC0xO1xuICAgICAgcmVzdWx0LmRucyA9IGRuc0VuZCAtIGRuc1N0YXJ0O1xuXG4gICAgICBjb25zdCBzc2xTdGFydDogbnVtYmVyID0gdGltaW5nLnNzbEVuZCA+IDAgPyB0aW1pbmcuc3NsU3RhcnQgOiAwO1xuICAgICAgY29uc3Qgc3NsRW5kOiBudW1iZXIgPSB0aW1pbmcuc3NsRW5kID4gMCA/IHRpbWluZy5zc2xFbmQgOiAtMTtcbiAgICAgIHJlc3VsdC5zc2wgPSBzc2xFbmQgLSBzc2xTdGFydDtcblxuICAgICAgY29uc3QgY29ubmVjdFN0YXJ0OiBudW1iZXIgPVxuICAgICAgICB0aW1pbmcuY29ubmVjdEVuZCA+PSAwXG4gICAgICAgICAgPyB0aGlzLmxlYXN0Tm9uTmVnYXRpdmUoW2Ruc0VuZCwgYmxvY2tlZFN0YXJ0XSlcbiAgICAgICAgICA6IDA7XG4gICAgICBjb25zdCBjb25uZWN0RW5kOiBudW1iZXIgPVxuICAgICAgICB0aW1pbmcuY29ubmVjdEVuZCA+PSAwID8gdGltaW5nLmNvbm5lY3RFbmQgOiAtMTtcbiAgICAgIHJlc3VsdC5jb25uZWN0ID0gY29ubmVjdEVuZCAtIGNvbm5lY3RTdGFydDtcblxuICAgICAgY29uc3Qgc2VuZFN0YXJ0OiBudW1iZXIgPVxuICAgICAgICB0aW1pbmcuc2VuZEVuZCA+PSAwID8gTWF0aC5tYXgoY29ubmVjdEVuZCwgZG5zRW5kLCBibG9ja2VkU3RhcnQpIDogMDtcbiAgICAgIGNvbnN0IHNlbmRFbmQ6IG51bWJlciA9IHRpbWluZy5zZW5kRW5kID49IDAgPyB0aW1pbmcuc2VuZEVuZCA6IDA7XG4gICAgICByZXN1bHQuc2VuZCA9IHNlbmRFbmQgLSBzZW5kU3RhcnQ7XG5cbiAgICAgIGlmIChyZXN1bHQuc2VuZCA8IDApIHtcbiAgICAgICAgcmVzdWx0LnNlbmQgPSAwO1xuICAgICAgfVxuXG4gICAgICBoaWdoZXN0VGltZSA9IE1hdGgubWF4KFxuICAgICAgICBzZW5kRW5kLFxuICAgICAgICBjb25uZWN0RW5kLFxuICAgICAgICBzc2xFbmQsXG4gICAgICAgIGRuc0VuZCxcbiAgICAgICAgYmxvY2tlZFN0YXJ0LFxuICAgICAgICAwXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy5yZXF1ZXN0LnJlc3BvbnNlUmVjZWl2ZWRUaW1lID09PSAtMSkge1xuICAgICAgcmVzdWx0LmJsb2NrZWQgPSB0aGlzLnJlcXVlc3QuZW5kVGltZSAtIGlzc3VlVGltZTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBjb25zdCByZXF1ZXN0VGltZTogbnVtYmVyID0gdGltaW5nPy5yZXF1ZXN0VGltZSA/PyBzdGFydFRpbWU7XG4gICAgY29uc3Qgd2FpdFN0YXJ0OiBudW1iZXIgPSBoaWdoZXN0VGltZTtcbiAgICBjb25zdCB3YWl0RW5kOiBudW1iZXIgPSB0aGlzLnRvTWlsbGlzZWNvbmRzKFxuICAgICAgdGhpcy5yZXF1ZXN0LnJlc3BvbnNlUmVjZWl2ZWRUaW1lIC0gcmVxdWVzdFRpbWVcbiAgICApO1xuICAgIHJlc3VsdC53YWl0ID0gd2FpdEVuZCAtIHdhaXRTdGFydDtcblxuICAgIGNvbnN0IHJlY2VpdmVTdGFydDogbnVtYmVyID0gd2FpdEVuZDtcbiAgICBjb25zdCByZWNlaXZlRW5kOiBudW1iZXIgPSB0aGlzLnRvTWlsbGlzZWNvbmRzKFxuICAgICAgdGhpcy5yZXF1ZXN0LmVuZFRpbWUgLSByZXF1ZXN0VGltZVxuICAgICk7XG4gICAgcmVzdWx0LnJlY2VpdmUgPSBNYXRoLm1heChyZWNlaXZlRW5kIC0gcmVjZWl2ZVN0YXJ0LCAwKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwcml2YXRlIGxlYXN0Tm9uTmVnYXRpdmUodmFsdWVzOiBudW1iZXJbXSk6IG51bWJlciB7XG4gICAgY29uc3QgdmFsdWU6IG51bWJlciB8IHVuZGVmaW5lZCA9IHZhbHVlcy5maW5kKFxuICAgICAgKGl0ZW06IG51bWJlcik6IGJvb2xlYW4gPT4gaXRlbSA+PSAwXG4gICAgKTtcblxuICAgIHJldHVybiB2YWx1ZSA/PyAtMTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYnVpbGRQb3N0RGF0YSgpOiBQcm9taXNlPFBvc3REYXRhIHwgdW5kZWZpbmVkPiB7XG4gICAgY29uc3QgcG9zdERhdGE6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGF3YWl0IHRoaXMucmVxdWVzdC5yZXF1ZXN0Rm9ybURhdGEoKTtcblxuICAgIGlmICghcG9zdERhdGEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByZXM6IFBhcnRpYWw8UG9zdERhdGE+ID0ge1xuICAgICAgbWltZVR5cGU6IHRoaXMucmVxdWVzdC5yZXF1ZXN0Q29udGVudFR5cGUgPz8gJycsXG4gICAgICB0ZXh0OiBwb3N0RGF0YVxuICAgIH07XG5cbiAgICBjb25zdCBmb3JtUGFyYW1ldGVyczogUGFyYW1bXSA9IGF3YWl0IHRoaXMucmVxdWVzdC5mb3JtUGFyYW1ldGVycygpO1xuXG4gICAgaWYgKGZvcm1QYXJhbWV0ZXJzKSB7XG4gICAgICByZXMucGFyYW1zID0gWy4uLmZvcm1QYXJhbWV0ZXJzXSBhcyBuZXZlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzIGFzIFBvc3REYXRhO1xuICB9XG5cbiAgcHJpdmF0ZSBidWlsZFJlcXVlc3RVUkwodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB1cmwuc3BsaXQoJyMnLCAyKVswXTtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRDb29raWVzKGNvb2tpZXM6IE5ldHdvcmtDb29raWVbXSk6IENvb2tpZVtdIHtcbiAgICByZXR1cm4gY29va2llcy5tYXAodGhpcy5idWlsZENvb2tpZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRDb29raWUoY29va2llOiBOZXR3b3JrQ29va2llKTogQ29va2llIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogY29va2llLm5hbWUsXG4gICAgICB2YWx1ZTogY29va2llLnZhbHVlLFxuICAgICAgcGF0aDogY29va2llLnBhdGgsXG4gICAgICBkb21haW46IGNvb2tpZS5kb21haW4sXG4gICAgICBleHBpcmVzOiBjb29raWVcbiAgICAgICAgLmV4cGlyZXNEYXRlKFxuICAgICAgICAgIG5ldyBEYXRlKHRoaXMucmVxdWVzdC5nZXRXYWxsVGltZSh0aGlzLnJlcXVlc3Quc3RhcnRUaW1lKSAqIDEwMDApXG4gICAgICAgIClcbiAgICAgICAgPy50b0pTT04oKSxcbiAgICAgIGh0dHBPbmx5OiBjb29raWUuaHR0cE9ubHksXG4gICAgICBzZWN1cmU6IGNvb2tpZS5zZWN1cmVcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZXF1ZXN0Qm9keVNpemUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBwb3N0RGF0YTogc3RyaW5nIHwgdW5kZWZpbmVkID0gYXdhaXQgdGhpcy5yZXF1ZXN0LnJlcXVlc3RGb3JtRGF0YSgpO1xuXG4gICAgaWYgKCFwb3N0RGF0YSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdC5jb250ZW50TGVuZ3RoO1xuICB9XG59XG4iXX0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ExtraInfoBuilder = void 0;\nclass ExtraInfoBuilder {\n    constructor(deleteCallback) {\n        this.deleteCallback = deleteCallback;\n        this._hasExtraInfo = false;\n        this._finished = false;\n        this._requests = [];\n        this._requestExtraInfo = [];\n        this._responseExtraInfo = [];\n    }\n    addRequest(request) {\n        this._requests.push(request);\n    }\n    addRequestExtraInfo(info) {\n        this._requestExtraInfo.push(info);\n        this._hasExtraInfo = true;\n        this.sync();\n    }\n    addResponseExtraInfo(info) {\n        this._responseExtraInfo.push(info);\n        this.sync();\n    }\n    finished() {\n        this._finished = true;\n        this.deleteIfComplete();\n    }\n    deleteIfComplete() {\n        if (!this._finished) {\n            return;\n        }\n        if (this._hasExtraInfo) {\n            const lastRequest = this.getLastRequest();\n            if (!(lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.hasExtraResponseInfo)) {\n                return;\n            }\n        }\n        this.deleteCallback();\n    }\n    getLastRequest() {\n        return this._requests[this._requests.length - 1];\n    }\n    getRequestIndex(req) {\n        return this._requests.indexOf(req);\n    }\n    sync() {\n        const req = this.getLastRequest();\n        if (!req) {\n            return;\n        }\n        const index = this.getRequestIndex(req);\n        const requestExtraInfo = this\n            ._requestExtraInfo[index];\n        if (requestExtraInfo) {\n            req.addExtraRequestInfo(requestExtraInfo);\n            delete this._requestExtraInfo[index];\n        }\n        const responseExtraInfo = this\n            ._responseExtraInfo[index];\n        if (responseExtraInfo) {\n            req.addExtraResponseInfo(responseExtraInfo);\n            delete this._responseExtraInfo[index];\n        }\n        this.deleteIfComplete();\n    }\n}\nexports.ExtraInfoBuilder = ExtraInfoBuilder;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXh0cmFJbmZvQnVpbGRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9uZXR3b3JrL0V4dHJhSW5mb0J1aWxkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBWUEsTUFBYSxnQkFBZ0I7SUFPM0IsWUFBNkIsY0FBMEI7UUFBMUIsbUJBQWMsR0FBZCxjQUFjLENBQVk7UUFOL0Msa0JBQWEsR0FBWSxLQUFLLENBQUM7UUFDL0IsY0FBUyxHQUFZLEtBQUssQ0FBQztRQUNsQixjQUFTLEdBQXFCLEVBQUUsQ0FBQztRQUNqQyxzQkFBaUIsR0FBdUIsRUFBRSxDQUFDO1FBQzNDLHVCQUFrQixHQUF3QixFQUFFLENBQUM7SUFFSixDQUFDO0lBRXBELFVBQVUsQ0FBQyxPQUF1QjtRQUN2QyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBRU0sbUJBQW1CLENBQUMsSUFBc0I7UUFDL0MsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztRQUMxQixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDZCxDQUFDO0lBRU0sb0JBQW9CLENBQUMsSUFBdUI7UUFDakQsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDZCxDQUFDO0lBRU0sUUFBUTtRQUNiLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFTyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbkIsT0FBTztTQUNSO1FBRUQsSUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ3RCLE1BQU0sV0FBVyxHQUErQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFFdEUsSUFBSSxDQUFDLENBQUEsV0FBVyxhQUFYLFdBQVcsdUJBQVgsV0FBVyxDQUFFLG9CQUFvQixDQUFBLEVBQUU7Z0JBQ3RDLE9BQU87YUFDUjtTQUNGO1FBRUQsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFTyxjQUFjO1FBQ3BCLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRU8sZUFBZSxDQUFDLEdBQW1CO1FBQ3pDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVPLElBQUk7UUFDVixNQUFNLEdBQUcsR0FBK0IsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRTlELElBQUksQ0FBQyxHQUFHLEVBQUU7WUFDUixPQUFPO1NBQ1I7UUFFRCxNQUFNLEtBQUssR0FBVyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRWhELE1BQU0sZ0JBQWdCLEdBQWlDLElBQUk7YUFDeEQsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFNUIsSUFBSSxnQkFBZ0IsRUFBRTtZQUNwQixHQUFHLENBQUMsbUJBQW1CLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUMxQyxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUN0QztRQUVELE1BQU0saUJBQWlCLEdBQWtDLElBQUk7YUFDMUQsa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0IsSUFBSSxpQkFBaUIsRUFBRTtZQUNyQixHQUFHLENBQUMsb0JBQW9CLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUM1QyxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUN2QztRQUVELElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzFCLENBQUM7Q0FDRjtBQS9FRCw0Q0ErRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXR3b3JrUmVxdWVzdCB9IGZyb20gJy4vTmV0d29ya1JlcXVlc3QnO1xuaW1wb3J0IHsgSGVhZGVyIH0gZnJvbSAnaGFyLWZvcm1hdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVxdWVzdEV4dHJhSW5mbyB7XG4gIHJlcXVlc3RIZWFkZXJzOiBIZWFkZXJbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNwb25zZUV4dHJhSW5mbyB7XG4gIHJlc3BvbnNlSGVhZGVyczogSGVhZGVyW107XG4gIHJlc3BvbnNlSGVhZGVyc1RleHQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBFeHRyYUluZm9CdWlsZGVyIHtcbiAgcHJpdmF0ZSBfaGFzRXh0cmFJbmZvOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX2ZpbmlzaGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3JlcXVlc3RzOiBOZXR3b3JrUmVxdWVzdFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgX3JlcXVlc3RFeHRyYUluZm86IFJlcXVlc3RFeHRyYUluZm9bXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IF9yZXNwb25zZUV4dHJhSW5mbzogUmVzcG9uc2VFeHRyYUluZm9bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgZGVsZXRlQ2FsbGJhY2s6ICgpID0+IHZvaWQpIHt9XG5cbiAgcHVibGljIGFkZFJlcXVlc3QocmVxdWVzdDogTmV0d29ya1JlcXVlc3QpOiB2b2lkIHtcbiAgICB0aGlzLl9yZXF1ZXN0cy5wdXNoKHJlcXVlc3QpO1xuICB9XG5cbiAgcHVibGljIGFkZFJlcXVlc3RFeHRyYUluZm8oaW5mbzogUmVxdWVzdEV4dHJhSW5mbyk6IHZvaWQge1xuICAgIHRoaXMuX3JlcXVlc3RFeHRyYUluZm8ucHVzaChpbmZvKTtcbiAgICB0aGlzLl9oYXNFeHRyYUluZm8gPSB0cnVlO1xuICAgIHRoaXMuc3luYygpO1xuICB9XG5cbiAgcHVibGljIGFkZFJlc3BvbnNlRXh0cmFJbmZvKGluZm86IFJlc3BvbnNlRXh0cmFJbmZvKTogdm9pZCB7XG4gICAgdGhpcy5fcmVzcG9uc2VFeHRyYUluZm8ucHVzaChpbmZvKTtcbiAgICB0aGlzLnN5bmMoKTtcbiAgfVxuXG4gIHB1YmxpYyBmaW5pc2hlZCgpOiB2b2lkIHtcbiAgICB0aGlzLl9maW5pc2hlZCA9IHRydWU7XG4gICAgdGhpcy5kZWxldGVJZkNvbXBsZXRlKCk7XG4gIH1cblxuICBwcml2YXRlIGRlbGV0ZUlmQ29tcGxldGUoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9maW5pc2hlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9oYXNFeHRyYUluZm8pIHtcbiAgICAgIGNvbnN0IGxhc3RSZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuZ2V0TGFzdFJlcXVlc3QoKTtcblxuICAgICAgaWYgKCFsYXN0UmVxdWVzdD8uaGFzRXh0cmFSZXNwb25zZUluZm8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZGVsZXRlQ2FsbGJhY2soKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TGFzdFJlcXVlc3QoKTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0c1t0aGlzLl9yZXF1ZXN0cy5sZW5ndGggLSAxXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UmVxdWVzdEluZGV4KHJlcTogTmV0d29ya1JlcXVlc3QpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0cy5pbmRleE9mKHJlcSk7XG4gIH1cblxuICBwcml2YXRlIHN5bmMoKTogdm9pZCB7XG4gICAgY29uc3QgcmVxOiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuZ2V0TGFzdFJlcXVlc3QoKTtcblxuICAgIGlmICghcmVxKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgaW5kZXg6IG51bWJlciA9IHRoaXMuZ2V0UmVxdWVzdEluZGV4KHJlcSk7XG5cbiAgICBjb25zdCByZXF1ZXN0RXh0cmFJbmZvOiBSZXF1ZXN0RXh0cmFJbmZvIHwgdW5kZWZpbmVkID0gdGhpc1xuICAgICAgLl9yZXF1ZXN0RXh0cmFJbmZvW2luZGV4XTtcblxuICAgIGlmIChyZXF1ZXN0RXh0cmFJbmZvKSB7XG4gICAgICByZXEuYWRkRXh0cmFSZXF1ZXN0SW5mbyhyZXF1ZXN0RXh0cmFJbmZvKTtcbiAgICAgIGRlbGV0ZSB0aGlzLl9yZXF1ZXN0RXh0cmFJbmZvW2luZGV4XTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZUV4dHJhSW5mbzogUmVzcG9uc2VFeHRyYUluZm8gfCB1bmRlZmluZWQgPSB0aGlzXG4gICAgICAuX3Jlc3BvbnNlRXh0cmFJbmZvW2luZGV4XTtcbiAgICBpZiAocmVzcG9uc2VFeHRyYUluZm8pIHtcbiAgICAgIHJlcS5hZGRFeHRyYVJlc3BvbnNlSW5mbyhyZXNwb25zZUV4dHJhSW5mbyk7XG4gICAgICBkZWxldGUgdGhpcy5fcmVzcG9uc2VFeHRyYUluZm9baW5kZXhdO1xuICAgIH1cblxuICAgIHRoaXMuZGVsZXRlSWZDb21wbGV0ZSgpO1xuICB9XG59XG4iXX0=","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HarBuilder = void 0;\nclass HarBuilder {\n    constructor(entries) {\n        this.entries = entries;\n    }\n    build() {\n        // eslint-disable-next-line @typescript-eslint/no-var-requires\n        const { name, version, homepage: comment } = require('../../package.json');\n        return {\n            log: {\n                version: '1.2',\n                pages: [],\n                creator: {\n                    name,\n                    version,\n                    comment\n                },\n                entries: this.entries\n            }\n        };\n    }\n}\nexports.HarBuilder = HarBuilder;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSGFyQnVpbGRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9uZXR3b3JrL0hhckJ1aWxkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBRUEsTUFBYSxVQUFVO0lBQ3JCLFlBQTZCLE9BQWdCO1FBQWhCLFlBQU8sR0FBUCxPQUFPLENBQVM7SUFBRyxDQUFDO0lBRTFDLEtBQUs7UUFDViw4REFBOEQ7UUFDOUQsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRTNFLE9BQU87WUFDTCxHQUFHLEVBQUU7Z0JBQ0gsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsT0FBTyxFQUFFO29CQUNQLElBQUk7b0JBQ0osT0FBTztvQkFDUCxPQUFPO2lCQUNSO2dCQUNELE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTzthQUN0QjtTQUNGLENBQUM7SUFDSixDQUFDO0NBQ0Y7QUFwQkQsZ0NBb0JDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW50cnksIEhhciB9IGZyb20gJ2hhci1mb3JtYXQnO1xuXG5leHBvcnQgY2xhc3MgSGFyQnVpbGRlciB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgZW50cmllczogRW50cnlbXSkge31cblxuICBwdWJsaWMgYnVpbGQoKTogSGFyIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXZhci1yZXF1aXJlc1xuICAgIGNvbnN0IHsgbmFtZSwgdmVyc2lvbiwgaG9tZXBhZ2U6IGNvbW1lbnQgfSA9IHJlcXVpcmUoJy4uLy4uL3BhY2thZ2UuanNvbicpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxvZzoge1xuICAgICAgICB2ZXJzaW9uOiAnMS4yJyxcbiAgICAgICAgcGFnZXM6IFtdLFxuICAgICAgICBjcmVhdG9yOiB7XG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgIGNvbW1lbnRcbiAgICAgICAgfSxcbiAgICAgICAgZW50cmllczogdGhpcy5lbnRyaWVzXG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuIl19","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkCookie = void 0;\nvar CookieAttribute;\n(function (CookieAttribute) {\n    CookieAttribute[\"NAME\"] = \"name\";\n    CookieAttribute[\"VALUE\"] = \"value\";\n    CookieAttribute[\"SIZE\"] = \"size\";\n    CookieAttribute[\"DOMAIN\"] = \"domain\";\n    CookieAttribute[\"PORT\"] = \"port\";\n    CookieAttribute[\"PATH\"] = \"path\";\n    CookieAttribute[\"EXPIRES\"] = \"expires\";\n    CookieAttribute[\"HTTPONLY\"] = \"httponly\";\n    CookieAttribute[\"SECURE\"] = \"secure\";\n    CookieAttribute[\"SAMESITE\"] = \"samesite\";\n    CookieAttribute[\"MAXAGE\"] = \"max-age\";\n})(CookieAttribute || (CookieAttribute = {}));\nclass NetworkCookie {\n    constructor(name, value) {\n        this._attributes = new Map();\n        this._size = 0;\n        this._name = name;\n        this._value = value;\n    }\n    get size() {\n        return this._size;\n    }\n    set size(size) {\n        this._size = size;\n    }\n    get name() {\n        return this._name;\n    }\n    get value() {\n        return this._value;\n    }\n    get httpOnly() {\n        return this._attributes.has(CookieAttribute.HTTPONLY);\n    }\n    get secure() {\n        return this._attributes.has(CookieAttribute.SECURE);\n    }\n    get sameSite() {\n        return this._attributes.get(CookieAttribute.SAMESITE);\n    }\n    get session() {\n        return !(this._attributes.has(CookieAttribute.EXPIRES) ||\n            this._attributes.has(CookieAttribute.MAXAGE));\n    }\n    get path() {\n        return this._attributes.get(CookieAttribute.PATH);\n    }\n    get port() {\n        return this._attributes.get(CookieAttribute.PORT);\n    }\n    get domain() {\n        return this._attributes.get(CookieAttribute.DOMAIN);\n    }\n    get expires() {\n        return this._attributes.get(CookieAttribute.EXPIRES);\n    }\n    get maxAge() {\n        var _a;\n        const maxAge = (_a = this._attributes.get(CookieAttribute.MAXAGE)) !== null && _a !== void 0 ? _a : '';\n        return isNaN(+maxAge) ? undefined : +maxAge;\n    }\n    get url() {\n        return (this.secure ? 'https://' : 'http://') + this.domain + this.path;\n    }\n    expiresDate(requestDate) {\n        if (this.maxAge) {\n            const targetDate = requestDate === null ? new Date() : requestDate;\n            return new Date(targetDate.getTime() + 1000 * this.maxAge);\n        }\n        if (this.expires) {\n            return new Date(this.expires);\n        }\n        return;\n    }\n    addAttribute(key, value) {\n        this._attributes.set(key.toLowerCase(), value);\n    }\n}\nexports.NetworkCookie = NetworkCookie;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTmV0d29ya0Nvb2tpZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9uZXR3b3JrL05ldHdvcmtDb29raWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsSUFBSyxlQVlKO0FBWkQsV0FBSyxlQUFlO0lBQ2xCLGdDQUFhLENBQUE7SUFDYixrQ0FBZSxDQUFBO0lBQ2YsZ0NBQWEsQ0FBQTtJQUNiLG9DQUFpQixDQUFBO0lBQ2pCLGdDQUFhLENBQUE7SUFDYixnQ0FBYSxDQUFBO0lBQ2Isc0NBQW1CLENBQUE7SUFDbkIsd0NBQXFCLENBQUE7SUFDckIsb0NBQWlCLENBQUE7SUFDakIsd0NBQXFCLENBQUE7SUFDckIscUNBQWtCLENBQUE7QUFDcEIsQ0FBQyxFQVpJLGVBQWUsS0FBZixlQUFlLFFBWW5CO0FBRUQsTUFBYSxhQUFhO0lBdUV4QixZQUFZLElBQVksRUFBRSxLQUFhO1FBcEUvQixnQkFBVyxHQUFpQyxJQUFJLEdBQUcsRUFHeEQsQ0FBQztRQUVJLFVBQUssR0FBVyxDQUFDLENBQUM7UUFnRXhCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO0lBQ3RCLENBQUM7SUFoRUQsSUFBSSxJQUFJO1FBQ04sT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFJLElBQUksQ0FBQyxJQUFZO1FBQ25CLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxJQUFJLElBQUk7UUFDTixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDcEIsQ0FBQztJQUVELElBQUksS0FBSztRQUNQLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUNyQixDQUFDO0lBRUQsSUFBSSxRQUFRO1FBQ1YsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVELElBQUksTUFBTTtRQUNSLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFFRCxJQUFJLFFBQVE7UUFDVixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQVEsQ0FBQztJQUMvRCxDQUFDO0lBRUQsSUFBSSxPQUFPO1FBQ1QsT0FBTyxDQUFDLENBQ04sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQztZQUM3QyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQzdDLENBQUM7SUFDSixDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ04sT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVELElBQUksSUFBSTtRQUNOLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRCxJQUFJLE1BQU07UUFDUixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBRUQsSUFBSSxPQUFPO1FBQ1QsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVELElBQUksTUFBTTs7UUFDUixNQUFNLE1BQU0sR0FBVyxNQUFBLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsbUNBQUksRUFBRSxDQUFDO1FBRTFFLE9BQU8sS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDOUMsQ0FBQztJQUVELElBQUksR0FBRztRQUNMLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztJQUMxRSxDQUFDO0lBT00sV0FBVyxDQUFDLFdBQWlCO1FBQ2xDLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNmLE1BQU0sVUFBVSxHQUFHLFdBQVcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQztZQUVuRSxPQUFPLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQzVEO1FBRUQsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2hCLE9BQU8sSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQy9CO1FBRUQsT0FBTztJQUNULENBQUM7SUFFTSxZQUFZLENBQUMsR0FBVyxFQUFFLEtBQWM7UUFDN0MsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBcUIsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNwRSxDQUFDO0NBQ0Y7QUE3RkQsc0NBNkZDIiwic291cmNlc0NvbnRlbnQiOlsiZW51bSBDb29raWVBdHRyaWJ1dGUge1xuICBOQU1FID0gJ25hbWUnLFxuICBWQUxVRSA9ICd2YWx1ZScsXG4gIFNJWkUgPSAnc2l6ZScsXG4gIERPTUFJTiA9ICdkb21haW4nLFxuICBQT1JUID0gJ3BvcnQnLFxuICBQQVRIID0gJ3BhdGgnLFxuICBFWFBJUkVTID0gJ2V4cGlyZXMnLFxuICBIVFRQT05MWSA9ICdodHRwb25seScsXG4gIFNFQ1VSRSA9ICdzZWN1cmUnLFxuICBTQU1FU0lURSA9ICdzYW1lc2l0ZScsXG4gIE1BWEFHRSA9ICdtYXgtYWdlJ1xufVxuXG5leHBvcnQgY2xhc3MgTmV0d29ya0Nvb2tpZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgX25hbWU6IHN0cmluZztcbiAgcHJpdmF0ZSByZWFkb25seSBfdmFsdWU6IHN0cmluZztcbiAgcHJpdmF0ZSBfYXR0cmlidXRlczogTWFwPENvb2tpZUF0dHJpYnV0ZSwgc3RyaW5nPiA9IG5ldyBNYXA8XG4gICAgQ29va2llQXR0cmlidXRlLFxuICAgIHN0cmluZ1xuICA+KCk7XG5cbiAgcHJpdmF0ZSBfc2l6ZTogbnVtYmVyID0gMDtcblxuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9zaXplO1xuICB9XG5cbiAgc2V0IHNpemUoc2l6ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5fc2l6ZSA9IHNpemU7XG4gIH1cblxuICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICB9XG5cbiAgZ2V0IHZhbHVlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICB9XG5cbiAgZ2V0IGh0dHBPbmx5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9hdHRyaWJ1dGVzLmhhcyhDb29raWVBdHRyaWJ1dGUuSFRUUE9OTFkpO1xuICB9XG5cbiAgZ2V0IHNlY3VyZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fYXR0cmlidXRlcy5oYXMoQ29va2llQXR0cmlidXRlLlNFQ1VSRSk7XG4gIH1cblxuICBnZXQgc2FtZVNpdGUoKTogJ1N0cmljdCcgfCAnTGF4JyB8ICdOb25lJyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXMuZ2V0KENvb2tpZUF0dHJpYnV0ZS5TQU1FU0lURSkgYXMgYW55O1xuICB9XG5cbiAgZ2V0IHNlc3Npb24oKTogYm9vbGVhbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuICEoXG4gICAgICB0aGlzLl9hdHRyaWJ1dGVzLmhhcyhDb29raWVBdHRyaWJ1dGUuRVhQSVJFUykgfHxcbiAgICAgIHRoaXMuX2F0dHJpYnV0ZXMuaGFzKENvb2tpZUF0dHJpYnV0ZS5NQVhBR0UpXG4gICAgKTtcbiAgfVxuXG4gIGdldCBwYXRoKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXMuZ2V0KENvb2tpZUF0dHJpYnV0ZS5QQVRIKTtcbiAgfVxuXG4gIGdldCBwb3J0KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXMuZ2V0KENvb2tpZUF0dHJpYnV0ZS5QT1JUKTtcbiAgfVxuXG4gIGdldCBkb21haW4oKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fYXR0cmlidXRlcy5nZXQoQ29va2llQXR0cmlidXRlLkRPTUFJTik7XG4gIH1cblxuICBnZXQgZXhwaXJlcygpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9hdHRyaWJ1dGVzLmdldChDb29raWVBdHRyaWJ1dGUuRVhQSVJFUyk7XG4gIH1cblxuICBnZXQgbWF4QWdlKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbWF4QWdlOiBzdHJpbmcgPSB0aGlzLl9hdHRyaWJ1dGVzLmdldChDb29raWVBdHRyaWJ1dGUuTUFYQUdFKSA/PyAnJztcblxuICAgIHJldHVybiBpc05hTigrbWF4QWdlKSA/IHVuZGVmaW5lZCA6ICttYXhBZ2U7XG4gIH1cblxuICBnZXQgdXJsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICh0aGlzLnNlY3VyZSA/ICdodHRwczovLycgOiAnaHR0cDovLycpICsgdGhpcy5kb21haW4gKyB0aGlzLnBhdGg7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgcHVibGljIGV4cGlyZXNEYXRlKHJlcXVlc3REYXRlOiBEYXRlKTogRGF0ZSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHRoaXMubWF4QWdlKSB7XG4gICAgICBjb25zdCB0YXJnZXREYXRlID0gcmVxdWVzdERhdGUgPT09IG51bGwgPyBuZXcgRGF0ZSgpIDogcmVxdWVzdERhdGU7XG5cbiAgICAgIHJldHVybiBuZXcgRGF0ZSh0YXJnZXREYXRlLmdldFRpbWUoKSArIDEwMDAgKiB0aGlzLm1heEFnZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZXhwaXJlcykge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMuZXhwaXJlcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHVibGljIGFkZEF0dHJpYnV0ZShrZXk6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLl9hdHRyaWJ1dGVzLnNldChrZXkudG9Mb3dlckNhc2UoKSBhcyBDb29raWVBdHRyaWJ1dGUsIHZhbHVlKTtcbiAgfVxufVxuIl19","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkObserver = void 0;\nconst tslib_1 = require(\"tslib\");\nconst NetworkRequest_1 = require(\"./NetworkRequest\");\nconst ExtraInfoBuilder_1 = require(\"./ExtraInfoBuilder\");\nclass NetworkObserver {\n    constructor(options, connection, logger) {\n        this.options = options;\n        this.connection = connection;\n        this.logger = logger;\n        this._entries = new Map();\n        this._extraInfoBuilders = new Map();\n        const { network: network, security: security } = this.connection;\n        this.network = network;\n        this.security = security;\n    }\n    subscribe(callback) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            this.destination = (entry) => callback(entry);\n            yield this.connection.subscribe((event) => this.handleEvent(event));\n            this.security.certificateError(({ eventId }) => this.security.handleCertificateError({\n                eventId,\n                action: 'continue'\n            }));\n            yield Promise.all([\n                this.security.setOverrideCertificateErrors({ override: true }),\n                this.network.setCacheDisabled({ cacheDisabled: true }),\n                this.network.setBypassServiceWorker({ bypass: true })\n            ]);\n        });\n    }\n    signedExchangeReceived(params) {\n        const entry = this._entries.get(params.requestId);\n        if (!entry) {\n            return;\n        }\n        entry.signedExchangeInfo = params.info;\n        entry.resourceType = 'SignedExchange';\n        this.updateNetworkRequestWithResponse(entry, params.info.outerResponse);\n    }\n    requestWillBeSent({ type, loaderId, initiator, redirectResponse, documentURL, frameId, timestamp, requestId, request, wallTime }) {\n        let entry = this._entries.get(requestId);\n        if (entry) {\n            if (!redirectResponse) {\n                return;\n            }\n            if (!entry.signedExchangeInfo) {\n                this.responseReceived({\n                    requestId,\n                    loaderId,\n                    timestamp,\n                    type: 'Other',\n                    response: redirectResponse,\n                    frameId\n                });\n            }\n            entry = this._appendRedirect(requestId, timestamp, request.url);\n        }\n        else {\n            entry = this.createRequest(requestId, frameId, loaderId, request.url, documentURL, initiator);\n        }\n        this.updateNetworkRequestWithRequest(entry, request);\n        entry.setIssueTime(timestamp, wallTime);\n        entry.resourceType = type !== null && type !== void 0 ? type : 'Other';\n        this.getExtraInfoBuilder(requestId).addRequest(entry);\n        this.startRequest(entry);\n    }\n    dataReceived({ requestId, dataLength, encodedDataLength, timestamp }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.resourceSize += dataLength;\n        if (encodedDataLength !== -1) {\n            entry.increaseTransferSize(encodedDataLength);\n        }\n        entry.endTime = timestamp;\n    }\n    responseReceived({ requestId, response, timestamp, type }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.responseReceivedTime = timestamp;\n        entry.resourceType = type;\n        this.updateNetworkRequestWithResponse(entry, response);\n    }\n    resourceChangedPriority({ requestId, newPriority }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.priority = newPriority;\n    }\n    loadingFinished({ requestId, timestamp, encodedDataLength }) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            const entry = this._entries.get(requestId);\n            if (!entry) {\n                return;\n            }\n            this.finishRequest(entry, timestamp, encodedDataLength);\n        });\n    }\n    loadingFailed({ requestId, errorText, canceled, type, timestamp }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.resourceType = type;\n        this.finishRequest(entry, timestamp, -1);\n        const message = errorText || (canceled && 'Canceled');\n        this.logger.debug(`Failed request: ${requestId}. Reason: ${message}`);\n    }\n    webSocketCreated({ initiator, requestId, url }) {\n        const entry = this.createRequest(requestId, '', '', url, '', initiator);\n        this.startRequest(entry);\n    }\n    webSocketWillSendHandshakeRequest({ request, requestId, timestamp, wallTime }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.requestMethod = 'GET';\n        entry.requestHeaders = this.headersMapToHeadersArray(request.headers);\n        entry.setIssueTime(timestamp, wallTime);\n    }\n    webSocketHandshakeResponseReceived({ timestamp, response, requestId }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.statusCode = response.status;\n        entry.statusText = response.statusText;\n        entry.responseHeaders = this.headersMapToHeadersArray(response.headers);\n        entry.responseHeadersText = response.headersText || '';\n        if (response.requestHeaders) {\n            entry.requestHeaders = this.headersMapToHeadersArray(response.requestHeaders);\n        }\n        if (response.requestHeadersText) {\n            entry.requestHeadersText = response.requestHeadersText;\n        }\n        entry.responseReceivedTime = timestamp;\n        entry.protocol = 'websocket';\n    }\n    webSocketFrameSent({ requestId, timestamp, response }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.addProtocolFrame(response, timestamp, true);\n        entry.responseReceivedTime = timestamp;\n    }\n    webSocketFrameReceived({ requestId, timestamp, response }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.addProtocolFrame(response, timestamp, false);\n        entry.responseReceivedTime = timestamp;\n    }\n    webSocketFrameError({ errorMessage, requestId, timestamp }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        entry.addProtocolFrameError(errorMessage, timestamp);\n        entry.responseReceivedTime = timestamp;\n    }\n    webSocketClosed({ requestId, timestamp }) {\n        const entry = this._entries.get(requestId);\n        if (!entry) {\n            return;\n        }\n        this.finishRequest(entry, timestamp, -1);\n    }\n    requestWillBeSentExtraInfo({ requestId, headers }) {\n        this.getExtraInfoBuilder(requestId).addRequestExtraInfo({\n            requestHeaders: this.headersMapToHeadersArray(headers)\n        });\n    }\n    responseReceivedExtraInfo({ requestId, headers, headersText }) {\n        this.getExtraInfoBuilder(requestId).addResponseExtraInfo({\n            responseHeaders: this.headersMapToHeadersArray(headers),\n            responseHeadersText: headersText\n        });\n    }\n    getExtraInfoBuilder(requestId) {\n        if (!this._extraInfoBuilders.has(requestId)) {\n            this._extraInfoBuilders.set(requestId, new ExtraInfoBuilder_1.ExtraInfoBuilder(() => {\n                this._extraInfoBuilders.delete(requestId);\n            }));\n        }\n        return this._extraInfoBuilders.get(requestId);\n    }\n    _appendRedirect(requestId, time, redirectURL) {\n        const originalNetworkRequest = this._entries.get(requestId);\n        let redirectCount = 0;\n        let redirect = originalNetworkRequest.redirectSource;\n        while (redirect) {\n            redirectCount++;\n            redirect = redirect.redirectSource;\n        }\n        originalNetworkRequest.markAsRedirect(redirectCount);\n        this.finishRequest(originalNetworkRequest, time, -1);\n        const newNetworkRequest = this.createRequest(requestId, originalNetworkRequest.frameId, originalNetworkRequest.loaderId, redirectURL, originalNetworkRequest.documentURL, originalNetworkRequest.initiator);\n        newNetworkRequest.redirectSource = originalNetworkRequest;\n        return newNetworkRequest;\n    }\n    finishRequest(networkRequest, finishTime, encodedDataLength) {\n        networkRequest.endTime = finishTime;\n        if (encodedDataLength >= 0) {\n            const redirectSource = networkRequest.redirectSource;\n            if (redirectSource === null || redirectSource === void 0 ? void 0 : redirectSource.signedExchangeInfo) {\n                networkRequest.transferSize = 0;\n                redirectSource.transferSize = encodedDataLength;\n            }\n            else {\n                networkRequest.transferSize = encodedDataLength;\n            }\n        }\n        if (this.options.content) {\n            networkRequest.setContentData(this.network.getResponseBody({\n                requestId: networkRequest.requestId\n            }));\n        }\n        this._entries.delete(networkRequest.requestId);\n        this.getExtraInfoBuilder(networkRequest.requestId).finished();\n        if (!this.excludeRequest(networkRequest)) {\n            this.destination(networkRequest);\n        }\n    }\n    startRequest(networkRequest) {\n        this._entries.set(networkRequest.requestId, networkRequest);\n    }\n    updateNetworkRequestWithRequest(chromeRequest, request) {\n        chromeRequest.requestMethod = request.method;\n        chromeRequest.requestHeaders = this.headersMapToHeadersArray(request.headers);\n        chromeRequest.setRequestFormData(this.getRequestPostData(chromeRequest.requestId, request));\n        chromeRequest.initialPriority = request.initialPriority;\n    }\n    getRequestPostData(requestId, request) {\n        return request.hasPostData && !!request.postData\n            ? request.postData\n            : this.network\n                .getRequestPostData({ requestId })\n                .then(({ postData }) => postData)\n                .catch(() => undefined);\n    }\n    createRequest(requestId, frameId, loaderId, url, documentURL, initiator) {\n        return new NetworkRequest_1.NetworkRequest(requestId, url, documentURL, frameId, loaderId, initiator);\n    }\n    // eslint-disable-next-line complexity\n    updateNetworkRequestWithResponse(networkRequest, response) {\n        var _a, _b;\n        if (response.url && networkRequest.url !== response.url) {\n            networkRequest.setUrl(response.url);\n        }\n        networkRequest.mimeType = response.mimeType;\n        networkRequest.statusCode = response.status;\n        networkRequest.statusText = response.statusText;\n        if (!networkRequest.hasExtraResponseInfo) {\n            networkRequest.responseHeaders = this.headersMapToHeadersArray(response.headers);\n        }\n        if (response.encodedDataLength >= 0) {\n            networkRequest.transferSize = response.encodedDataLength;\n        }\n        if (response.requestHeaders && !networkRequest.hasExtraRequestInfo) {\n            networkRequest.requestHeaders = this.headersMapToHeadersArray(response.requestHeaders);\n            networkRequest.requestHeadersText = (_a = response.requestHeadersText) !== null && _a !== void 0 ? _a : '';\n        }\n        networkRequest.connectionReused = response.connectionReused;\n        networkRequest.connectionId = String(response.connectionId);\n        if (response.remoteIPAddress) {\n            networkRequest.setRemoteAddress(response.remoteIPAddress, response.remotePort || -1);\n        }\n        networkRequest.timing = response.timing;\n        networkRequest.protocol = (_b = response.protocol) !== null && _b !== void 0 ? _b : '';\n    }\n    headersMapToHeadersArray(headersMap) {\n        return Object.keys(headersMap).reduce((acc, name) => {\n            const values = headersMap[name].split('\\n');\n            acc.push(...values.map((value) => ({ name, value })));\n            return acc;\n        }, []);\n    }\n    excludeRequest(request) {\n        var _a;\n        const { path = '/' } = request.parsedURL;\n        return !!((_a = this.options.excludePaths) === null || _a === void 0 ? void 0 : _a.some((excludedPath) => new RegExp(excludedPath).test(path)));\n    }\n    handleEvent({ method, params }) {\n        const methodName = method.substring(method.indexOf('.') + 1);\n        const handler = this[methodName];\n        if (handler) {\n            handler.call(this, params);\n        }\n    }\n}\nexports.NetworkObserver = NetworkObserver;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTmV0d29ya09ic2VydmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL25ldHdvcmsvTmV0d29ya09ic2VydmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxxREFBa0Q7QUFFbEQseURBQXNEO0FBTXRELE1BQWEsZUFBZTtJQVUxQixZQUNtQixPQUFzQixFQUN0QixVQUF5QixFQUN6QixNQUFjO1FBRmQsWUFBTyxHQUFQLE9BQU8sQ0FBZTtRQUN0QixlQUFVLEdBQVYsVUFBVSxDQUFlO1FBQ3pCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFFL0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLEdBQUcsRUFBOEMsQ0FBQztRQUN0RSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxHQUFHLEVBRzlCLENBQUM7UUFDSixNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUNqRSxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztJQUMzQixDQUFDO0lBRVksU0FBUyxDQUNwQixRQUErQzs7WUFFL0MsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLEtBQXFCLEVBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVwRSxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsS0FBaUMsRUFBUSxFQUFFLENBQzFFLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQ3hCLENBQUM7WUFFRixJQUFJLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUM1QixDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQWlCLEVBQUUsQ0FDN0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQztnQkFDbkMsT0FBTztnQkFDUCxNQUFNLEVBQUUsVUFB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Q3pFLElBQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FDcEMsQ0FBQSxDQUFDO0lBQ0osQ0FBQztJQUVPLFdBQVcsQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQThCO1FBQ2hFLE1BQU0sVUFBVSxHQUFXLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUVyRSxNQUFNLE9BQU8sR0FBZ0QsSUFBSSxDQUMvRCxVQUFVLENBQ1gsQ0FBQztRQUVGLElBQUksT0FBTyxFQUFFO1lBQ1gsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDNUI7SUFDSCxDQUFDO0NBQ0Y7QUF6aUJELDBDQXlpQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBOZXR3b3JrUmVxdWVzdCB9IGZyb20gJy4vTmV0d29ya1JlcXVlc3QnO1xuaW1wb3J0IHsgQ2hyb21lUmVtb3RlSW50ZXJmYWNlRXZlbnQsIENSSUNvbm5lY3Rpb24gfSBmcm9tICcuLi9jZHAnO1xuaW1wb3J0IHsgRXh0cmFJbmZvQnVpbGRlciB9IGZyb20gJy4vRXh0cmFJbmZvQnVpbGRlcic7XG5pbXBvcnQgeyBSZWNvcmRPcHRpb25zIH0gZnJvbSAnLi4vUGx1Z2luJztcbmltcG9ydCB7IEhlYWRlciB9IGZyb20gJ2hhci1mb3JtYXQnO1xuaW1wb3J0IHsgTmV0d29yaywgU2VjdXJpdHkgfSBmcm9tICdjaHJvbWUtcmVtb3RlLWludGVyZmFjZSc7XG5pbXBvcnQgUHJvdG9jb2wgZnJvbSAnZGV2dG9vbHMtcHJvdG9jb2wnO1xuXG5leHBvcnQgY2xhc3MgTmV0d29ya09ic2VydmVyIHtcbiAgcHJpdmF0ZSByZWFkb25seSBfZW50cmllczogTWFwPFByb3RvY29sLk5ldHdvcmsuUmVxdWVzdElkLCBOZXR3b3JrUmVxdWVzdD47XG4gIHByaXZhdGUgcmVhZG9ubHkgX2V4dHJhSW5mb0J1aWxkZXJzOiBNYXA8XG4gICAgUHJvdG9jb2wuTmV0d29yay5SZXF1ZXN0SWQsXG4gICAgRXh0cmFJbmZvQnVpbGRlclxuICA+O1xuICBwcml2YXRlIHJlYWRvbmx5IG5ldHdvcms6IE5ldHdvcms7XG4gIHByaXZhdGUgZGVzdGluYXRpb246IChjaHJvbWVFbnRyeTogTmV0d29ya1JlcXVlc3QpID0+IHZvaWQ7XG4gIHByaXZhdGUgcmVhZG9ubHkgc2VjdXJpdHk6IFNlY3VyaXR5O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgb3B0aW9uczogUmVjb3JkT3B0aW9ucyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGNvbm5lY3Rpb246IENSSUNvbm5lY3Rpb24sXG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dnZXI6IExvZ2dlclxuICApIHtcbiAgICB0aGlzLl9lbnRyaWVzID0gbmV3IE1hcDxQcm90b2NvbC5OZXR3b3JrLlJlcXVlc3RJZCwgTmV0d29ya1JlcXVlc3Q+KCk7XG4gICAgdGhpcy5fZXh0cmFJbmZvQnVpbGRlcnMgPSBuZXcgTWFwPFxuICAgICAgUHJvdG9jb2wuTmV0d29yay5SZXF1ZXN0SWQsXG4gICAgICBFeHRyYUluZm9CdWlsZGVyXG4gICAgPigpO1xuICAgIGNvbnN0IHsgbmV0d29yazogbmV0d29yaywgc2VjdXJpdHk6IHNlY3VyaXR5IH0gPSB0aGlzLmNvbm5lY3Rpb247XG4gICAgdGhpcy5uZXR3b3JrID0gbmV0d29yaztcbiAgICB0aGlzLnNlY3VyaXR5ID0gc2VjdXJpdHk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc3Vic2NyaWJlKFxuICAgIGNhbGxiYWNrOiAoY2hyb21lRW50cnk6IE5ldHdvcmtSZXF1ZXN0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuZGVzdGluYXRpb24gPSAoZW50cnk6IE5ldHdvcmtSZXF1ZXN0KTogdm9pZCA9PiBjYWxsYmFjayhlbnRyeSk7XG5cbiAgICBhd2FpdCB0aGlzLmNvbm5lY3Rpb24uc3Vic2NyaWJlKChldmVudDogQ2hyb21lUmVtb3RlSW50ZXJmYWNlRXZlbnQpOiB2b2lkID0+XG4gICAgICB0aGlzLmhhbmRsZUV2ZW50KGV2ZW50KVxuICAgICk7XG5cbiAgICB0aGlzLnNlY3VyaXR5LmNlcnRpZmljYXRlRXJyb3IoXG4gICAgICAoeyBldmVudElkIH0pOiBQcm9taXNlPHZvaWQ+ID0+XG4gICAgICAgIHRoaXMuc2VjdXJpdHkuaGFuZGxlQ2VydGlmaWNhdGVFcnJvcih7XG4gICAgICAgICAgZXZlbnRJZCxcbiAgICAgICAgICBhY3Rpb246ICdjb250aW51ZSdcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5zZWN1cml0eS5zZXRPdmVycmlkZUNlcnRpZmljYXRlRXJyb3JzKHsgb3ZlcnJpZGU6IHRydWUgfSksXG4gICAgICB0aGlzLm5ldHdvcmsuc2V0Q2FjaGVEaXNhYmxlZCh7IGNhY2hlRGlzYWJsZWQ6IHRydWUgfSksXG4gICAgICB0aGlzLm5ldHdvcmsuc2V0QnlwYXNzU2VydmljZVdvcmtlcih7IGJ5cGFzczogdHJ1ZSB9KVxuICAgIF0pO1xuICB9XG5cbiAgcHVibGljIHNpZ25lZEV4Y2hhbmdlUmVjZWl2ZWQoXG4gICAgcGFyYW1zOiBQcm90b2NvbC5OZXR3b3JrLlNpZ25lZEV4Y2hhbmdlUmVjZWl2ZWRFdmVudFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBlbnRyeTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQgPSB0aGlzLl9lbnRyaWVzLmdldChcbiAgICAgIHBhcmFtcy5yZXF1ZXN0SWRcbiAgICApO1xuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbnRyeS5zaWduZWRFeGNoYW5nZUluZm8gPSBwYXJhbXMuaW5mbztcbiAgICBlbnRyeS5yZXNvdXJjZVR5cGUgPSAnU2lnbmVkRXhjaGFuZ2UnO1xuXG4gICAgdGhpcy51cGRhdGVOZXR3b3JrUmVxdWVzdFdpdGhSZXNwb25zZShlbnRyeSwgcGFyYW1zLmluZm8ub3V0ZXJSZXNwb25zZSk7XG4gIH1cblxuICBwdWJsaWMgcmVxdWVzdFdpbGxCZVNlbnQoe1xuICAgIHR5cGUsXG4gICAgbG9hZGVySWQsXG4gICAgaW5pdGlhdG9yLFxuICAgIHJlZGlyZWN0UmVzcG9uc2UsXG4gICAgZG9jdW1lbnRVUkwsXG4gICAgZnJhbWVJZCxcbiAgICB0aW1lc3RhbXAsXG4gICAgcmVxdWVzdElkLFxuICAgIHJlcXVlc3QsXG4gICAgd2FsbFRpbWVcbiAgfTogUHJvdG9jb2wuTmV0d29yay5SZXF1ZXN0V2lsbEJlU2VudEV2ZW50KTogdm9pZCB7XG4gICAgbGV0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuX2VudHJpZXMuZ2V0KHJlcXVlc3RJZCk7XG5cbiAgICBpZiAoZW50cnkpIHtcbiAgICAgIGlmICghcmVkaXJlY3RSZXNwb25zZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghZW50cnkuc2lnbmVkRXhjaGFuZ2VJbmZvKSB7XG4gICAgICAgIHRoaXMucmVzcG9uc2VSZWNlaXZlZCh7XG4gICAgICAgICAgcmVxdWVzdElkLFxuICAgICAgICAgIGxvYWRlcklkLFxuICAgICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgICB0eXBlOiAnT3RoZXInLFxuICAgICAgICAgIHJlc3BvbnNlOiByZWRpcmVjdFJlc3BvbnNlLFxuICAgICAgICAgIGZyYW1lSWRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbnRyeSA9IHRoaXMuX2FwcGVuZFJlZGlyZWN0KHJlcXVlc3RJZCwgdGltZXN0YW1wLCByZXF1ZXN0LnVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVudHJ5ID0gdGhpcy5jcmVhdGVSZXF1ZXN0KFxuICAgICAgICByZXF1ZXN0SWQsXG4gICAgICAgIGZyYW1lSWQsXG4gICAgICAgIGxvYWRlcklkLFxuICAgICAgICByZXF1ZXN0LnVybCxcbiAgICAgICAgZG9jdW1lbnRVUkwsXG4gICAgICAgIGluaXRpYXRvclxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZU5ldHdvcmtSZXF1ZXN0V2l0aFJlcXVlc3QoZW50cnksIHJlcXVlc3QpO1xuXG4gICAgZW50cnkuc2V0SXNzdWVUaW1lKHRpbWVzdGFtcCwgd2FsbFRpbWUpO1xuICAgIGVudHJ5LnJlc291cmNlVHlwZSA9IHR5cGUgPz8gJ090aGVyJztcblxuICAgIHRoaXMuZ2V0RXh0cmFJbmZvQnVpbGRlcihyZXF1ZXN0SWQpLmFkZFJlcXVlc3QoZW50cnkpO1xuXG4gICAgdGhpcy5zdGFydFJlcXVlc3QoZW50cnkpO1xuICB9XG5cbiAgcHVibGljIGRhdGFSZWNlaXZlZCh7XG4gICAgcmVxdWVzdElkLFxuICAgIGRhdGFMZW5ndGgsXG4gICAgZW5jb2RlZERhdGFMZW5ndGgsXG4gICAgdGltZXN0YW1wXG4gIH06IFByb3RvY29sLk5ldHdvcmsuRGF0YVJlY2VpdmVkRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBlbnRyeTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQgPSB0aGlzLl9lbnRyaWVzLmdldChyZXF1ZXN0SWQpO1xuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZW50cnkucmVzb3VyY2VTaXplICs9IGRhdGFMZW5ndGg7XG4gICAgaWYgKGVuY29kZWREYXRhTGVuZ3RoICE9PSAtMSkge1xuICAgICAgZW50cnkuaW5jcmVhc2VUcmFuc2ZlclNpemUoZW5jb2RlZERhdGFMZW5ndGgpO1xuICAgIH1cbiAgICBlbnRyeS5lbmRUaW1lID0gdGltZXN0YW1wO1xuICB9XG5cbiAgcHVibGljIHJlc3BvbnNlUmVjZWl2ZWQoe1xuICAgIHJlcXVlc3RJZCxcbiAgICByZXNwb25zZSxcbiAgICB0aW1lc3RhbXAsXG4gICAgdHlwZVxuICB9OiBQcm90b2NvbC5OZXR3b3JrLlJlc3BvbnNlUmVjZWl2ZWRFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuX2VudHJpZXMuZ2V0KHJlcXVlc3RJZCk7XG5cbiAgICBpZiAoIWVudHJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZW50cnkucmVzcG9uc2VSZWNlaXZlZFRpbWUgPSB0aW1lc3RhbXA7XG4gICAgZW50cnkucmVzb3VyY2VUeXBlID0gdHlwZTtcblxuICAgIHRoaXMudXBkYXRlTmV0d29ya1JlcXVlc3RXaXRoUmVzcG9uc2UoZW50cnksIHJlc3BvbnNlKTtcbiAgfVxuXG4gIHB1YmxpYyByZXNvdXJjZUNoYW5nZWRQcmlvcml0eSh7XG4gICAgcmVxdWVzdElkLFxuICAgIG5ld1ByaW9yaXR5XG4gIH06IFByb3RvY29sLk5ldHdvcmsuUmVzb3VyY2VDaGFuZ2VkUHJpb3JpdHlFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuX2VudHJpZXMuZ2V0KHJlcXVlc3RJZCk7XG5cbiAgICBpZiAoIWVudHJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZW50cnkucHJpb3JpdHkgPSBuZXdQcmlvcml0eTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBsb2FkaW5nRmluaXNoZWQoe1xuICAgIHJlcXVlc3RJZCxcbiAgICB0aW1lc3RhbXAsXG4gICAgZW5jb2RlZERhdGFMZW5ndGhcbiAgfTogUHJvdG9jb2wuTmV0d29yay5Mb2FkaW5nRmluaXNoZWRFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuX2VudHJpZXMuZ2V0KHJlcXVlc3RJZCk7XG5cbiAgICBpZiAoIWVudHJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5maW5pc2hSZXF1ZXN0KGVudHJ5LCB0aW1lc3RhbXAsIGVuY29kZWREYXRhTGVuZ3RoKTtcbiAgfVxuXG4gIHB1YmxpYyBsb2FkaW5nRmFpbGVkKHtcbiAgICByZXF1ZXN0SWQsXG4gICAgZXJyb3JUZXh0LFxuICAgIGNhbmNlbGVkLFxuICAgIHR5cGUsXG4gICAgdGltZXN0YW1wXG4gIH06IFByb3RvY29sLk5ldHdvcmsuTG9hZGluZ0ZhaWxlZEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgZW50cnk6IE5ldHdvcmtSZXF1ZXN0IHwgdW5kZWZpbmVkID0gdGhpcy5fZW50cmllcy5nZXQocmVxdWVzdElkKTtcbiAgICBpZiAoIWVudHJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZW50cnkucmVzb3VyY2VUeXBlID0gdHlwZTtcblxuICAgIHRoaXMuZmluaXNoUmVxdWVzdChlbnRyeSwgdGltZXN0YW1wLCAtMSk7XG5cbiAgICBjb25zdCBtZXNzYWdlOiBzdHJpbmcgPSBlcnJvclRleHQgfHwgKGNhbmNlbGVkICYmICdDYW5jZWxlZCcpO1xuICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBGYWlsZWQgcmVxdWVzdDogJHtyZXF1ZXN0SWR9LiBSZWFzb246ICR7bWVzc2FnZX1gKTtcbiAgfVxuXG4gIHB1YmxpYyB3ZWJTb2NrZXRDcmVhdGVkKHtcbiAgICBpbml0aWF0b3IsXG4gICAgcmVxdWVzdElkLFxuICAgIHVybFxuICB9OiBQcm90b2NvbC5OZXR3b3JrLldlYlNvY2tldENyZWF0ZWRFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCA9IHRoaXMuY3JlYXRlUmVxdWVzdChcbiAgICAgIHJlcXVlc3RJZCxcbiAgICAgICcnLFxuICAgICAgJycsXG4gICAgICB1cmwsXG4gICAgICAnJyxcbiAgICAgIGluaXRpYXRvclxuICAgICk7XG4gICAgdGhpcy5zdGFydFJlcXVlc3QoZW50cnkpO1xuICB9XG5cbiAgcHVibGljIHdlYlNvY2tldFdpbGxTZW5kSGFuZHNoYWtlUmVxdWVzdCh7XG4gICAgcmVxdWVzdCxcbiAgICByZXF1ZXN0SWQsXG4gICAgdGltZXN0YW1wLFxuICAgIHdhbGxUaW1lXG4gIH06IFByb3RvY29sLk5ldHdvcmsuV2ViU29ja2V0V2lsbFNlbmRIYW5kc2hha2VSZXF1ZXN0RXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBlbnRyeTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQgPSB0aGlzLl9lbnRyaWVzLmdldChyZXF1ZXN0SWQpO1xuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZW50cnkucmVxdWVzdE1ldGhvZCA9ICdHRVQnO1xuICAgIGVudHJ5LnJlcXVlc3RIZWFkZXJzID0gdGhpcy5oZWFkZXJzTWFwVG9IZWFkZXJzQXJyYXkocmVxdWVzdC5oZWFkZXJzKTtcbiAgICBlbnRyeS5zZXRJc3N1ZVRpbWUodGltZXN0YW1wLCB3YWxsVGltZSk7XG4gIH1cblxuICBwdWJsaWMgd2ViU29ja2V0SGFuZHNoYWtlUmVzcG9uc2VSZWNlaXZlZCh7XG4gICAgdGltZXN0YW1wLFxuICAgIHJlc3BvbnNlLFxuICAgIHJlcXVlc3RJZFxuICB9OiBQcm90b2NvbC5OZXR3b3JrLldlYlNvY2tldEhhbmRzaGFrZVJlc3BvbnNlUmVjZWl2ZWRFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGVudHJ5OiBOZXR3b3JrUmVxdWVzdCB8IHVuZGVmaW5lZCA9IHRoaXMuX2VudHJpZXMuZ2V0KHJlcXVlc3RJZCk7XG5cbiAgICBpZiAoIWVudHJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZW50cnkuc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1cztcbiAgICBlbnRyeS5zdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdHVzVGV4dDtcbiAgICBlbnRyeS5yZXNwb25zZUhlYWRlcnMgPSB0aGlzLmhlYWRlcnNNYXBUb0hlYWRlcnNBcnJheShyZXNwb25zZS5oZWFkZXJzKTtcbiAgICBlbnRyeS5yZXNwb25zZUhlYWRlcnNUZXh0ID0gcmVzcG9uc2UuaGVhZGVyc1RleHQgfHwgJyc7XG5cbiAgICBpZiAocmVzcG9uc2UucmVxdWVzdEhlYWRlcnMpIHtcbiAgICAgIGVudHJ5LnJlcXVlc3RIZWFkZXJzID0gdGhpcy5oZWFkZXJzTWFwVG9IZWFkZXJzQXJyYXkoXG4gICAgICAgIHJlc3BvbnNlLnJlcXVlc3RIZWFkZXJzXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChyZXNwb25zZS5yZXF1ZXN0SGVhZGVyc1RleHQpIHtcbiAgICAgIGVudHJ5LnJlcXVlc3RIZWFkZXJzVGV4dCA9IHJlc3BvbnNlLnJlcXVlc3RIZWFkZXJzVGV4dDtcbiAgICB9XG5cbiAgICBlbnRyeS5yZXNwb25zZVJlY2VpdmVkVGltZSA9IHRpbWVzdGFtcDtcbiAgICBlbnRyeS5wcm90b2NvbCA9ICd3ZWJzb2NrZXQnO1xuICB9XG5cbiAgcHVibGljIHdlYlNvY2tldEZyYW1lU2VudCh7XG4gICAgcmVxdWVzdElkLFxuICAgIHRpbWVzdGFtcCxcbiAgICByZXNwb25zZVxuICB9OiBQcm90b2NvbC5OZXR3b3JrLldlYlNvY2tldEZyYW1lU2VudEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgZW50cnk6IE5ldHdvcmtSZXF1ZXN0IHwgdW5kZWZpbmVkID0gdGhpcy5fZW50cmllcy5nZXQocmVxdWVzdElkKTtcblxuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbnRyeS5hZGRQcm90b2NvbEZyYW1lKHJlc3BvbnNlLCB0aW1lc3RhbXAsIHRydWUpO1xuICAgIGVudHJ5LnJlc3BvbnNlUmVjZWl2ZWRUaW1lID0gdGltZXN0YW1wO1xuICB9XG5cbiAgcHVibGljIHdlYlNvY2tldEZyYW1lUmVjZWl2ZWQoe1xuICAgIHJlcXVlc3RJZCxcbiAgICB0aW1lc3RhbXAsXG4gICAgcmVzcG9uc2VcbiAgfTogUHJvdG9jb2wuTmV0d29yay5XZWJTb2NrZXRGcmFtZVJlY2VpdmVkRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBlbnRyeTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQgPSB0aGlzLl9lbnRyaWVzLmdldChyZXF1ZXN0SWQpO1xuXG4gICAgaWYgKCFlbnRyeSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGVudHJ5LmFkZFByb3RvY29sRnJhbWUocmVzcG9uc2UsIHRpbWVzdGFtcCwgZmFsc2UpO1xuICAgIGVudHJ5LnJlc3BvbnNlUmVjZWl2ZWRUaW1lID0gdGltZXN0YW1wO1xuICB9XG5cbiAgcHVibGljIHdlYlNvY2tldEZyYW1lRXJyb3Ioe1xuICAgIGVycm9yTWVzc2FnZSxcbiAgICByZXF1ZXN0SWQsXG4gICAgdGltZXN0YW1wXG4gIH06IFByb3RvY29sLk5ldHdvcmsuV2ViU29ja2V0RnJhbWVFcnJvckV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgZW50cnk6IE5ldHdvcmtSZXF1ZXN0IHwgdW5kZWZpbmVkID0gdGhpcy5fZW50cmllcy5nZXQocmVxdWVzdElkKTtcblxuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbnRyeS5hZGRQcm90b2NvbEZyYW1lRXJyb3IoZXJyb3JNZXNzYWdlLCB0aW1lc3RhbXApO1xuICAgIGVudHJ5LnJlc3BvbnNlUmVjZWl2ZWRUaW1lID0gdGltZXN0YW1wO1xuICB9XG5cbiAgcHVibGljIHdlYlNvY2tldENsb3NlZCh7XG4gICAgcmVxdWVzdElkLFxuICAgIHRpbWVzdGFtcFxuICB9OiBQcm90b2NvbC5OZXR3b3JrLldlYlNvY2tldENsb3NlZEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgZW50cnk6IE5ldHdvcmtSZXF1ZXN0IHwgdW5kZWZpbmVkID0gdGhpcy5fZW50cmllcy5nZXQocmVxdWVzdElkKTtcblxuICAgIGlmICghZW50cnkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmZpbmlzaFJlcXVlc3QoZW50cnksIHRpbWVzdGFtcCwgLTEpO1xuICB9XG5cbiAgcHVibGljIHJlcXVlc3RXaWxsQmVTZW50RXh0cmFJbmZvKHtcbiAgICByZXF1ZXN0SWQsXG4gICAgaGVhZGVyc1xuICB9OiBQcm90b2NvbC5OZXR3b3JrLlJlcXVlc3RXaWxsQmVTZW50RXh0cmFJbmZvRXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmdldEV4dHJhSW5mb0J1aWxkZXIocmVxdWVzdElkKS5hZGRSZXF1ZXN0RXh0cmFJbmZvKHtcbiAgICAgIHJlcXVlc3RIZWFkZXJzOiB0aGlzLmhlYWRlcnNNYXBUb0hlYWRlcnNBcnJheShoZWFkZXJzKVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHJlc3BvbnNlUmVjZWl2ZWRFeHRyYUluZm8oe1xuICAgIHJlcXVlc3RJZCxcbiAgICBoZWFkZXJzLFxuICAgIGhlYWRlcnNUZXh0XG4gIH06IFByb3RvY29sLk5ldHdvcmsuUmVzcG9uc2VSZWNlaXZlZEV4dHJhSW5mb0V2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5nZXRFeHRyYUluZm9CdWlsZGVyKHJlcXVlc3RJZCkuYWRkUmVzcG9uc2VFeHRyYUluZm8oe1xuICAgICAgcmVzcG9uc2VIZWFkZXJzOiB0aGlzLmhlYWRlcnNNYXBUb0hlYWRlcnNBcnJheShoZWFkZXJzKSxcbiAgICAgIHJlc3BvbnNlSGVhZGVyc1RleHQ6IGhlYWRlcnNUZXh0XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGdldEV4dHJhSW5mb0J1aWxkZXIoXG4gICAgcmVxdWVzdElkOiBQcm90b2NvbC5OZXR3b3JrLlJlcXVlc3RJZFxuICApOiBFeHRyYUluZm9CdWlsZGVyIHtcbiAgICBpZiAoIXRoaXMuX2V4dHJhSW5mb0J1aWxkZXJzLmhhcyhyZXF1ZXN0SWQpKSB7XG4gICAgICB0aGlzLl9leHRyYUluZm9CdWlsZGVycy5zZXQoXG4gICAgICAgIHJlcXVlc3RJZCxcbiAgICAgICAgbmV3IEV4dHJhSW5mb0J1aWxkZXIoKCk6IHZvaWQgPT4ge1xuICAgICAgICAgIHRoaXMuX2V4dHJhSW5mb0J1aWxkZXJzLmRlbGV0ZShyZXF1ZXN0SWQpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZXh0cmFJbmZvQnVpbGRlcnMuZ2V0KHJlcXVlc3RJZCk7XG4gIH1cblxuICBwcml2YXRlIF9hcHBlbmRSZWRpcmVjdChcbiAgICByZXF1ZXN0SWQ6IFByb3RvY29sLk5ldHdvcmsuUmVxdWVzdElkLFxuICAgIHRpbWU6IFByb3RvY29sLk5ldHdvcmsuTW9ub3RvbmljVGltZSxcbiAgICByZWRpcmVjdFVSTDogc3RyaW5nXG4gICk6IE5ldHdvcmtSZXF1ZXN0IHtcbiAgICBjb25zdCBvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCA9IHRoaXMuX2VudHJpZXMuZ2V0KFxuICAgICAgcmVxdWVzdElkXG4gICAgKSBhcyBOZXR3b3JrUmVxdWVzdDtcblxuICAgIGxldCByZWRpcmVjdENvdW50ID0gMDtcbiAgICBsZXQgcmVkaXJlY3Q6IE5ldHdvcmtSZXF1ZXN0IHwgdW5kZWZpbmVkID1cbiAgICAgIG9yaWdpbmFsTmV0d29ya1JlcXVlc3QucmVkaXJlY3RTb3VyY2U7XG5cbiAgICB3aGlsZSAocmVkaXJlY3QpIHtcbiAgICAgIHJlZGlyZWN0Q291bnQrKztcbiAgICAgIHJlZGlyZWN0ID0gcmVkaXJlY3QucmVkaXJlY3RTb3VyY2U7XG4gICAgfVxuXG4gICAgb3JpZ2luYWxOZXR3b3JrUmVxdWVzdC5tYXJrQXNSZWRpcmVjdChyZWRpcmVjdENvdW50KTtcblxuICAgIHRoaXMuZmluaXNoUmVxdWVzdChvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0LCB0aW1lLCAtMSk7XG5cbiAgICBjb25zdCBuZXdOZXR3b3JrUmVxdWVzdDogTmV0d29ya1JlcXVlc3QgPSB0aGlzLmNyZWF0ZVJlcXVlc3QoXG4gICAgICByZXF1ZXN0SWQsXG4gICAgICBvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0LmZyYW1lSWQsXG4gICAgICBvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0LmxvYWRlcklkLFxuICAgICAgcmVkaXJlY3RVUkwsXG4gICAgICBvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0LmRvY3VtZW50VVJMLFxuICAgICAgb3JpZ2luYWxOZXR3b3JrUmVxdWVzdC5pbml0aWF0b3JcbiAgICApO1xuXG4gICAgbmV3TmV0d29ya1JlcXVlc3QucmVkaXJlY3RTb3VyY2UgPSBvcmlnaW5hbE5ldHdvcmtSZXF1ZXN0O1xuXG4gICAgcmV0dXJuIG5ld05ldHdvcmtSZXF1ZXN0O1xuICB9XG5cbiAgcHJpdmF0ZSBmaW5pc2hSZXF1ZXN0KFxuICAgIG5ldHdvcmtSZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCxcbiAgICBmaW5pc2hUaW1lOiBQcm90b2NvbC5OZXR3b3JrLk1vbm90b25pY1RpbWUsXG4gICAgZW5jb2RlZERhdGFMZW5ndGg6IG51bWJlclxuICApOiB2b2lkIHtcbiAgICBuZXR3b3JrUmVxdWVzdC5lbmRUaW1lID0gZmluaXNoVGltZTtcblxuICAgIGlmIChlbmNvZGVkRGF0YUxlbmd0aCA+PSAwKSB7XG4gICAgICBjb25zdCByZWRpcmVjdFNvdXJjZTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQgPVxuICAgICAgICBuZXR3b3JrUmVxdWVzdC5yZWRpcmVjdFNvdXJjZTtcblxuICAgICAgaWYgKHJlZGlyZWN0U291cmNlPy5zaWduZWRFeGNoYW5nZUluZm8pIHtcbiAgICAgICAgbmV0d29ya1JlcXVlc3QudHJhbnNmZXJTaXplID0gMDtcbiAgICAgICAgcmVkaXJlY3RTb3VyY2UudHJhbnNmZXJTaXplID0gZW5jb2RlZERhdGFMZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXR3b3JrUmVxdWVzdC50cmFuc2ZlclNpemUgPSBlbmNvZGVkRGF0YUxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbnRlbnQpIHtcbiAgICAgIG5ldHdvcmtSZXF1ZXN0LnNldENvbnRlbnREYXRhKFxuICAgICAgICB0aGlzLm5ldHdvcmsuZ2V0UmVzcG9uc2VCb2R5KHtcbiAgICAgICAgICByZXF1ZXN0SWQ6IG5ldHdvcmtSZXF1ZXN0LnJlcXVlc3RJZFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLl9lbnRyaWVzLmRlbGV0ZShuZXR3b3JrUmVxdWVzdC5yZXF1ZXN0SWQpO1xuICAgIHRoaXMuZ2V0RXh0cmFJbmZvQnVpbGRlcihuZXR3b3JrUmVxdWVzdC5yZXF1ZXN0SWQpLmZpbmlzaGVkKCk7XG5cbiAgICBpZiAoIXRoaXMuZXhjbHVkZVJlcXVlc3QobmV0d29ya1JlcXVlc3QpKSB7XG4gICAgICB0aGlzLmRlc3RpbmF0aW9uKG5ldHdvcmtSZXF1ZXN0KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXJ0UmVxdWVzdChuZXR3b3JrUmVxdWVzdDogTmV0d29ya1JlcXVlc3QpOiB2b2lkIHtcbiAgICB0aGlzLl9lbnRyaWVzLnNldChuZXR3b3JrUmVxdWVzdC5yZXF1ZXN0SWQsIG5ldHdvcmtSZXF1ZXN0KTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlTmV0d29ya1JlcXVlc3RXaXRoUmVxdWVzdChcbiAgICBjaHJvbWVSZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCxcbiAgICByZXF1ZXN0OiBQcm90b2NvbC5OZXR3b3JrLlJlcXVlc3RcbiAgKTogdm9pZCB7XG4gICAgY2hyb21lUmVxdWVzdC5yZXF1ZXN0TWV0aG9kID0gcmVxdWVzdC5tZXRob2Q7XG4gICAgY2hyb21lUmVxdWVzdC5yZXF1ZXN0SGVhZGVycyA9IHRoaXMuaGVhZGVyc01hcFRvSGVhZGVyc0FycmF5KFxuICAgICAgcmVxdWVzdC5oZWFkZXJzXG4gICAgKTtcbiAgICBjaHJvbWVSZXF1ZXN0LnNldFJlcXVlc3RGb3JtRGF0YShcbiAgICAgIHRoaXMuZ2V0UmVxdWVzdFBvc3REYXRhKGNocm9tZVJlcXVlc3QucmVxdWVzdElkLCByZXF1ZXN0KVxuICAgICk7XG4gICAgY2hyb21lUmVxdWVzdC5pbml0aWFsUHJpb3JpdHkgPSByZXF1ZXN0LmluaXRpYWxQcmlvcml0eTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UmVxdWVzdFBvc3REYXRhKFxuICAgIHJlcXVlc3RJZDogUHJvdG9jb2wuTmV0d29yay5SZXF1ZXN0SWQsXG4gICAgcmVxdWVzdDogUHJvdG9jb2wuTmV0d29yay5SZXF1ZXN0XG4gICk6IHN0cmluZyB8IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIHJlcXVlc3QuaGFzUG9zdERhdGEgJiYgISFyZXF1ZXN0LnBvc3REYXRhXG4gICAgICA/IHJlcXVlc3QucG9zdERhdGFcbiAgICAgIDogdGhpcy5uZXR3b3JrXG4gICAgICAgICAgLmdldFJlcXVlc3RQb3N0RGF0YSh7IHJlcXVlc3RJZCB9KVxuICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgKHtcbiAgICAgICAgICAgICAgcG9zdERhdGFcbiAgICAgICAgICAgIH06IFByb3RvY29sLk5ldHdvcmsuR2V0UmVxdWVzdFBvc3REYXRhUmVzcG9uc2UpOiBzdHJpbmcgPT4gcG9zdERhdGFcbiAgICAgICAgICApXG4gICAgICAgICAgLmNhdGNoKCgpOiBzdHJpbmcgPT4gdW5kZWZpbmVkKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlUmVxdWVzdChcbiAgICByZXF1ZXN0SWQ6IFByb3RvY29sLk5ldHdvcmsuUmVxdWVzdElkLFxuICAgIGZyYW1lSWQ6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICBsb2FkZXJJZDogUHJvdG9jb2wuTmV0d29yay5Mb2FkZXJJZCxcbiAgICB1cmw6IHN0cmluZyxcbiAgICBkb2N1bWVudFVSTDogc3RyaW5nLFxuICAgIGluaXRpYXRvcj86IFByb3RvY29sLk5ldHdvcmsuSW5pdGlhdG9yXG4gICk6IE5ldHdvcmtSZXF1ZXN0IHtcbiAgICByZXR1cm4gbmV3IE5ldHdvcmtSZXF1ZXN0KFxuICAgICAgcmVxdWVzdElkLFxuICAgICAgdXJsLFxuICAgICAgZG9jdW1lbnRVUkwsXG4gICAgICBmcmFtZUlkLFxuICAgICAgbG9hZGVySWQsXG4gICAgICBpbml0aWF0b3JcbiAgICApO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcbiAgcHJpdmF0ZSB1cGRhdGVOZXR3b3JrUmVxdWVzdFdpdGhSZXNwb25zZShcbiAgICBuZXR3b3JrUmVxdWVzdDogTmV0d29ya1JlcXVlc3QsXG4gICAgcmVzcG9uc2U6IFByb3RvY29sLk5ldHdvcmsuUmVzcG9uc2VcbiAgKTogdm9pZCB7XG4gICAgaWYgKHJlc3BvbnNlLnVybCAmJiBuZXR3b3JrUmVxdWVzdC51cmwgIT09IHJlc3BvbnNlLnVybCkge1xuICAgICAgbmV0d29ya1JlcXVlc3Quc2V0VXJsKHJlc3BvbnNlLnVybCk7XG4gICAgfVxuICAgIG5ldHdvcmtSZXF1ZXN0Lm1pbWVUeXBlID0gcmVzcG9uc2UubWltZVR5cGU7XG4gICAgbmV0d29ya1JlcXVlc3Quc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1cztcbiAgICBuZXR3b3JrUmVxdWVzdC5zdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdHVzVGV4dDtcblxuICAgIGlmICghbmV0d29ya1JlcXVlc3QuaGFzRXh0cmFSZXNwb25zZUluZm8pIHtcbiAgICAgIG5ldHdvcmtSZXF1ZXN0LnJlc3BvbnNlSGVhZGVycyA9IHRoaXMuaGVhZGVyc01hcFRvSGVhZGVyc0FycmF5KFxuICAgICAgICByZXNwb25zZS5oZWFkZXJzXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChyZXNwb25zZS5lbmNvZGVkRGF0YUxlbmd0aCA+PSAwKSB7XG4gICAgICBuZXR3b3JrUmVxdWVzdC50cmFuc2ZlclNpemUgPSByZXNwb25zZS5lbmNvZGVkRGF0YUxlbmd0aDtcbiAgICB9XG5cbiAgICBpZiAocmVzcG9uc2UucmVxdWVzdEhlYWRlcnMgJiYgIW5ldHdvcmtSZXF1ZXN0Lmhhc0V4dHJhUmVxdWVzdEluZm8pIHtcbiAgICAgIG5ldHdvcmtSZXF1ZXN0LnJlcXVlc3RIZWFkZXJzID0gdGhpcy5oZWFkZXJzTWFwVG9IZWFkZXJzQXJyYXkoXG4gICAgICAgIHJlc3BvbnNlLnJlcXVlc3RIZWFkZXJzXG4gICAgICApO1xuICAgICAgbmV0d29ya1JlcXVlc3QucmVxdWVzdEhlYWRlcnNUZXh0ID0gcmVzcG9uc2UucmVxdWVzdEhlYWRlcnNUZXh0ID8/ICcnO1xuICAgIH1cblxuICAgIG5ldHdvcmtSZXF1ZXN0LmNvbm5lY3Rpb25SZXVzZWQgPSByZXNwb25zZS5jb25uZWN0aW9uUmV1c2VkO1xuICAgIG5ldHdvcmtSZXF1ZXN0LmNvbm5lY3Rpb25JZCA9IFN0cmluZyhyZXNwb25zZS5jb25uZWN0aW9uSWQpO1xuXG4gICAgaWYgKHJlc3BvbnNlLnJlbW90ZUlQQWRkcmVzcykge1xuICAgICAgbmV0d29ya1JlcXVlc3Quc2V0UmVtb3RlQWRkcmVzcyhcbiAgICAgICAgcmVzcG9uc2UucmVtb3RlSVBBZGRyZXNzLFxuICAgICAgICByZXNwb25zZS5yZW1vdGVQb3J0IHx8IC0xXG4gICAgICApO1xuICAgIH1cblxuICAgIG5ldHdvcmtSZXF1ZXN0LnRpbWluZyA9IHJlc3BvbnNlLnRpbWluZztcblxuICAgIG5ldHdvcmtSZXF1ZXN0LnByb3RvY29sID0gcmVzcG9uc2UucHJvdG9jb2wgPz8gJyc7XG4gIH1cblxuICBwcml2YXRlIGhlYWRlcnNNYXBUb0hlYWRlcnNBcnJheShcbiAgICBoZWFkZXJzTWFwOiBQcm90b2NvbC5OZXR3b3JrLkhlYWRlcnNcbiAgKTogSGVhZGVyW10ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhoZWFkZXJzTWFwKS5yZWR1Y2UoXG4gICAgICAoYWNjOiBIZWFkZXJbXSwgbmFtZTogc3RyaW5nKTogSGVhZGVyW10gPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZXM6IHN0cmluZ1tdID0gaGVhZGVyc01hcFtuYW1lXS5zcGxpdCgnXFxuJyk7XG5cbiAgICAgICAgYWNjLnB1c2goLi4udmFsdWVzLm1hcCgodmFsdWU6IHN0cmluZyk6IEhlYWRlciA9PiAoeyBuYW1lLCB2YWx1ZSB9KSkpO1xuXG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LFxuICAgICAgW11cbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBleGNsdWRlUmVxdWVzdChyZXF1ZXN0OiBOZXR3b3JrUmVxdWVzdCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgcGF0aCA9ICcvJyB9ID0gcmVxdWVzdC5wYXJzZWRVUkw7XG5cbiAgICByZXR1cm4gISF0aGlzLm9wdGlvbnMuZXhjbHVkZVBhdGhzPy5zb21lKChleGNsdWRlZFBhdGg6IHN0cmluZyk6IGJvb2xlYW4gPT5cbiAgICAgIG5ldyBSZWdFeHAoZXhjbHVkZWRQYXRoKS50ZXN0KHBhdGgpXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlRXZlbnQoeyBtZXRob2QsIHBhcmFtcyB9OiBDaHJvbWVSZW1vdGVJbnRlcmZhY2VFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IG1ldGhvZE5hbWU6IHN0cmluZyA9IG1ldGhvZC5zdWJzdHJpbmcobWV0aG9kLmluZGV4T2YoJy4nKSArIDEpO1xuXG4gICAgY29uc3QgaGFuZGxlcjogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93biB8IHVuZGVmaW5lZCA9IHRoaXNbXG4gICAgICBtZXRob2ROYW1lXG4gICAgXTtcblxuICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICBoYW5kbGVyLmNhbGwodGhpcywgcGFyYW1zKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkRequest = exports.WebSocketFrameType = void 0;\nconst tslib_1 = require(\"tslib\");\nconst CookieParser_1 = require(\"./CookieParser\");\nconst url_1 = require(\"url\");\nvar WebSocketFrameType;\n(function (WebSocketFrameType) {\n    WebSocketFrameType[\"REQUEST\"] = \"request\";\n    WebSocketFrameType[\"RESPONSE\"] = \"response\";\n    WebSocketFrameType[\"ERROR\"] = \"error\";\n})(WebSocketFrameType = exports.WebSocketFrameType || (exports.WebSocketFrameType = {}));\nclass NetworkRequest {\n    constructor(_requestId, url, documentURL, frameId = '', loaderId, initiator) {\n        this._requestId = _requestId;\n        this.documentURL = documentURL;\n        this.frameId = frameId;\n        this.loaderId = loaderId;\n        this.initiator = initiator;\n        this._wallIssueTime = -1;\n        this._requestHeaderValues = new Map();\n        this._responseHeaderValues = new Map();\n        this._requestFormData = Promise.resolve(undefined);\n        this._hasExtraResponseInfo = false;\n        this._hasExtraRequestInfo = false;\n        this._connectionId = '0';\n        this._protocol = '';\n        this._requestTime = 0;\n        this._requestMethod = '';\n        this._statusText = '';\n        this._remoteAddress = '';\n        this._startTime = -1;\n        this._issueTime = -1;\n        this._endTime = -1;\n        this._responseReceivedTime = -1;\n        this._resourceSize = 0;\n        this._transferSize = 0;\n        this._resourceType = 'Other';\n        this._requestHeaders = [];\n        this._requestHeadersText = '';\n        this._connectionReused = false;\n        this._responseHeaders = [];\n        this._responseHeadersText = '';\n        this._frames = [];\n        this._statusCode = 0;\n        this.setUrl(url);\n    }\n    set signedExchangeInfo(info) {\n        this._signedExchangeInfo = info;\n    }\n    get hasExtraResponseInfo() {\n        return this._hasExtraResponseInfo;\n    }\n    set hasExtraResponseInfo(value) {\n        this._hasExtraResponseInfo = value;\n    }\n    get hasExtraRequestInfo() {\n        return this._hasExtraRequestInfo;\n    }\n    set hasExtraRequestInfo(value) {\n        this._hasExtraRequestInfo = value;\n    }\n    get connectionId() {\n        return this._connectionId;\n    }\n    set connectionId(value) {\n        this._connectionId = value;\n    }\n    get protocol() {\n        return this._protocol;\n    }\n    set protocol(value) {\n        this._protocol = value !== null && value !== void 0 ? value : '';\n    }\n    get requestTime() {\n        return this._requestTime;\n    }\n    set requestTime(value) {\n        this._requestTime = value !== null && value !== void 0 ? value : 0;\n    }\n    get requestMethod() {\n        return this._requestMethod;\n    }\n    set requestMethod(value) {\n        this._requestMethod = value !== null && value !== void 0 ? value : '';\n    }\n    get statusText() {\n        return this._statusText;\n    }\n    set statusText(value) {\n        this._statusText = value !== null && value !== void 0 ? value : '';\n    }\n    get parsedURL() {\n        return this._parsedURL;\n    }\n    get url() {\n        return this._url;\n    }\n    get remoteAddress() {\n        return this._remoteAddress;\n    }\n    get startTime() {\n        return this._startTime || -1;\n    }\n    get issueTime() {\n        return this._issueTime;\n    }\n    get endTime() {\n        return this._endTime || -1;\n    }\n    set endTime(x) {\n        if (this.timing && this.timing.requestTime) {\n            this._endTime = Math.max(x, this.responseReceivedTime);\n        }\n        else {\n            this._endTime = x;\n            if (this._responseReceivedTime > x) {\n                this._responseReceivedTime = x;\n            }\n        }\n    }\n    get responseReceivedTime() {\n        return this._responseReceivedTime || -1;\n    }\n    set responseReceivedTime(value) {\n        this._responseReceivedTime = value;\n    }\n    get resourceSize() {\n        return this._resourceSize || 0;\n    }\n    set resourceSize(value) {\n        this._resourceSize = value !== null && value !== void 0 ? value : 0;\n    }\n    get transferSize() {\n        return this._transferSize || 0;\n    }\n    set transferSize(value) {\n        this._transferSize = value !== null && value !== void 0 ? value : 0;\n    }\n    get timing() {\n        return this._timing;\n    }\n    set timing(timingInfo) {\n        if (!timingInfo) {\n            return;\n        }\n        this._startTime = timingInfo.requestTime;\n        const headersReceivedTime = timingInfo.requestTime + timingInfo.receiveHeadersEnd / 1000.0;\n        if ((this._responseReceivedTime || -1) < 0 ||\n            this._responseReceivedTime > headersReceivedTime) {\n            this._responseReceivedTime = headersReceivedTime;\n        }\n        if (this._startTime > this._responseReceivedTime) {\n            this._responseReceivedTime = this._startTime;\n        }\n        this._timing = timingInfo;\n    }\n    get mimeType() {\n        return this._mimeType;\n    }\n    set mimeType(value) {\n        this._mimeType = value;\n    }\n    get resourceType() {\n        return this._resourceType;\n    }\n    set resourceType(resourceType) {\n        this._resourceType = resourceType !== null && resourceType !== void 0 ? resourceType : 'Other';\n    }\n    get redirectSource() {\n        return this._redirectSource;\n    }\n    set redirectSource(originatingRequest) {\n        this._redirectSource = originatingRequest;\n    }\n    get requestHeaders() {\n        return this._requestHeaders;\n    }\n    set requestHeaders(headers) {\n        this._requestHeaders = headers;\n        this._requestHeaderValues.clear();\n        delete this._requestCookies;\n    }\n    get requestCookies() {\n        if (!this._requestCookies) {\n            const cookie = this.requestHeaderValue('Cookie');\n            this._requestCookies = new CookieParser_1.CookieParser().parseCookie(cookie);\n        }\n        return this._requestCookies;\n    }\n    get contentLength() {\n        const contentLength = this.requestHeaderValue('Content-Length');\n        return isNaN(+contentLength) ? 0 : parseInt(contentLength, 10);\n    }\n    get requestHeadersText() {\n        return this._requestHeadersText;\n    }\n    set requestHeadersText(text) {\n        this._requestHeadersText = text;\n    }\n    get connectionReused() {\n        return this._connectionReused;\n    }\n    set connectionReused(value) {\n        this._connectionReused = value;\n    }\n    get responseHeaders() {\n        return this._responseHeaders || [];\n    }\n    set responseHeaders(value) {\n        this._responseHeaders = value;\n        delete this._responseCookies;\n        this._responseHeaderValues.clear();\n    }\n    get responseHeadersText() {\n        return this._responseHeadersText;\n    }\n    set responseHeadersText(value) {\n        this._responseHeadersText = value;\n    }\n    get responseCookies() {\n        if (!this._responseCookies) {\n            const cookie = this.responseHeaderValue('Set-Cookie');\n            this._requestCookies = new CookieParser_1.CookieParser().parseSetCookie(cookie);\n        }\n        return this._responseCookies;\n    }\n    get queryString() {\n        if (this._queryString !== undefined) {\n            return this._queryString;\n        }\n        let queryString = null;\n        const questionMarkPosition = this.url.indexOf('?');\n        if (questionMarkPosition !== -1) {\n            queryString = this.url.substring(questionMarkPosition + 1);\n            const hashSignPosition = queryString.indexOf('#');\n            if (hashSignPosition !== -1) {\n                queryString = queryString.substring(0, hashSignPosition);\n            }\n        }\n        this._queryString = queryString;\n        return this._queryString;\n    }\n    get initialPriority() {\n        return this._initialPriority;\n    }\n    set initialPriority(priority) {\n        this._initialPriority = priority;\n    }\n    get frames() {\n        return this._frames;\n    }\n    get statusCode() {\n        return this._statusCode;\n    }\n    set statusCode(value) {\n        this._statusCode = value;\n    }\n    get requestId() {\n        return this._requestId;\n    }\n    get requestHttpVersion() {\n        if (this.requestHeadersText) {\n            const firstLine = this.requestHeadersText.split(/\\r\\n/)[0];\n            const match = firstLine.match(/(HTTP\\/\\d+\\.\\d+)$/);\n            return match ? match[1] : 'HTTP/0.9';\n        }\n        const version = this.requestHeaderValue('version') || this.requestHeaderValue(':version');\n        if (version) {\n            return version;\n        }\n        return this.getFilteredProtocolName();\n    }\n    get queryParameters() {\n        if (this._parsedQueryParameters) {\n            return this._parsedQueryParameters;\n        }\n        if (!this.queryString) {\n            return null;\n        }\n        this._parsedQueryParameters = this.parseParameters(this.queryString);\n        return this._parsedQueryParameters;\n    }\n    get requestContentType() {\n        return this.requestHeaderValue('Content-Type');\n    }\n    get priority() {\n        var _a, _b;\n        return (_b = (_a = this._currentPriority) !== null && _a !== void 0 ? _a : this._initialPriority) !== null && _b !== void 0 ? _b : undefined;\n    }\n    set priority(priority) {\n        this._currentPriority = priority;\n    }\n    static escapeCharacters(str, chars = '^[]{}()\\\\\\\\.$*+?|') {\n        let foundChar = false;\n        const length = chars.length;\n        for (let i = 0; i < length; ++i) {\n            if (str.indexOf(chars.charAt(i)) !== -1) {\n                foundChar = true;\n                break;\n            }\n        }\n        if (!foundChar) {\n            return str;\n        }\n        let result = '';\n        for (let j = 0; j < str.length; ++j) {\n            if (chars.indexOf(str.charAt(j)) !== -1) {\n                result += '\\\\';\n            }\n            result += str.charAt(j);\n        }\n        return result;\n    }\n    setUrl(value) {\n        if (this._url === value) {\n            return;\n        }\n        this._url = value;\n        this._parsedURL = url_1.parse(value);\n        delete this._queryString;\n        delete this._parsedQueryParameters;\n    }\n    setRemoteAddress(ip, port) {\n        this._remoteAddress = `${ip}:${port}`;\n    }\n    setIssueTime(monotonicTime, wallTime) {\n        this._issueTime = monotonicTime;\n        this._wallIssueTime = wallTime;\n        this._startTime = monotonicTime;\n    }\n    increaseTransferSize(value) {\n        this._transferSize = (this._transferSize || 0) + value;\n    }\n    requestFormData() {\n        return this._requestFormData;\n    }\n    setRequestFormData(data) {\n        this._requestFormData =\n            typeof data === 'string' ? Promise.resolve(data) : data;\n        this._formParametersPromise = null;\n    }\n    getWallTime(monotonicTime) {\n        return this._wallIssueTime\n            ? this._wallIssueTime - this._issueTime + monotonicTime\n            : monotonicTime;\n    }\n    formParameters() {\n        if (!this._formParametersPromise) {\n            this._formParametersPromise = this.parseFormParameters();\n        }\n        return this._formParametersPromise;\n    }\n    responseHttpVersion() {\n        if (this._responseHeadersText) {\n            const firstLine = this._responseHeadersText.split(/\\r\\n/)[0];\n            const match = firstLine.match(/^(HTTP\\/\\d+\\.\\d+)/);\n            return match ? match[1] : 'HTTP/0.9';\n        }\n        const version = this.responseHeaderValue('version') ||\n            this.responseHeaderValue(':version');\n        if (version) {\n            return version;\n        }\n        return this.getFilteredProtocolName();\n    }\n    setContentData(data) {\n        if (this.resourceType === 'WebSocket') {\n            this._contentData = Promise.resolve({\n                error: 'Content for WebSockets is currently not supported'\n            });\n        }\n        this._contentData = data\n            .then(({ body: text, base64Encoded }) => ({\n            text,\n            encoding: base64Encoded ? 'base64' : undefined\n        }))\n            .catch((e) => ({ error: e.message }));\n    }\n    contentData() {\n        return this._contentData;\n    }\n    addProtocolFrameError(errorMessage, time) {\n        this.addFrame({\n            type: WebSocketFrameType.ERROR,\n            data: errorMessage,\n            time,\n            opcode: -1,\n            mask: false\n        });\n    }\n    addProtocolFrame(response, time, sent) {\n        const type = sent\n            ? WebSocketFrameType.REQUEST\n            : WebSocketFrameType.RESPONSE;\n        this.addFrame({\n            type,\n            data: response.payloadData,\n            time,\n            opcode: response.opcode,\n            mask: response.mask\n        });\n    }\n    markAsRedirect(redirectCount) {\n        this._requestId = `${this.requestId}:redirected.${redirectCount}`;\n    }\n    addExtraRequestInfo(extraRequestInfo) {\n        this.requestHeaders = extraRequestInfo.requestHeaders;\n        this._hasExtraRequestInfo = true;\n        this.requestHeadersText = '';\n    }\n    addExtraResponseInfo(extraResponseInfo) {\n        this.responseHeaders = extraResponseInfo.responseHeaders;\n        if (extraResponseInfo.responseHeadersText) {\n            this.responseHeadersText = extraResponseInfo.responseHeadersText;\n            if (this.requestHeadersText) {\n                let requestHeadersText = `${this._requestMethod} ${this.parsedURL.path}`;\n                // eslint-disable-next-line max-depth\n                if (this.parsedURL.query) {\n                    requestHeadersText += `?${this.parsedURL.query}`;\n                }\n                requestHeadersText += ` HTTP/1.1\\r\\n`;\n                // eslint-disable-next-line max-depth\n                for (const { name, value } of this.requestHeaders) {\n                    requestHeadersText += `${name}: ${value}\\r\\n`;\n                }\n                this.requestHeadersText = requestHeadersText;\n            }\n        }\n        this._hasExtraResponseInfo = true;\n    }\n    responseHeaderValue(headerName) {\n        if (!this._responseHeaderValues.has(headerName)) {\n            this._responseHeaderValues.set(headerName, this.computeHeaderValue(this.responseHeaders, headerName));\n        }\n        return this._responseHeaderValues.get(headerName);\n    }\n    parseFormParameters() {\n        var _a, _b;\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            if ((_a = this.requestContentType) === null || _a === void 0 ? void 0 : _a.match(/^application\\/x-www-form-urlencoded\\s*(;.*)?$/i)) {\n                const formUrlencoded = yield this.requestFormData();\n                if (!formUrlencoded) {\n                    return;\n                }\n                return this.parseParameters(formUrlencoded);\n            }\n            const multipartDetails = (_b = this.requestContentType) === null || _b === void 0 ? void 0 : _b.match(/^multipart\\/form-data\\s*;\\s*boundary\\s*=\\s*(\\S+)\\s*$/);\n            if (!multipartDetails) {\n                return;\n            }\n            const boundary = multipartDetails[1];\n            if (!boundary) {\n                return;\n            }\n            const formData = yield this.requestFormData();\n            if (!formData) {\n                return;\n            }\n            return this.parseMultipartFormDataParameters(formData, boundary);\n        });\n    }\n    parseMultipartFormDataParameters(data, boundary) {\n        const sanitizedBoundary = NetworkRequest.escapeCharacters(boundary);\n        const keyValuePattern = new RegExp(\n        // Header with an optional file name.\n        '^\\\\r\\\\ncontent-disposition\\\\s*:\\\\s*form-data\\\\s*;\\\\s*name=\"([^\"]*)\"(?:\\\\s*;\\\\s*filename=\"([^\"]*)\")?' +\n            // Optional secondary header with the content type.\n            '(?:\\\\r\\\\ncontent-type\\\\s*:\\\\s*([^\\\\r\\\\n]*))?' +\n            // Padding.\n            '\\\\r\\\\n\\\\r\\\\n' +\n            // Value\n            '(.*)' +\n            // Padding.\n            '\\\\r\\\\n$', 'is');\n        const fields = data.split(\n        // eslint-disable-next-line no-useless-escape\n        new RegExp(`--${sanitizedBoundary}(?:--\\s*$)?`, 'g'));\n        return fields.reduce((result, field) => {\n            // eslint-disable-next-line @typescript-eslint/typedef\n            const [match, name, value] = field.match(keyValuePattern) || [];\n            if (!match) {\n                return result;\n            }\n            result.push({ name, value });\n            return result;\n        }, []);\n    }\n    addFrame(frame) {\n        this._frames.push(frame);\n    }\n    requestHeaderValue(headerName) {\n        if (!this._requestHeaderValues.has(headerName)) {\n            this._requestHeaderValues.set(headerName, this.computeHeaderValue(this.requestHeaders, headerName));\n        }\n        return this._requestHeaderValues.get(headerName);\n    }\n    getFilteredProtocolName() {\n        const protocol = this._protocol.toLowerCase();\n        if (protocol === 'h2') {\n            return 'http/2.0';\n        }\n        return protocol.replace(/^http\\/2(\\.0)?\\+/, 'http/2.0+');\n    }\n    parseParameters(queryString) {\n        return queryString.split('&').map((pair) => {\n            const position = pair.indexOf('=');\n            if (position === -1) {\n                return { name: pair, value: '' };\n            }\n            else {\n                return {\n                    name: pair.substring(0, position),\n                    value: pair.substring(position + 1)\n                };\n            }\n        });\n    }\n    computeHeaderValue(headers, headerName) {\n        headerName = headerName.toLowerCase();\n        const values = headers\n            .filter(({ name }) => name.toLowerCase() === headerName)\n            .map(({ value }) => value);\n        if (!values.length) {\n            return;\n        }\n        // Set-Cookie values should be separated by '\\n', not comma, otherwise cookies could not be parsed.\n        if (headerName === 'set-cookie') {\n            return values.join('\\n');\n        }\n        return values.join(', ');\n    }\n}\nexports.NetworkRequest = NetworkRequest;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTmV0d29ya1JlcXVlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbmV0d29yay9OZXR3b3JrUmVxdWVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsaURBQThDO0FBSzlDLDZCQUE0RDtBQVE1RCxJQUFZLGtCQUlYO0FBSkQsV0FBWSxrQkFBa0I7SUFDNUIseUNBQW1CLENBQUE7SUFDbkIsMkNBQXFCLENBQUE7SUFDckIscUNBQWUsQ0FBQTtBQUNqQixDQUFDLEVBSlcsa0JBQWtCLEdBQWxCLDBCQUFrQixLQUFsQiwwQkFBa0IsUUFJN0I7QUFVRCxNQUFhLGNBQWM7SUEyWnpCLFlBQ1UsVUFBc0MsRUFDOUMsR0FBVyxFQUNLLFdBQW1CLEVBQ25CLFVBQWlDLEVBQUUsRUFDbkMsUUFBbUMsRUFDbkMsU0FBc0M7UUFMOUMsZUFBVSxHQUFWLFVBQVUsQ0FBNEI7UUFFOUIsZ0JBQVcsR0FBWCxXQUFXLENBQVE7UUFDbkIsWUFBTyxHQUFQLE9BQU8sQ0FBNEI7UUFDbkMsYUFBUSxHQUFSLFFBQVEsQ0FBMkI7UUFDbkMsY0FBUyxHQUFULFNBQVMsQ0FBNkI7UUEvWmhELG1CQUFjLEdBQW9DLENBQUMsQ0FBQyxDQUFDO1FBQ3JELHlCQUFvQixHQUF3QixJQUFJLEdBQUcsRUFBa0IsQ0FBQztRQUN0RSwwQkFBcUIsR0FBd0IsSUFBSSxHQUFHLEVBR3pELENBQUM7UUFHSSxxQkFBZ0IsR0FBZ0MsT0FBTyxDQUFDLE9BQU8sQ0FDckUsU0FBUyxDQUNWLENBQUM7UUFXTSwwQkFBcUIsR0FBWSxLQUFLLENBQUM7UUFVdkMseUJBQW9CLEdBQVksS0FBSyxDQUFDO1FBVXRDLGtCQUFhLEdBQVksR0FBRyxDQUFDO1FBVTdCLGNBQVMsR0FBVyxFQUFFLENBQUM7UUFVdkIsaUJBQVksR0FBVyxDQUFDLENBQUM7UUFVekIsbUJBQWMsR0FBVyxFQUFFLENBQUM7UUFVNUIsZ0JBQVcsR0FBVyxFQUFFLENBQUM7UUFzQnpCLG1CQUFj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bnQiOlsiaW1wb3J0IHsgQ29va2llUGFyc2VyIH0gZnJvbSAnLi9Db29raWVQYXJzZXInO1xuaW1wb3J0IHsgTmV0d29ya0Nvb2tpZSB9IGZyb20gJy4vTmV0d29ya0Nvb2tpZSc7XG5pbXBvcnQgeyBSZXF1ZXN0RXh0cmFJbmZvLCBSZXNwb25zZUV4dHJhSW5mbyB9IGZyb20gJy4vRXh0cmFJbmZvQnVpbGRlcic7XG5pbXBvcnQgeyBIZWFkZXIsIFBhcmFtLCBRdWVyeVN0cmluZyB9IGZyb20gJ2hhci1mb3JtYXQnO1xuaW1wb3J0IFByb3RvY29sIGZyb20gJ2RldnRvb2xzLXByb3RvY29sJztcbmltcG9ydCB7IHBhcnNlIGFzIHBhcnNlVXJsLCBVcmxXaXRoU3RyaW5nUXVlcnkgfSBmcm9tICd1cmwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRlbnREYXRhIHtcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIHRleHQ/OiBzdHJpbmc7XG4gIGVuY29kaW5nPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZW51bSBXZWJTb2NrZXRGcmFtZVR5cGUge1xuICBSRVFVRVNUID0gJ3JlcXVlc3QnLFxuICBSRVNQT05TRSA9ICdyZXNwb25zZScsXG4gIEVSUk9SID0gJ2Vycm9yJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdlYlNvY2tldCB7XG4gIHR5cGU6IFdlYlNvY2tldEZyYW1lVHlwZTtcbiAgZGF0YTogc3RyaW5nO1xuICB0aW1lOiBQcm90b2NvbC5OZXR3b3JrLk1vbm90b25pY1RpbWU7XG4gIG9wY29kZTogbnVtYmVyO1xuICBtYXNrOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgTmV0d29ya1JlcXVlc3Qge1xuICBwcml2YXRlIF9jb250ZW50RGF0YT86IFByb21pc2U8Q29udGVudERhdGE+O1xuICBwcml2YXRlIF93YWxsSXNzdWVUaW1lOiBQcm90b2NvbC5OZXR3b3JrLlRpbWVTaW5jZUVwb2NoID0gLTE7XG4gIHByaXZhdGUgX3JlcXVlc3RIZWFkZXJWYWx1ZXM6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xuICBwcml2YXRlIF9yZXNwb25zZUhlYWRlclZhbHVlczogTWFwPHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXA8XG4gICAgc3RyaW5nLFxuICAgIHN0cmluZ1xuICA+KCk7XG4gIHByaXZhdGUgX3BhcnNlZFF1ZXJ5UGFyYW1ldGVycz86IFF1ZXJ5U3RyaW5nW107XG4gIHByaXZhdGUgX2N1cnJlbnRQcmlvcml0eT86IFByb3RvY29sLk5ldHdvcmsuUmVzb3VyY2VQcmlvcml0eTtcbiAgcHJpdmF0ZSBfcmVxdWVzdEZvcm1EYXRhOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD4gPSBQcm9taXNlLnJlc29sdmUoXG4gICAgdW5kZWZpbmVkXG4gICk7XG4gIHByaXZhdGUgX2Zvcm1QYXJhbWV0ZXJzUHJvbWlzZT86IFByb21pc2U8UGFyYW1bXT47XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAvLyBAdHMtaWdub3JlXG4gIHByaXZhdGUgX3NpZ25lZEV4Y2hhbmdlSW5mbz86IFByb3RvY29sLk5ldHdvcmsuU2lnbmVkRXhjaGFuZ2VJbmZvO1xuXG4gIHNldCBzaWduZWRFeGNoYW5nZUluZm8oaW5mbzogUHJvdG9jb2wuTmV0d29yay5TaWduZWRFeGNoYW5nZUluZm8pIHtcbiAgICB0aGlzLl9zaWduZWRFeGNoYW5nZUluZm8gPSBpbmZvO1xuICB9XG5cbiAgcHJpdmF0ZSBfaGFzRXh0cmFSZXNwb25zZUluZm86IGJvb2xlYW4gPSBmYWxzZTtcblxuICBnZXQgaGFzRXh0cmFSZXNwb25zZUluZm8oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2hhc0V4dHJhUmVzcG9uc2VJbmZvO1xuICB9XG5cbiAgc2V0IGhhc0V4dHJhUmVzcG9uc2VJbmZvKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5faGFzRXh0cmFSZXNwb25zZUluZm8gPSB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgX2hhc0V4dHJhUmVxdWVzdEluZm86IGJvb2xlYW4gPSBmYWxzZTtcblxuICBnZXQgaGFzRXh0cmFSZXF1ZXN0SW5mbygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faGFzRXh0cmFSZXF1ZXN0SW5mbztcbiAgfVxuXG4gIHNldCBoYXNFeHRyYVJlcXVlc3RJbmZvKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5faGFzRXh0cmFSZXF1ZXN0SW5mbyA9IHZhbHVlO1xuICB9XG5cbiAgcHJpdmF0ZSBfY29ubmVjdGlvbklkPzogc3RyaW5nID0gJzAnO1xuXG4gIGdldCBjb25uZWN0aW9uSWQoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fY29ubmVjdGlvbklkO1xuICB9XG5cbiAgc2V0IGNvbm5lY3Rpb25JZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fY29ubmVjdGlvbklkID0gdmFsdWU7XG4gIH1cblxuICBwcml2YXRlIF9wcm90b2NvbDogc3RyaW5nID0gJyc7XG5cbiAgZ2V0IHByb3RvY29sKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb3RvY29sO1xuICB9XG5cbiAgc2V0IHByb3RvY29sKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9wcm90b2NvbCA9IHZhbHVlID8/ICcnO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVxdWVzdFRpbWU6IG51bWJlciA9IDA7XG5cbiAgZ2V0IHJlcXVlc3RUaW1lKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RUaW1lO1xuICB9XG5cbiAgc2V0IHJlcXVlc3RUaW1lKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9yZXF1ZXN0VGltZSA9IHZhbHVlID8/IDA7XG4gIH1cblxuICBwcml2YXRlIF9yZXF1ZXN0TWV0aG9kOiBzdHJpbmcgPSAnJztcblxuICBnZXQgcmVxdWVzdE1ldGhvZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0TWV0aG9kO1xuICB9XG5cbiAgc2V0IHJlcXVlc3RNZXRob2QodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX3JlcXVlc3RNZXRob2QgPSB2YWx1ZSA/PyAnJztcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXR1c1RleHQ6IHN0cmluZyA9ICcnO1xuXG4gIGdldCBzdGF0dXNUZXh0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX3N0YXR1c1RleHQ7XG4gIH1cblxuICBzZXQgc3RhdHVzVGV4dCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fc3RhdHVzVGV4dCA9IHZhbHVlID8/ICcnO1xuICB9XG5cbiAgcHJpdmF0ZSBfcGFyc2VkVVJMPzogVXJsV2l0aFN0cmluZ1F1ZXJ5O1xuXG4gIGdldCBwYXJzZWRVUkwoKTogVXJsV2l0aFN0cmluZ1F1ZXJ5IHtcbiAgICByZXR1cm4gdGhpcy5fcGFyc2VkVVJMO1xuICB9XG5cbiAgcHJpdmF0ZSBfdXJsPzogc3RyaW5nO1xuXG4gIGdldCB1cmwoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fdXJsO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVtb3RlQWRkcmVzczogc3RyaW5nID0gJyc7XG5cbiAgZ2V0IHJlbW90ZUFkZHJlc3MoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fcmVtb3RlQWRkcmVzcztcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXJ0VGltZTogUHJvdG9jb2wuTmV0d29yay5Nb25vdG9uaWNUaW1lID0gLTE7XG5cbiAgZ2V0IHN0YXJ0VGltZSgpOiBQcm90b2NvbC5OZXR3b3JrLk1vbm90b25pY1RpbWUge1xuICAgIHJldHVybiB0aGlzLl9zdGFydFRpbWUgfHwgLTE7XG4gIH1cblxuICBwcml2YXRlIF9pc3N1ZVRpbWU6IFByb3RvY29sLk5ldHdvcmsuTW9ub3RvbmljVGltZSA9IC0xO1xuXG4gIGdldCBpc3N1ZVRpbWUoKTogUHJvdG9jb2wuTmV0d29yay5Nb25vdG9uaWNUaW1lIHtcbiAgICByZXR1cm4gdGhpcy5faXNzdWVUaW1lO1xuICB9XG5cbiAgcHJpdmF0ZSBfZW5kVGltZTogbnVtYmVyID0gLTE7XG5cbiAgZ2V0IGVuZFRpbWUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fZW5kVGltZSB8fCAtMTtcbiAgfVxuXG4gIHNldCBlbmRUaW1lKHg6IG51bWJlcikge1xuICAgIGlmICh0aGlzLnRpbWluZyAmJiB0aGlzLnRpbWluZy5yZXF1ZXN0VGltZSkge1xuICAgICAgdGhpcy5fZW5kVGltZSA9IE1hdGgubWF4KHgsIHRoaXMucmVzcG9uc2VSZWNlaXZlZFRpbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmRUaW1lID0geDtcbiAgICAgIGlmICh0aGlzLl9yZXNwb25zZVJlY2VpdmVkVGltZSA+IHgpIHtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VSZWNlaXZlZFRpbWUgPSB4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX3Jlc3BvbnNlUmVjZWl2ZWRUaW1lOiBudW1iZXIgPSAtMTtcblxuICBnZXQgcmVzcG9uc2VSZWNlaXZlZFRpbWUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VSZWNlaXZlZFRpbWUgfHwgLTE7XG4gIH1cblxuICBzZXQgcmVzcG9uc2VSZWNlaXZlZFRpbWUodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3Jlc3BvbnNlUmVjZWl2ZWRUaW1lID0gdmFsdWU7XG4gIH1cblxuICBwcml2YXRlIF9yZXNvdXJjZVNpemU6IG51bWJlciA9IDA7XG5cbiAgZ2V0IHJlc291cmNlU2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9yZXNvdXJjZVNpemUgfHwgMDtcbiAgfVxuXG4gIHNldCByZXNvdXJjZVNpemUodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3Jlc291cmNlU2l6ZSA9IHZhbHVlID8/IDA7XG4gIH1cblxuICBwcml2YXRlIF90cmFuc2ZlclNpemU6IG51bWJlciA9IDA7XG5cbiAgZ2V0IHRyYW5zZmVyU2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl90cmFuc2ZlclNpemUgfHwgMDtcbiAgfVxuXG4gIHNldCB0cmFuc2ZlclNpemUodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3RyYW5zZmVyU2l6ZSA9IHZhbHVlID8/IDA7XG4gIH1cblxuICBwcml2YXRlIF90aW1pbmc/OiBQcm90b2NvbC5OZXR3b3JrLlJlc291cmNlVGltaW5nO1xuXG4gIGdldCB0aW1pbmcoKTogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVRpbWluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX3RpbWluZztcbiAgfVxuXG4gIHNldCB0aW1pbmcodGltaW5nSW5mbzogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVRpbWluZykge1xuICAgIGlmICghdGltaW5nSW5mbykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX3N0YXJ0VGltZSA9IHRpbWluZ0luZm8ucmVxdWVzdFRpbWU7XG5cbiAgICBjb25zdCBoZWFkZXJzUmVjZWl2ZWRUaW1lOiBudW1iZXIgPVxuICAgICAgdGltaW5nSW5mby5yZXF1ZXN0VGltZSArIHRpbWluZ0luZm8ucmVjZWl2ZUhlYWRlcnNFbmQgLyAxMDAwLjA7XG5cbiAgICBpZiAoXG4gICAgICAodGhpcy5fcmVzcG9uc2VSZWNlaXZlZFRpbWUgfHwgLTEpIDwgMCB8fFxuICAgICAgdGhpcy5fcmVzcG9uc2VSZWNlaXZlZFRpbWUgPiBoZWFkZXJzUmVjZWl2ZWRUaW1lXG4gICAgKSB7XG4gICAgICB0aGlzLl9yZXNwb25zZVJlY2VpdmVkVGltZSA9IGhlYWRlcnNSZWNlaXZlZFRpbWU7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3N0YXJ0VGltZSA+IHRoaXMuX3Jlc3BvbnNlUmVjZWl2ZWRUaW1lKSB7XG4gICAgICB0aGlzLl9yZXNwb25zZVJlY2VpdmVkVGltZSA9IHRoaXMuX3N0YXJ0VGltZTtcbiAgICB9XG5cbiAgICB0aGlzLl90aW1pbmcgPSB0aW1pbmdJbmZvO1xuICB9XG5cbiAgcHJpdmF0ZSBfbWltZVR5cGU/OiBzdHJpbmc7XG5cbiAgZ2V0IG1pbWVUeXBlKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX21pbWVUeXBlO1xuICB9XG5cbiAgc2V0IG1pbWVUeXBlKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9taW1lVHlwZSA9IHZhbHVlO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVzb3VyY2VUeXBlOiBQcm90b2NvbC5OZXR3b3JrLlJlc291cmNlVHlwZSA9ICdPdGhlcic7XG5cbiAgZ2V0IHJlc291cmNlVHlwZSgpOiBQcm90b2NvbC5OZXR3b3JrLlJlc291cmNlVHlwZSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jlc291cmNlVHlwZTtcbiAgfVxuXG4gIHNldCByZXNvdXJjZVR5cGUocmVzb3VyY2VUeXBlOiBQcm90b2NvbC5OZXR3b3JrLlJlc291cmNlVHlwZSkge1xuICAgIHRoaXMuX3Jlc291cmNlVHlwZSA9IHJlc291cmNlVHlwZSA/PyAnT3RoZXInO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVkaXJlY3RTb3VyY2U/OiBOZXR3b3JrUmVxdWVzdDtcblxuICBnZXQgcmVkaXJlY3RTb3VyY2UoKTogTmV0d29ya1JlcXVlc3QgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9yZWRpcmVjdFNvdXJjZTtcbiAgfVxuXG4gIHNldCByZWRpcmVjdFNvdXJjZShvcmlnaW5hdGluZ1JlcXVlc3Q6IE5ldHdvcmtSZXF1ZXN0KSB7XG4gICAgdGhpcy5fcmVkaXJlY3RTb3VyY2UgPSBvcmlnaW5hdGluZ1JlcXVlc3Q7XG4gIH1cblxuICBwcml2YXRlIF9yZXF1ZXN0SGVhZGVyczogSGVhZGVyW10gPSBbXTtcblxuICBnZXQgcmVxdWVzdEhlYWRlcnMoKTogSGVhZGVyW10ge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0SGVhZGVycztcbiAgfVxuXG4gIHNldCByZXF1ZXN0SGVhZGVycyhoZWFkZXJzOiBIZWFkZXJbXSkge1xuICAgIHRoaXMuX3JlcXVlc3RIZWFkZXJzID0gaGVhZGVycztcbiAgICB0aGlzLl9yZXF1ZXN0SGVhZGVyVmFsdWVzLmNsZWFyKCk7XG4gICAgZGVsZXRlIHRoaXMuX3JlcXVlc3RDb29raWVzO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVxdWVzdENvb2tpZXM/OiBOZXR3b3JrQ29va2llW107XG5cbiAgZ2V0IHJlcXVlc3RDb29raWVzKCk6IE5ldHdvcmtDb29raWVbXSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLl9yZXF1ZXN0Q29va2llcykge1xuICAgICAgY29uc3QgY29va2llID0gdGhpcy5yZXF1ZXN0SGVhZGVyVmFsdWUoJ0Nvb2tpZScpO1xuICAgICAgdGhpcy5fcmVxdWVzdENvb2tpZXMgPSBuZXcgQ29va2llUGFyc2VyKCkucGFyc2VDb29raWUoY29va2llKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENvb2tpZXM7XG4gIH1cblxuICBnZXQgY29udGVudExlbmd0aCgpOiBudW1iZXIge1xuICAgIGNvbnN0IGNvbnRlbnRMZW5ndGg6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHRoaXMucmVxdWVzdEhlYWRlclZhbHVlKFxuICAgICAgJ0NvbnRlbnQtTGVuZ3RoJ1xuICAgICk7XG5cbiAgICByZXR1cm4gaXNOYU4oK2NvbnRlbnRMZW5ndGgpID8gMCA6IHBhcnNlSW50KGNvbnRlbnRMZW5ndGgsIDEwKTtcbiAgfVxuXG4gIHByaXZhdGUgX3JlcXVlc3RIZWFkZXJzVGV4dDogc3RyaW5nID0gJyc7XG5cbiAgZ2V0IHJlcXVlc3RIZWFkZXJzVGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0SGVhZGVyc1RleHQ7XG4gIH1cblxuICBzZXQgcmVxdWVzdEhlYWRlcnNUZXh0KHRleHQ6IHN0cmluZykge1xuICAgIHRoaXMuX3JlcXVlc3RIZWFkZXJzVGV4dCA9IHRleHQ7XG4gIH1cblxuICBwcml2YXRlIF9jb25uZWN0aW9uUmV1c2VkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgZ2V0IGNvbm5lY3Rpb25SZXVzZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2Nvbm5lY3Rpb25SZXVzZWQ7XG4gIH1cblxuICBzZXQgY29ubmVjdGlvblJldXNlZCh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2Nvbm5lY3Rpb25SZXVzZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgX3Jlc3BvbnNlSGVhZGVyczogSGVhZGVyW10gPSBbXTtcblxuICBnZXQgcmVzcG9uc2VIZWFkZXJzKCk6IEhlYWRlcltdIHtcbiAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VIZWFkZXJzIHx8IFtdO1xuICB9XG5cbiAgc2V0IHJlc3BvbnNlSGVhZGVycyh2YWx1ZTogSGVhZGVyW10pIHtcbiAgICB0aGlzLl9yZXNwb25zZUhlYWRlcnMgPSB2YWx1ZTtcbiAgICBkZWxldGUgdGhpcy5fcmVzcG9uc2VDb29raWVzO1xuICAgIHRoaXMuX3Jlc3BvbnNlSGVhZGVyVmFsdWVzLmNsZWFyKCk7XG4gIH1cblxuICBwcml2YXRlIF9yZXNwb25zZUhlYWRlcnNUZXh0OiBzdHJpbmcgPSAnJztcblxuICBnZXQgcmVzcG9uc2VIZWFkZXJzVGV4dCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9yZXNwb25zZUhlYWRlcnNUZXh0O1xuICB9XG5cbiAgc2V0IHJlc3BvbnNlSGVhZGVyc1RleHQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX3Jlc3BvbnNlSGVhZGVyc1RleHQgPSB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgX3Jlc3BvbnNlQ29va2llcz86IE5ldHdvcmtDb29raWVbXTtcblxuICBnZXQgcmVzcG9uc2VDb29raWVzKCk6IE5ldHdvcmtDb29raWVbXSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLl9yZXNwb25zZUNvb2tpZXMpIHtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMucmVzcG9uc2VIZWFkZXJWYWx1ZSgnU2V0LUNvb2tpZScpO1xuICAgICAgdGhpcy5fcmVxdWVzdENvb2tpZXMgPSBuZXcgQ29va2llUGFyc2VyKCkucGFyc2VTZXRDb29raWUoY29va2llKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VDb29raWVzO1xuICB9XG5cbiAgcHJpdmF0ZSBfcXVlcnlTdHJpbmc/OiBzdHJpbmc7XG5cbiAgZ2V0IHF1ZXJ5U3RyaW5nKCk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuX3F1ZXJ5U3RyaW5nICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9xdWVyeVN0cmluZztcbiAgICB9XG5cbiAgICBsZXQgcXVlcnlTdHJpbmc6IHN0cmluZyA9IG51bGw7XG4gICAgY29uc3QgcXVlc3Rpb25NYXJrUG9zaXRpb246IG51bWJlciA9IHRoaXMudXJsLmluZGV4T2YoJz8nKTtcblxuICAgIGlmIChxdWVzdGlvbk1hcmtQb3NpdGlvbiAhPT0gLTEpIHtcbiAgICAgIHF1ZXJ5U3RyaW5nID0gdGhpcy51cmwuc3Vic3RyaW5nKHF1ZXN0aW9uTWFya1Bvc2l0aW9uICsgMSk7XG4gICAgICBjb25zdCBoYXNoU2lnblBvc2l0aW9uOiBudW1iZXIgPSBxdWVyeVN0cmluZy5pbmRleE9mKCcjJyk7XG5cbiAgICAgIGlmIChoYXNoU2lnblBvc2l0aW9uICE9PSAtMSkge1xuICAgICAgICBxdWVyeVN0cmluZyA9IHF1ZXJ5U3RyaW5nLnN1YnN0cmluZygwLCBoYXNoU2lnblBvc2l0aW9uKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9xdWVyeVN0cmluZyA9IHF1ZXJ5U3RyaW5nO1xuXG4gICAgcmV0dXJuIHRoaXMuX3F1ZXJ5U3RyaW5nO1xuICB9XG5cbiAgcHJpdmF0ZSBfaW5pdGlhbFByaW9yaXR5PzogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVByaW9yaXR5O1xuXG4gIGdldCBpbml0aWFsUHJpb3JpdHkoKTogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVByaW9yaXR5IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5faW5pdGlhbFByaW9yaXR5O1xuICB9XG5cbiAgc2V0IGluaXRpYWxQcmlvcml0eShwcmlvcml0eTogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVByaW9yaXR5KSB7XG4gICAgdGhpcy5faW5pdGlhbFByaW9yaXR5ID0gcHJpb3JpdHk7XG4gIH1cblxuICBwcml2YXRlIF9mcmFtZXM6IFdlYlNvY2tldFtdID0gW107XG5cbiAgZ2V0IGZyYW1lcygpOiBXZWJTb2NrZXRbXSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZyYW1lcztcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXR1c0NvZGU6IG51bWJlciA9IDA7XG5cbiAgZ2V0IHN0YXR1c0NvZGUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fc3RhdHVzQ29kZTtcbiAgfVxuXG4gIHNldCBzdGF0dXNDb2RlKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9zdGF0dXNDb2RlID0gdmFsdWU7XG4gIH1cblxuICBnZXQgcmVxdWVzdElkKCk6IFByb3RvY29sLk5ldHdvcmsuUmVxdWVzdElkIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdElkO1xuICB9XG5cbiAgZ2V0IHJlcXVlc3RIdHRwVmVyc2lvbigpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnJlcXVlc3RIZWFkZXJzVGV4dCkge1xuICAgICAgY29uc3QgZmlyc3RMaW5lID0gdGhpcy5yZXF1ZXN0SGVhZGVyc1RleHQuc3BsaXQoL1xcclxcbi8pWzBdO1xuICAgICAgY29uc3QgbWF0Y2ggPSBmaXJzdExpbmUubWF0Y2goLyhIVFRQXFwvXFxkK1xcLlxcZCspJC8pO1xuXG4gICAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6ICdIVFRQLzAuOSc7XG4gICAgfVxuXG4gICAgY29uc3QgdmVyc2lvbiA9XG4gICAgICB0aGlzLnJlcXVlc3RIZWFkZXJWYWx1ZSgndmVyc2lvbicpIHx8IHRoaXMucmVxdWVzdEhlYWRlclZhbHVlKCc6dmVyc2lvbicpO1xuICAgIGlmICh2ZXJzaW9uKSB7XG4gICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXRGaWx0ZXJlZFByb3RvY29sTmFtZSgpO1xuICB9XG5cbiAgZ2V0IHF1ZXJ5UGFyYW1ldGVycygpOiBRdWVyeVN0cmluZ1tdIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAodGhpcy5fcGFyc2VkUXVlcnlQYXJhbWV0ZXJzKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcGFyc2VkUXVlcnlQYXJhbWV0ZXJzO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5xdWVyeVN0cmluZykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5fcGFyc2VkUXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5wYXJzZVBhcmFtZXRlcnModGhpcy5xdWVyeVN0cmluZyk7XG5cbiAgICByZXR1cm4gdGhpcy5fcGFyc2VkUXVlcnlQYXJhbWV0ZXJzO1xuICB9XG5cbiAgZ2V0IHJlcXVlc3RDb250ZW50VHlwZSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnJlcXVlc3RIZWFkZXJWYWx1ZSgnQ29udGVudC1UeXBlJyk7XG4gIH1cblxuICBnZXQgcHJpb3JpdHkoKTogUHJvdG9jb2wuTmV0d29yay5SZXNvdXJjZVByaW9yaXR5IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudFByaW9yaXR5ID8/IHRoaXMuX2luaXRpYWxQcmlvcml0eSA/PyB1bmRlZmluZWQ7XG4gIH1cblxuICBzZXQgcHJpb3JpdHkocHJpb3JpdHk6IFByb3RvY29sLk5ldHdvcmsuUmVzb3VyY2VQcmlvcml0eSkge1xuICAgIHRoaXMuX2N1cnJlbnRQcmlvcml0eSA9IHByaW9yaXR5O1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBfcmVxdWVzdElkOiBQcm90b2NvbC5OZXR3b3JrLlJlcXVlc3RJZCxcbiAgICB1cmw6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgZG9jdW1lbnRVUkw6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgZnJhbWVJZDogUHJvdG9jb2wuUGFnZS5GcmFtZUlkID0gJycsXG4gICAgcHVibGljIHJlYWRvbmx5IGxvYWRlcklkOiBQcm90b2NvbC5OZXR3b3JrLkxvYWRlcklkLFxuICAgIHB1YmxpYyByZWFkb25seSBpbml0aWF0b3I/OiBQcm90b2NvbC5OZXR3b3JrLkluaXRpYXRvclxuICApIHtcbiAgICB0aGlzLnNldFVybCh1cmwpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZXNjYXBlQ2hhcmFjdGVycyhcbiAgICBzdHI6IHN0cmluZyxcbiAgICBjaGFyczogc3RyaW5nID0gJ15bXXt9KClcXFxcXFxcXC4kKis/fCdcbiAgKTogc3RyaW5nIHtcbiAgICBsZXQgZm91bmRDaGFyID0gZmFsc2U7XG5cbiAgICBjb25zdCBsZW5ndGggPSBjaGFycy5sZW5ndGg7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoc3RyLmluZGV4T2YoY2hhcnMuY2hhckF0KGkpKSAhPT0gLTEpIHtcbiAgICAgICAgZm91bmRDaGFyID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFmb3VuZENoYXIpIHtcbiAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9ICcnO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdHIubGVuZ3RoOyArK2opIHtcbiAgICAgIGlmIChjaGFycy5pbmRleE9mKHN0ci5jaGFyQXQoaikpICE9PSAtMSkge1xuICAgICAgICByZXN1bHQgKz0gJ1xcXFwnO1xuICAgICAgfVxuXG4gICAgICByZXN1bHQgKz0gc3RyLmNoYXJBdChqKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIHNldFVybCh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX3VybCA9PT0gdmFsdWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl91cmwgPSB2YWx1ZTtcbiAgICB0aGlzLl9wYXJzZWRVUkwgPSBwYXJzZVVybCh2YWx1ZSk7XG4gICAgZGVsZXRlIHRoaXMuX3F1ZXJ5U3RyaW5nO1xuICAgIGRlbGV0ZSB0aGlzLl9wYXJzZWRRdWVyeVBhcmFtZXRlcnM7XG4gIH1cblxuICBwdWJsaWMgc2V0UmVtb3RlQWRkcmVzcyhpcDogc3RyaW5nLCBwb3J0OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLl9yZW1vdGVBZGRyZXNzID0gYCR7aXB9OiR7cG9ydH1gO1xuICB9XG5cbiAgcHVibGljIHNldElzc3VlVGltZShcbiAgICBtb25vdG9uaWNUaW1lOiBQcm90b2NvbC5OZXR3b3JrLk1vbm90b25pY1RpbWUsXG4gICAgd2FsbFRpbWU6IFByb3RvY29sLk5ldHdvcmsuVGltZVNpbmNlRXBvY2hcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5faXNzdWVUaW1lID0gbW9ub3RvbmljVGltZTtcbiAgICB0aGlzLl93YWxsSXNzdWVUaW1lID0gd2FsbFRpbWU7XG4gICAgdGhpcy5fc3RhcnRUaW1lID0gbW9ub3RvbmljVGltZTtcbiAgfVxuXG4gIHB1YmxpYyBpbmNyZWFzZVRyYW5zZmVyU2l6ZSh2YWx1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5fdHJhbnNmZXJTaXplID0gKHRoaXMuX3RyYW5zZmVyU2l6ZSB8fCAwKSArIHZhbHVlO1xuICB9XG5cbiAgcHVibGljIHJlcXVlc3RGb3JtRGF0YSgpOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD4ge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0Rm9ybURhdGE7XG4gIH1cblxuICBwdWJsaWMgc2V0UmVxdWVzdEZvcm1EYXRhKGRhdGE6IHN0cmluZyB8IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPik6IHZvaWQge1xuICAgIHRoaXMuX3JlcXVlc3RGb3JtRGF0YSA9XG4gICAgICB0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgPyBQcm9taXNlLnJlc29sdmUoZGF0YSkgOiBkYXRhO1xuICAgIHRoaXMuX2Zvcm1QYXJhbWV0ZXJzUHJvbWlzZSA9IG51bGw7XG4gIH1cblxuICBwdWJsaWMgZ2V0V2FsbFRpbWUobW9ub3RvbmljVGltZTogUHJvdG9jb2wuTmV0d29yay5Nb25vdG9uaWNUaW1lKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fd2FsbElzc3VlVGltZVxuICAgICAgPyB0aGlzLl93YWxsSXNzdWVUaW1lIC0gdGhpcy5faXNzdWVUaW1lICsgbW9ub3RvbmljVGltZVxuICAgICAgOiBtb25vdG9uaWNUaW1lO1xuICB9XG5cbiAgcHVibGljIGZvcm1QYXJhbWV0ZXJzKCk6IFByb21pc2U8UGFyYW1bXT4ge1xuICAgIGlmICghdGhpcy5fZm9ybVBhcmFtZXRlcnNQcm9taXNlKSB7XG4gICAgICB0aGlzLl9mb3JtUGFyYW1ldGVyc1Byb21pc2UgPSB0aGlzLnBhcnNlRm9ybVBhcmFtZXRlcnMoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZm9ybVBhcmFtZXRlcnNQcm9taXNlO1xuICB9XG5cbiAgcHVibGljIHJlc3BvbnNlSHR0cFZlcnNpb24oKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5fcmVzcG9uc2VIZWFkZXJzVGV4dCkge1xuICAgICAgY29uc3QgZmlyc3RMaW5lOiBzdHJpbmcgPSB0aGlzLl9yZXNwb25zZUhlYWRlcnNUZXh0LnNwbGl0KC9cXHJcXG4vKVswXTtcbiAgICAgIGNvbnN0IG1hdGNoOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbCA9IGZpcnN0TGluZS5tYXRjaChcbiAgICAgICAgL14oSFRUUFxcL1xcZCtcXC5cXGQrKS9cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogJ0hUVFAvMC45JztcbiAgICB9XG5cbiAgICBjb25zdCB2ZXJzaW9uID1cbiAgICAgIHRoaXMucmVzcG9uc2VIZWFkZXJWYWx1ZSgndmVyc2lvbicpIHx8XG4gICAgICB0aGlzLnJlc3BvbnNlSGVhZGVyVmFsdWUoJzp2ZXJzaW9uJyk7XG5cbiAgICBpZiAodmVyc2lvbikge1xuICAgICAgcmV0dXJuIHZlcnNpb247XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyZWRQcm90b2NvbE5hbWUoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRDb250ZW50RGF0YShcbiAgICBkYXRhOiBQcm9taXNlPFByb3RvY29sLk5ldHdvcmsuR2V0UmVzcG9uc2VCb2R5UmVzcG9uc2U+XG4gICk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlc291cmNlVHlwZSA9PT0gJ1dlYlNvY2tldCcpIHtcbiAgICAgIHRoaXMuX2NvbnRlbnREYXRhID0gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgZXJyb3I6ICdDb250ZW50IGZvciBXZWJTb2NrZXRzIGlzIGN1cnJlbnRseSBub3Qgc3VwcG9ydGVkJ1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5fY29udGVudERhdGEgPSBkYXRhXG4gICAgICAudGhlbihcbiAgICAgICAgKHtcbiAgICAgICAgICBib2R5OiB0ZXh0LFxuICAgICAgICAgIGJhc2U2NEVuY29kZWRcbiAgICAgICAgfTogUHJvdG9jb2wuTmV0d29yay5HZXRSZXNwb25zZUJvZHlSZXNwb25zZSk6IENvbnRlbnREYXRhID0+ICh7XG4gICAgICAgICAgdGV4dCxcbiAgICAgICAgICBlbmNvZGluZzogYmFzZTY0RW5jb2RlZCA/ICdiYXNlNjQnIDogdW5kZWZpbmVkXG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAuY2F0Y2goKGU6IEVycm9yKTogQ29udGVudERhdGEgPT4gKHsgZXJyb3I6IGUubWVzc2FnZSB9KSk7XG4gIH1cblxuICBwdWJsaWMgY29udGVudERhdGEoKTogUHJvbWlzZTxDb250ZW50RGF0YT4gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9jb250ZW50RGF0YTtcbiAgfVxuXG4gIHB1YmxpYyBhZGRQcm90b2NvbEZyYW1lRXJyb3IoXG4gICAgZXJyb3JNZXNzYWdlOiBzdHJpbmcsXG4gICAgdGltZTogUHJvdG9jb2wuTmV0d29yay5Nb25vdG9uaWNUaW1lXG4gICk6IHZvaWQge1xuICAgIHRoaXMuYWRkRnJhbWUoe1xuICAgICAgdHlwZTogV2ViU29ja2V0RnJhbWVUeXBlLkVSUk9SLFxuICAgICAgZGF0YTogZXJyb3JNZXNzYWdlLFxuICAgICAgdGltZSxcbiAgICAgIG9wY29kZTogLTEsXG4gICAgICBtYXNrOiBmYWxzZVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIGFkZFByb3RvY29sRnJhbWUoXG4gICAgcmVzcG9uc2U6IFByb3RvY29sLk5ldHdvcmsuV2ViU29ja2V0RnJhbWUsXG4gICAgdGltZTogUHJvdG9jb2wuTmV0d29yay5Nb25vdG9uaWNUaW1lLFxuICAgIHNlbnQ6IGJvb2xlYW5cbiAgKTogdm9pZCB7XG4gICAgY29uc3QgdHlwZTogV2ViU29ja2V0RnJhbWVUeXBlID0gc2VudFxuICAgICAgPyBXZWJTb2NrZXRGcmFtZVR5cGUuUkVRVUVTVFxuICAgICAgOiBXZWJTb2NrZXRGcmFtZVR5cGUuUkVTUE9OU0U7XG5cbiAgICB0aGlzLmFkZEZyYW1lKHtcbiAgICAgIHR5cGUsXG4gICAgICBkYXRhOiByZXNwb25zZS5wYXlsb2FkRGF0YSxcbiAgICAgIHRpbWUsXG4gICAgICBvcGNvZGU6IHJlc3BvbnNlLm9wY29kZSxcbiAgICAgIG1hc2s6IHJlc3BvbnNlLm1hc2tcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBtYXJrQXNSZWRpcmVjdChyZWRpcmVjdENvdW50OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLl9yZXF1ZXN0SWQgPSBgJHt0aGlzLnJlcXVlc3RJZH06cmVkaXJlY3RlZC4ke3JlZGlyZWN0Q291bnR9YDtcbiAgfVxuXG4gIHB1YmxpYyBhZGRFeHRyYVJlcXVlc3RJbmZvKGV4dHJhUmVxdWVzdEluZm86IFJlcXVlc3RFeHRyYUluZm8pOiB2b2lkIHtcbiAgICB0aGlzLnJlcXVlc3RIZWFkZXJzID0gZXh0cmFSZXF1ZXN0SW5mby5yZXF1ZXN0SGVhZGVycztcbiAgICB0aGlzLl9oYXNFeHRyYVJlcXVlc3RJbmZvID0gdHJ1ZTtcbiAgICB0aGlzLnJlcXVlc3RIZWFkZXJzVGV4dCA9ICcnO1xuICB9XG5cbiAgcHVibGljIGFkZEV4dHJhUmVzcG9uc2VJbmZvKGV4dHJhUmVzcG9uc2VJbmZvOiBSZXNwb25zZUV4dHJhSW5mbyk6IHZvaWQge1xuICAgIHRoaXMucmVzcG9uc2VIZWFkZXJzID0gZXh0cmFSZXNwb25zZUluZm8ucmVzcG9uc2VIZWFkZXJzO1xuXG4gICAgaWYgKGV4dHJhUmVzcG9uc2VJbmZvLnJlc3BvbnNlSGVhZGVyc1RleHQpIHtcbiAgICAgIHRoaXMucmVzcG9uc2VIZWFkZXJzVGV4dCA9IGV4dHJhUmVzcG9uc2VJbmZvLnJlc3BvbnNlSGVhZGVyc1RleHQ7XG5cbiAgICAgIGlmICh0aGlzLnJlcXVlc3RIZWFkZXJzVGV4dCkge1xuICAgICAgICBsZXQgcmVxdWVzdEhlYWRlcnNUZXh0ID0gYCR7dGhpcy5fcmVxdWVzdE1ldGhvZH0gJHt0aGlzLnBhcnNlZFVSTC5wYXRofWA7XG5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1kZXB0aFxuICAgICAgICBpZiAodGhpcy5wYXJzZWRVUkwucXVlcnkpIHtcbiAgICAgICAgICByZXF1ZXN0SGVhZGVyc1RleHQgKz0gYD8ke3RoaXMucGFyc2VkVVJMLnF1ZXJ5fWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0SGVhZGVyc1RleHQgKz0gYCBIVFRQLzEuMVxcclxcbmA7XG5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1kZXB0aFxuICAgICAgICBmb3IgKGNvbnN0IHsgbmFtZSwgdmFsdWUgfSBvZiB0aGlzLnJlcXVlc3RIZWFkZXJzKSB7XG4gICAgICAgICAgcmVxdWVzdEhlYWRlcnNUZXh0ICs9IGAke25hbWV9OiAke3ZhbHVlfVxcclxcbmA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzVGV4dCA9IHJlcXVlc3RIZWFkZXJzVGV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9oYXNFeHRyYVJlc3BvbnNlSW5mbyA9IHRydWU7XG4gIH1cblxuICBwdWJsaWMgcmVzcG9uc2VIZWFkZXJWYWx1ZShoZWFkZXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGlmICghdGhpcy5fcmVzcG9uc2VIZWFkZXJWYWx1ZXMuaGFzKGhlYWRlck5hbWUpKSB7XG4gICAgICB0aGlzLl9yZXNwb25zZUhlYWRlclZhbHVlcy5zZXQoXG4gICAgICAgIGhlYWRlck5hbWUsXG4gICAgICAgIHRoaXMuY29tcHV0ZUhlYWRlclZhbHVlKHRoaXMucmVzcG9uc2VIZWFkZXJzLCBoZWFkZXJOYW1lKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VIZWFkZXJWYWx1ZXMuZ2V0KGhlYWRlck5hbWUpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBwYXJzZUZvcm1QYXJhbWV0ZXJzKCk6IFByb21pc2U8UGFyYW1bXT4ge1xuICAgIGlmIChcbiAgICAgIHRoaXMucmVxdWVzdENvbnRlbnRUeXBlPy5tYXRjaChcbiAgICAgICAgL15hcHBsaWNhdGlvblxcL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxccyooOy4qKT8kL2lcbiAgICAgIClcbiAgICApIHtcbiAgICAgIGNvbnN0IGZvcm1VcmxlbmNvZGVkOiBzdHJpbmcgPSBhd2FpdCB0aGlzLnJlcXVlc3RGb3JtRGF0YSgpO1xuXG4gICAgICBpZiAoIWZvcm1VcmxlbmNvZGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucGFyc2VQYXJhbWV0ZXJzKGZvcm1VcmxlbmNvZGVkKTtcbiAgICB9XG5cbiAgICBjb25zdCBtdWx0aXBhcnREZXRhaWxzOiBSZWdFeHBNYXRjaEFycmF5ID0gdGhpcy5yZXF1ZXN0Q29udGVudFR5cGU/Lm1hdGNoKFxuICAgICAgL15tdWx0aXBhcnRcXC9mb3JtLWRhdGFcXHMqO1xccypib3VuZGFyeVxccyo9XFxzKihcXFMrKVxccyokL1xuICAgICk7XG5cbiAgICBpZiAoIW11bHRpcGFydERldGFpbHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBib3VuZGFyeTogc3RyaW5nID0gbXVsdGlwYXJ0RGV0YWlsc1sxXTtcbiAgICBpZiAoIWJvdW5kYXJ5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZm9ybURhdGE6IHN0cmluZyA9IGF3YWl0IHRoaXMucmVxdWVzdEZvcm1EYXRhKCk7XG4gICAgaWYgKCFmb3JtRGF0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBhcnNlTXVsdGlwYXJ0Rm9ybURhdGFQYXJhbWV0ZXJzKGZvcm1EYXRhLCBib3VuZGFyeSk7XG4gIH1cblxuICBwcml2YXRlIHBhcnNlTXVsdGlwYXJ0Rm9ybURhdGFQYXJhbWV0ZXJzKFxuICAgIGRhdGE6IHN0cmluZyxcbiAgICBib3VuZGFyeTogc3RyaW5nXG4gICk6IFBhcmFtW10ge1xuICAgIGNvbnN0IHNhbml0aXplZEJvdW5kYXJ5OiBzdHJpbmcgPSBOZXR3b3JrUmVxdWVzdC5lc2NhcGVDaGFyYWN0ZXJzKGJvdW5kYXJ5KTtcbiAgICBjb25zdCBrZXlWYWx1ZVBhdHRlcm4gPSBuZXcgUmVnRXhwKFxuICAgICAgLy8gSGVhZGVyIHdpdGggYW4gb3B0aW9uYWwgZmlsZSBuYW1lLlxuICAgICAgJ15cXFxcclxcXFxuY29udGVudC1kaXNwb3NpdGlvblxcXFxzKjpcXFxccypmb3JtLWRhdGFcXFxccyo7XFxcXHMqbmFtZT1cIihbXlwiXSopXCIoPzpcXFxccyo7XFxcXHMqZmlsZW5hbWU9XCIoW15cIl0qKVwiKT8nICtcbiAgICAgICAgLy8gT3B0aW9uYWwgc2Vjb25kYXJ5IGhlYWRlciB3aXRoIHRoZSBjb250ZW50IHR5cGUuXG4gICAgICAgICcoPzpcXFxcclxcXFxuY29udGVudC10eXBlXFxcXHMqOlxcXFxzKihbXlxcXFxyXFxcXG5dKikpPycgK1xuICAgICAgICAvLyBQYWRkaW5nLlxuICAgICAgICAnXFxcXHJcXFxcblxcXFxyXFxcXG4nICtcbiAgICAgICAgLy8gVmFsdWVcbiAgICAgICAgJyguKiknICtcbiAgICAgICAgLy8gUGFkZGluZy5cbiAgICAgICAgJ1xcXFxyXFxcXG4kJyxcbiAgICAgICdpcydcbiAgICApO1xuICAgIGNvbnN0IGZpZWxkczogc3RyaW5nW10gPSBkYXRhLnNwbGl0KFxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVzZWxlc3MtZXNjYXBlXG4gICAgICBuZXcgUmVnRXhwKGAtLSR7c2FuaXRpemVkQm91bmRhcnl9KD86LS1cXHMqJCk/YCwgJ2cnKVxuICAgICk7XG5cbiAgICByZXR1cm4gZmllbGRzLnJlZHVjZSgocmVzdWx0OiBQYXJhbVtdLCBmaWVsZDogc3RyaW5nKTogUGFyYW1bXSA9PiB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3R5cGVkZWZcbiAgICAgIGNvbnN0IFttYXRjaCwgbmFtZSwgdmFsdWVdID0gZmllbGQubWF0Y2goa2V5VmFsdWVQYXR0ZXJuKSB8fCBbXTtcblxuICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuXG4gICAgICByZXN1bHQucHVzaCh7IG5hbWUsIHZhbHVlIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIFtdKTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkRnJhbWUoZnJhbWU6IFdlYlNvY2tldCk6IHZvaWQge1xuICAgIHRoaXMuX2ZyYW1lcy5wdXNoKGZyYW1lKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVxdWVzdEhlYWRlclZhbHVlKGhlYWRlck5hbWU6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLl9yZXF1ZXN0SGVhZGVyVmFsdWVzLmhhcyhoZWFkZXJOYW1lKSkge1xuICAgICAgdGhpcy5fcmVxdWVzdEhlYWRlclZhbHVlcy5zZXQoXG4gICAgICAgIGhlYWRlck5hbWUsXG4gICAgICAgIHRoaXMuY29tcHV0ZUhlYWRlclZhbHVlKHRoaXMucmVxdWVzdEhlYWRlcnMsIGhlYWRlck5hbWUpXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0SGVhZGVyVmFsdWVzLmdldChoZWFkZXJOYW1lKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RmlsdGVyZWRQcm90b2NvbE5hbWUoKTogc3RyaW5nIHtcbiAgICBjb25zdCBwcm90b2NvbCA9IHRoaXMuX3Byb3RvY29sLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAocHJvdG9jb2wgPT09ICdoMicpIHtcbiAgICAgIHJldHVybiAnaHR0cC8yLjAnO1xuICAgIH1cblxuICAgIHJldHVybiBwcm90b2NvbC5yZXBsYWNlKC9eaHR0cFxcLzIoXFwuMCk/XFwrLywgJ2h0dHAvMi4wKycpO1xuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZVBhcmFtZXRlcnMocXVlcnlTdHJpbmc6IHN0cmluZyk6IFF1ZXJ5U3RyaW5nW10ge1xuICAgIHJldHVybiBxdWVyeVN0cmluZy5zcGxpdCgnJicpLm1hcChcbiAgICAgIChwYWlyOiBzdHJpbmcpOiBRdWVyeVN0cmluZyA9PiB7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uOiBudW1iZXIgPSBwYWlyLmluZGV4T2YoJz0nKTtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAtMSkge1xuICAgICAgICAgIHJldHVybiB7IG5hbWU6IHBhaXIsIHZhbHVlOiAnJyB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBwYWlyLnN1YnN0cmluZygwLCBwb3NpdGlvbiksXG4gICAgICAgICAgICB2YWx1ZTogcGFpci5zdWJzdHJpbmcocG9zaXRpb24gKyAxKVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBjb21wdXRlSGVhZGVyVmFsdWUoXG4gICAgaGVhZGVyczogSGVhZGVyW10sXG4gICAgaGVhZGVyTmFtZTogc3RyaW5nXG4gICk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgaGVhZGVyTmFtZSA9IGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgIGNvbnN0IHZhbHVlczogc3RyaW5nW10gPSBoZWFkZXJzXG4gICAgICAuZmlsdGVyKCh7IG5hbWUgfTogSGVhZGVyKTogYm9vbGVhbiA9PiBuYW1lLnRvTG93ZXJDYXNlKCkgPT09IGhlYWRlck5hbWUpXG4gICAgICAubWFwKCh7IHZhbHVlIH06IEhlYWRlcik6IHN0cmluZyA9PiB2YWx1ZSk7XG5cbiAgICBpZiAoIXZhbHVlcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQtQ29va2llIHZhbHVlcyBzaG91bGQgYmUgc2VwYXJhdGVkIGJ5ICdcXG4nLCBub3QgY29tbWEsIG90aGVyd2lzZSBjb29raWVzIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgaWYgKGhlYWRlck5hbWUgPT09ICdzZXQtY29va2llJykge1xuICAgICAgcmV0dXJuIHZhbHVlcy5qb2luKCdcXG4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWVzLmpvaW4oJywgJyk7XG4gIH1cbn1cbiJdfQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketFrameType = exports.NetworkRequest = exports.NetworkObserver = exports.HarBuilder = exports.EntryBuilder = void 0;\nvar EntryBuilder_1 = require(\"./EntryBuilder\");\nObject.defineProperty(exports, \"EntryBuilder\", { enumerable: true, get: function () { return EntryBuilder_1.EntryBuilder; } });\nvar HarBuilder_1 = require(\"./HarBuilder\");\nObject.defineProperty(exports, \"HarBuilder\", { enumerable: true, get: function () { return HarBuilder_1.HarBuilder; } });\nvar NetworkObserver_1 = require(\"./NetworkObserver\");\nObject.defineProperty(exports, \"NetworkObserver\", { enumerable: true, get: function () { return NetworkObserver_1.NetworkObserver; } });\nvar NetworkRequest_1 = require(\"./NetworkRequest\");\nObject.defineProperty(exports, \"NetworkRequest\", { enumerable: true, get: function () { return NetworkRequest_1.NetworkRequest; } });\nObject.defineProperty(exports, \"WebSocketFrameType\", { enumerable: true, get: function () { return NetworkRequest_1.WebSocketFrameType; } });\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbmV0d29yay9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwrQ0FBOEM7QUFBckMsNEdBQUEsWUFBWSxPQUFBO0FBQ3JCLDJDQUEwQztBQUFqQyx3R0FBQSxVQUFVLE9BQUE7QUFDbkIscURBQW9EO0FBQTNDLGtIQUFBLGVBQWUsT0FBQTtBQUN4QixtREFJMEI7QUFIeEIsZ0hBQUEsY0FBYyxPQUFBO0FBRWQsb0hBQUEsa0JBQWtCLE9BQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBFbnRyeUJ1aWxkZXIgfSBmcm9tICcuL0VudHJ5QnVpbGRlcic7XG5leHBvcnQgeyBIYXJCdWlsZGVyIH0gZnJvbSAnLi9IYXJCdWlsZGVyJztcbmV4cG9ydCB7IE5ldHdvcmtPYnNlcnZlciB9IGZyb20gJy4vTmV0d29ya09ic2VydmVyJztcbmV4cG9ydCB7XG4gIE5ldHdvcmtSZXF1ZXN0LFxuICBDb250ZW50RGF0YSxcbiAgV2ViU29ja2V0RnJhbWVUeXBlXG59IGZyb20gJy4vTmV0d29ya1JlcXVlc3QnO1xuIl19","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FileManager = void 0;\nconst tslib_1 = require(\"tslib\");\nconst Logger_1 = require(\"./Logger\");\nconst util_1 = require(\"util\");\nconst fs_1 = require(\"fs\");\nclass FileManager {\n    constructor() {\n        this._access = util_1.promisify(fs_1.access);\n        this._unlink = util_1.promisify(fs_1.unlink);\n        this._writeFile = util_1.promisify(fs_1.writeFile);\n        this._mkdir = util_1.promisify(fs_1.mkdir);\n    }\n    static get Instance() {\n        if (!this._instance) {\n            this._instance = new FileManager();\n        }\n        return this._instance;\n    }\n    writeFile(path, data) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.removeFile(path);\n                yield this._writeFile(path, data);\n            }\n            catch (e) {\n                Logger_1.Logger.Instance.err(e);\n            }\n        });\n    }\n    createFolder(path) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            try {\n                if (yield this.exists(path)) {\n                    return;\n                }\n                yield this._mkdir(path);\n            }\n            catch (e) {\n                Logger_1.Logger.Instance.err(e);\n            }\n        });\n    }\n    removeFile(path) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            try {\n                if (yield this.exists(path)) {\n                    yield this._unlink(path);\n                }\n            }\n            catch (e) {\n                Logger_1.Logger.Instance.err(e);\n            }\n        });\n    }\n    exists(path) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this._access(path, fs_1.constants.F_OK);\n                return true;\n            }\n            catch (e) {\n                return false;\n            }\n        });\n    }\n}\nexports.FileManager = FileManager;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRmlsZU1hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvRmlsZU1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHFDQUFrQztBQUNsQywrQkFBaUM7QUFDakMsMkJBTVk7QUFFWixNQUFhLFdBQVc7SUFBeEI7UUFXbUIsWUFBTyxHQUFHLGdCQUFTLENBQUMsV0FBUSxDQUFDLENBQUM7UUFDOUIsWUFBTyxHQUFHLGdCQUFTLENBQUMsV0FBUSxDQUFDLENBQUM7UUFDOUIsZUFBVSxHQUFHLGdCQUFTLENBQUMsY0FBVyxDQUFDLENBQUM7UUFDcEMsV0FBTSxHQUFHLGdCQUFTLENBQUMsVUFBTyxDQUFDLENBQUM7SUEwQy9DLENBQUM7SUFyREMsTUFBTSxLQUFLLFFBQVE7UUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbkIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO1NBQ3BDO1FBRUQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQ3hCLENBQUM7SUFPWSxTQUFTLENBQUMsSUFBWSxFQUFFLElBQVk7O1lBQy9DLElBQUk7Z0JBQ0YsTUFBTSxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM1QixNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO2FBQ25DO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1YsZUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDeEI7UUFDSCxDQUFDO0tBQUE7SUFFWSxZQUFZLENBQUMsSUFBWTs7WUFDcEMsSUFBSTtnQkFDRixJQUFJLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDM0IsT0FBTztpQkFDUjtnQkFFRCxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDekI7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixlQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN4QjtRQUNILENBQUM7S0FBQTtJQUVZLFVBQVUsQ0FBQyxJQUFZOztZQUNsQyxJQUFJO2dCQUNGLElBQUksTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFO29CQUMzQixNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7aUJBQzFCO2FBQ0Y7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixlQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN4QjtRQUNILENBQUM7S0FBQTtJQUVZLE1BQU0sQ0FBQyxJQUFZOztZQUM5QixJQUFJO2dCQUNGLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsY0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUV6QyxPQUFPLElBQUksQ0FBQzthQUNiO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1YsT0FBTyxLQUFLLENBQUM7YUFDZDtRQUNILENBQUM7S0FBQTtDQUNGO0FBeERELGtDQXdEQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4vTG9nZ2VyJztcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnO1xuaW1wb3J0IHtcbiAgYWNjZXNzIGFzIGFjY2Vzc0NiLFxuICBjb25zdGFudHMsXG4gIG1rZGlyIGFzIG1rZGlyQ2IsXG4gIHVubGluayBhcyB1bmxpbmtDYixcbiAgd3JpdGVGaWxlIGFzIHdyaXRlRmlsZUNiXG59IGZyb20gJ2ZzJztcblxuZXhwb3J0IGNsYXNzIEZpbGVNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgX2luc3RhbmNlOiBGaWxlTWFuYWdlcjtcblxuICBzdGF0aWMgZ2V0IEluc3RhbmNlKCk6IEZpbGVNYW5hZ2VyIHtcbiAgICBpZiAoIXRoaXMuX2luc3RhbmNlKSB7XG4gICAgICB0aGlzLl9pbnN0YW5jZSA9IG5ldyBGaWxlTWFuYWdlcigpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9pbnN0YW5jZTtcbiAgfVxuXG4gIHByaXZhdGUgcmVhZG9ubHkgX2FjY2VzcyA9IHByb21pc2lmeShhY2Nlc3NDYik7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3VubGluayA9IHByb21pc2lmeSh1bmxpbmtDYik7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3dyaXRlRmlsZSA9IHByb21pc2lmeSh3cml0ZUZpbGVDYik7XG4gIHByaXZhdGUgcmVhZG9ubHkgX21rZGlyID0gcHJvbWlzaWZ5KG1rZGlyQ2IpO1xuXG4gIHB1YmxpYyBhc3luYyB3cml0ZUZpbGUocGF0aDogc3RyaW5nLCBkYXRhOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5yZW1vdmVGaWxlKHBhdGgpO1xuICAgICAgYXdhaXQgdGhpcy5fd3JpdGVGaWxlKHBhdGgsIGRhdGEpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIExvZ2dlci5JbnN0YW5jZS5lcnIoZSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGFzeW5jIGNyZWF0ZUZvbGRlcihwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGF3YWl0IHRoaXMuZXhpc3RzKHBhdGgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5fbWtkaXIocGF0aCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgTG9nZ2VyLkluc3RhbmNlLmVycihlKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgcmVtb3ZlRmlsZShwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGF3YWl0IHRoaXMuZXhpc3RzKHBhdGgpKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuX3VubGluayhwYXRoKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBMb2dnZXIuSW5zdGFuY2UuZXJyKGUpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBleGlzdHMocGF0aDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuX2FjY2VzcyhwYXRoLCBjb25zdGFudHMuRl9PSyk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Logger = void 0;\nconst tslib_1 = require(\"tslib\");\nconst chalk_1 = tslib_1.__importDefault(require(\"chalk\"));\nconst util_1 = require(\"util\");\nconst debug = util_1.debuglog('cypress-har-generator');\nclass Logger {\n    static get Instance() {\n        if (!this._instance) {\n            this._instance = new Logger();\n        }\n        return this._instance;\n    }\n    info(msg) {\n        this.log(chalk_1.default.blue(`🛈 ${msg}`));\n    }\n    err(msg) {\n        this.log(chalk_1.default.red(`🍑 ${msg}`));\n    }\n    warn(msg) {\n        this.log(chalk_1.default.yellow(`⚠ ${msg}`));\n    }\n    debug(msg) {\n        debug(msg);\n    }\n    log(msg) {\n        // eslint-disable-next-line no-console\n        console.log(msg);\n    }\n}\nexports.Logger = Logger;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9nZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3V0aWxzL0xvZ2dlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsMERBQTBCO0FBQzFCLCtCQUFnQztBQUVoQyxNQUFNLEtBQUssR0FBRyxlQUFRLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUVoRCxNQUFhLE1BQU07SUFHakIsTUFBTSxLQUFLLFFBQVE7UUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbkIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFDO1NBQy9CO1FBRUQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQ3hCLENBQUM7SUFFTSxJQUFJLENBQUMsR0FBVztRQUNyQixJQUFJLENBQUMsR0FBRyxDQUFDLGVBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVNLEdBQUcsQ0FBQyxHQUFXO1FBQ3BCLElBQUksQ0FBQyxHQUFHLENBQUMsZUFBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBRU0sSUFBSSxDQUFDLEdBQVc7UUFDckIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxlQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFTSxLQUFLLENBQUMsR0FBVztRQUN0QixLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDYixDQUFDO0lBRU8sR0FBRyxDQUFDLEdBQVc7UUFDckIsc0NBQXNDO1FBQ3RDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbkIsQ0FBQztDQUNGO0FBL0JELHdCQStCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjaGFsayBmcm9tICdjaGFsayc7XG5pbXBvcnQgeyBkZWJ1Z2xvZyB9IGZyb20gJ3V0aWwnO1xuXG5jb25zdCBkZWJ1ZyA9IGRlYnVnbG9nKCdjeXByZXNzLWhhci1nZW5lcmF0b3InKTtcblxuZXhwb3J0IGNsYXNzIExvZ2dlciB7XG4gIHByaXZhdGUgc3RhdGljIF9pbnN0YW5jZTogTG9nZ2VyO1xuXG4gIHN0YXRpYyBnZXQgSW5zdGFuY2UoKTogTG9nZ2VyIHtcbiAgICBpZiAoIXRoaXMuX2luc3RhbmNlKSB7XG4gICAgICB0aGlzLl9pbnN0YW5jZSA9IG5ldyBMb2dnZXIoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5faW5zdGFuY2U7XG4gIH1cblxuICBwdWJsaWMgaW5mbyhtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMubG9nKGNoYWxrLmJsdWUoYPCfm4ggJHttc2d9YCkpO1xuICB9XG5cbiAgcHVibGljIGVycihtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMubG9nKGNoYWxrLnJlZChg8J+NkSAke21zZ31gKSk7XG4gIH1cblxuICBwdWJsaWMgd2Fybihtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMubG9nKGNoYWxrLnllbGxvdyhg4pqgICR7bXNnfWApKTtcbiAgfVxuXG4gIHB1YmxpYyBkZWJ1Zyhtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgIGRlYnVnKG1zZyk7XG4gIH1cblxuICBwcml2YXRlIGxvZyhtc2c6IHN0cmluZyk6IHZvaWQge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2cobXNnKTtcbiAgfVxufVxuIl19","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FileManager = exports.Logger = void 0;\nvar Logger_1 = require(\"./Logger\");\nObject.defineProperty(exports, \"Logger\", { enumerable: true, get: function () { return Logger_1.Logger; } });\nvar FileManager_1 = require(\"./FileManager\");\nObject.defineProperty(exports, \"FileManager\", { enumerable: true, get: function () { return FileManager_1.FileManager; } });\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbUNBQWtDO0FBQXpCLGdHQUFBLE1BQU0sT0FBQTtBQUNmLDZDQUE0QztBQUFuQywwR0FBQSxXQUFXLE9BQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBMb2dnZXIgfSBmcm9tICcuL0xvZ2dlcic7XG5leHBvcnQgeyBGaWxlTWFuYWdlciB9IGZyb20gJy4vRmlsZU1hbmFnZXInO1xuIl19","module.exports = require(\"chalk\");;","module.exports = require(\"chrome-remote-interface\");;","module.exports = require(\"fs\");;","module.exports = require(\"path\");;","module.exports = require(\"tslib\");;","module.exports = require(\"url\");;","module.exports = require(\"util\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ensureBrowserFlags = exports.install = void 0;\nconst Plugin_1 = require(\"./Plugin\");\nconst utils_1 = require(\"./utils\");\nconst plugin = new Plugin_1.Plugin(utils_1.Logger.Instance, utils_1.FileManager.Instance);\nconst install = (on) => {\n    on('task', {\n        saveHar: (options) => plugin.saveHar(options),\n        recordHar: (options) => plugin.recordHar(options)\n    });\n};\nexports.install = install;\nconst ensureBrowserFlags = (browser, launchOptions) => {\n    launchOptions.args.push(...plugin.ensureBrowserFlags(browser, launchOptions.args));\n};\nexports.ensureBrowserFlags = ensureBrowserFlags;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEscUNBQThEO0FBQzlELG1DQUE4QztBQWE5QyxNQUFNLE1BQU0sR0FBRyxJQUFJLGVBQU0sQ0FBQyxjQUFNLENBQUMsUUFBUSxFQUFFLG1CQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFMUQsTUFBTSxPQUFPLEdBQUcsQ0FBQyxFQUF3QixFQUFRLEVBQUU7SUFDeEQsRUFBRSxDQUFDLE1BQU0sRUFBRTtRQUNULE9BQU8sRUFBRSxDQUFDLE9BQW9CLEVBQWlCLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztRQUN6RSxTQUFTLEVBQUUsQ0FBQyxPQUFzQixFQUFpQixFQUFFLENBQ25ELE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDO0tBQzVCLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQU5XLFFBQUEsT0FBTyxXQU1sQjtBQUVLLE1BQU0sa0JBQWtCLEdBQUcsQ0FDaEMsT0FBd0IsRUFDeEIsYUFBMkMsRUFDckMsRUFBRTtJQUNSLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUNyQixHQUFHLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUMxRCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBUFcsUUFBQSxrQkFBa0Isc0JBTzdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGx1Z2luLCBSZWNvcmRPcHRpb25zLCBTYXZlT3B0aW9ucyB9IGZyb20gJy4vUGx1Z2luJztcbmltcG9ydCB7IEZpbGVNYW5hZ2VyLCBMb2dnZXIgfSBmcm9tICcuL3V0aWxzJztcblxuZGVjbGFyZSBnbG9iYWwge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5hbWVzcGFjZVxuICBuYW1lc3BhY2UgQ3lwcmVzcyB7XG4gICAgaW50ZXJmYWNlIENoYWluYWJsZTxTdWJqZWN0ID0gYW55PiB7XG4gICAgICBzYXZlSGFyKG9wdGlvbnM/OiBQYXJ0aWFsPFNhdmVPcHRpb25zPik6IENoYWluYWJsZTxTdWJqZWN0PjtcblxuICAgICAgcmVjb3JkSGFyKG9wdGlvbnM/OiBSZWNvcmRPcHRpb25zKTogQ2hhaW5hYmxlPFN1YmplY3Q+O1xuICAgIH1cbiAgfVxufVxuXG5jb25zdCBwbHVnaW4gPSBuZXcgUGx1Z2luKExvZ2dlci5JbnN0YW5jZSwgRmlsZU1hbmFnZXIuSW5zdGFuY2UpO1xuXG5leHBvcnQgY29uc3QgaW5zdGFsbCA9IChvbjogQ3lwcmVzcy5QbHVnaW5FdmVudHMpOiB2b2lkID0+IHtcbiAgb24oJ3Rhc2snLCB7XG4gICAgc2F2ZUhhcjogKG9wdGlvbnM6IFNhdmVPcHRpb25zKTogUHJvbWlzZTx2b2lkPiA9PiBwbHVnaW4uc2F2ZUhhcihvcHRpb25zKSxcbiAgICByZWNvcmRIYXI6IChvcHRpb25zOiBSZWNvcmRPcHRpb25zKTogUHJvbWlzZTx2b2lkPiA9PlxuICAgICAgcGx1Z2luLnJlY29yZEhhcihvcHRpb25zKVxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbnN1cmVCcm93c2VyRmxhZ3MgPSAoXG4gIGJyb3dzZXI6IEN5cHJlc3MuQnJvd3NlcixcbiAgbGF1bmNoT3B0aW9uczogQ3lwcmVzcy5Ccm93c2VyTGF1bmNoT3B0aW9uc1xuKTogdm9pZCA9PiB7XG4gIGxhdW5jaE9wdGlvbnMuYXJncy5wdXNoKFxuICAgIC4uLnBsdWdpbi5lbnN1cmVCcm93c2VyRmxhZ3MoYnJvd3NlciwgbGF1bmNoT3B0aW9ucy5hcmdzKVxuICApO1xufTtcblxuZXhwb3J0IHsgU2F2ZU9wdGlvbnMsIFJlY29yZE9wdGlvbnMgfSBmcm9tICcuL1BsdWdpbic7XG4iXX0="],"sourceRoot":""}